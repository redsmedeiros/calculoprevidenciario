[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts[m
[1mindex 71ac93a..ddfdfa0 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts[m
[36m@@ -17,7 +17,7 @@[m [mimport * as moment from 'moment';[m
   templateUrl: './rgps-resultados-anterior88.component.html',[m
   styleUrls: ['./rgps-resultados-anterior88.component.css'][m
 })[m
[31m-export class RgpsResultadosAnterior88Component implements OnInit {[m
[32m+[m[32mexport class RgpsResultadosAnterior88Component extends RgpsResultadosComponent implements OnInit {[m
 [m
 	@Input() calculo;[m
 	@Input() segurado;[m
[36m@@ -58,7 +58,7 @@[m [mexport class RgpsResultadosAnterior88Component implements OnInit {[m
     private Moeda: MoedaService,[m
     private IndiceInps: IndiceInpsService,[m
     private SalarioMinimoMaximo: SalarioMinimoMaximoService,[m
[31m-    ) { }[m
[32m+[m[32m    ) {super(null, null, null, null);}[m
 [m
   ngOnInit(){[m
   	this.isUpdating = true;[m
[36m@@ -397,4 +397,21 @@[m [mexport class RgpsResultadosAnterior88Component implements OnInit {[m
     }[m
     return index;[m
   }[m
[32m+[m
[32m+[m[32m  limitarTetosEMinimos(valor, data){[m
[32m+[m[32m    let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m    let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m    let tetoSalarial = moeda.teto;[m
[32m+[m[32m    let avisoString = '';[m
[32m+[m[32m    let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m    if(valor < salarioMinimo){[m
[32m+[m[32m      valorRetorno = salarioMinimo;[m
[32m+[m[32m      avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m    }else if(valor > tetoSalarial){[m
[32m+[m[32m      valorRetorno = tetoSalarial;[m
[32m+[m[32m      avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m    }[m
[32m+[m[32m    return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  }[m
 }[m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts[m
[1mindex 6b199fe..d4e7b8d 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts[m
[36m@@ -6,8 +6,12 @@[m [mimport { ReajusteAutomaticoService } from '../ReajusteAutomatico.service';[m
 import { ValorContribuidoService } from '../../+rgps-valores-contribuidos/ValorContribuido.service'[m
 import { CarenciaProgressiva } from '../CarenciaProgressiva.model';[m
 import { CarenciaProgressivaService } from '../CarenciaProgressiva.service';[m
[32m+[m[32mimport { Router, ActivatedRoute } from '@angular/router';[m
[32m+[m[32mimport { CalculoRgpsService } from '../../+rgps-calculos/CalculoRgps.service';[m
[32m+[m[32mimport { SeguradoService } from '../../+rgps-segurados/SeguradoRgps.service';[m
 import { Moeda } from '../../../services/Moeda.model';[m
 import { MoedaService } from '../../../services/Moeda.service';[m
[32m+[m[32mimport { RgpsResultadosComponent } from '../rgps-resultados.component'[m
 import * as moment from 'moment';[m
 [m
 @Component({[m
[36m@@ -15,9 +19,10 @@[m [mimport * as moment from 'moment';[m
   templateUrl: './rgps-resultados-apos99.component.html',[m
   styleUrls: ['./rgps-resultados-apos99.component.css'][m
 })[m
[31m-export class RgpsResultadosApos99Component implements OnInit {[m
[32m+[m[32mexport class RgpsResultadosApos99Component extends RgpsResultadosComponent implements OnInit {[m
 	@Input() calculo;[m
 	@Input() segurado;[m
[32m+[m
 	public dataFiliacao;[m
 	public idadeSegurado;[m
 	public idCalculo;[m
[36m@@ -64,7 +69,8 @@[m [mexport class RgpsResultadosApos99Component implements OnInit {[m
   	private ReajusteAutomatico:ReajusteAutomaticoService,[m
     protected ValoresContribuidos: ValorContribuidoService,[m
     private CarenciaProgressiva:CarenciaProgressivaService,[m
[31m-    private Moeda: MoedaService,) { }[m
[32m+[m[32m    private Moeda: MoedaService){[m
[32m+[m[32m    super(null, null, null, null); }[m
 [m
   ngOnInit() {[m
   	this.isUpdating = true;[m
[36m@@ -940,6 +946,45 @@[m [mexport class RgpsResultadosApos99Component implements OnInit {[m
     }[m
   }[m
 [m
[32m+[m[32m  limitarTetosEMinimos(valor, data){[m
[32m+[m[32m    let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m    let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m    let tetoSalarial = moeda.teto;[m
[32m+[m[32m    let avisoString = '';[m
[32m+[m[32m    let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m    if(valor < salarioMinimo){[m
[32m+[m[32m      valorRetorno = salarioMinimo;[m
[32m+[m[32m      avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m    }else if(valor > tetoSalarial){[m
[32m+[m[32m      valorRetorno = tetoSalarial;[m
[32m+[m[32m      avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m    }[m
[32m+[m[32m    return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  }[m
[32m+[m
[32m+[m[32m  verificarCarencia(redutorIdade, redutorProfessor, redutorSexo, errorArray) {[m
[32m+[m[32m    if (this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[32m+[m[32m      let mesesCarencia = 180;[m
[32m+[m[32m      if (moment(this.segurado.data_filiacao, 'DD/MM/YYYY') < this.dataLei8213) { // Verificar se a data de filiação existe[m
[32m+[m[32m        let anoNecessario = this.getAnoNecessario(redutorIdade, redutorProfessor, redutorSexo)[m
[32m+[m[32m        let carenciaProgressiva = this.CarenciaProgressiva.getCarencia(anoNecessario);[m
[32m+[m[32m        if (carenciaProgressiva != 0) {[m
[32m+[m[32m            mesesCarencia = carenciaProgressiva;[m
[32m+[m[32m        } else if (anoNecessario < 1991) {[m
[32m+[m[32m            mesesCarencia = 60;[m
[32m+[m[32m        }[m
[32m+[m[32m      }[m
[32m+[m
[32m+[m[32m      if (this.calculo.carencia < mesesCarencia) {[m
[32m+[m[32m        let erroCarencia = "Falta(m) " + (mesesCarencia - this.calculo.carencia) + " mês(es) para a carência necessária.";[m
[32m+[m[32m        errorArray.push(erroCarencia);[m
[32m+[m[32m        return false;[m
[32m+[m[32m      }[m
[32m+[m[32m    }[m
[32m+[m[32m    return true;[m
[32m+[m[32m  }[m
[32m+[m
   getIdadeFracionada(){[m
     let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
     let idadeEmDias = this.dataInicioBeneficio.diff(dataNascimento, 'days');[m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts[m
[1mindex a182527..79502e2 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts[m
[36m@@ -14,7 +14,7 @@[m [mimport * as moment from 'moment';[m
   templateUrl: './rgps-resultados-entre91e98.component.html',[m
   styleUrls: ['./rgps-resultados-entre91e98.component.css'][m
 })[m
[31m-export class RgpsResultadosEntre91e98Component implements OnInit {[m
[32m+[m[32mexport class RgpsResultadosEntre91e98Component extends RgpsResultadosComponent implements OnInit {[m
 	@Input() calculo;[m
 	@Input() segurado;[m
 	@Input() tipoCalculo;[m
[36m@@ -55,7 +55,7 @@[m [mexport class RgpsResultadosEntre91e98Component implements OnInit {[m
   constructor(private CarenciaProgressiva:CarenciaProgressivaService,[m
     private ReajusteAutomatico:ReajusteAutomaticoService,[m
     protected ValoresContribuidos: ValorContribuidoService,[m
[31m-    private Moeda: MoedaService,) { }[m
[32m+[m[32m    private Moeda: MoedaService,) { super(null, null, null, null);}[m
 [m
   ngOnInit() {[m
   	this.isUpdating = true;[m
[36m@@ -714,4 +714,21 @@[m [mexport class RgpsResultadosEntre91e98Component implements OnInit {[m
     return bonus;[m
   }[m
 [m
[32m+[m[32m  limitarTetosEMinimos(valor, data){[m
[32m+[m[32m    let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m    let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m    let tetoSalarial = moeda.teto;[m
[32m+[m[32m    let avisoString = '';[m
[32m+[m[32m    let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m    if(valor < salarioMinimo){[m
[32m+[m[32m      valorRetorno = salarioMinimo;[m
[32m+[m[32m      avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m    }else if(valor > tetoSalarial){[m
[32m+[m[32m      valorRetorno = tetoSalarial;[m
[32m+[m[32m      avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m    }[m
[32m+[m[32m    return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  }[m
[32m+[m
 }[m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html[m
[1mindex 0392054..4d0ee27 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html[m
[36m@@ -123,1013 +123,23 @@[m
         </sa-widget>[m
       </article>[m
 [m
[31m-      <!-- Opções do Cálculo Anterior a 05/10/1988 -->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculoAnterior88">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 345[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <!--Não disponivel para cálculo  Anterior a 05/10/1988   [m
[31m-              <tr>[m
[31m-              <td>[m
[31m-                <p>Calcular com base na tabela do INPC vigente na data da DIB</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-calculator"></i>[m
[31m-                  </span> CÁLCULAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr> -->[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Tabela e Informações do Cálculo Anterior a 05/10/1988 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculoAnterior88">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} Anterior a 05/10/1988</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimariaAnterior88.anos}} ano(s), {{contribuicaoPrimariaAnterior88.meses}} mês(es) e {{contribuicaoPrimariaAnterior88.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundariaAnterior88.anos}} ano(s), {{contribuicaoSecundariaAnterior88.meses}} mês(es) e {{contribuicaoSecundariaAnterior88.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert" *ngIf="erro">[m
[31m-            <!--<strong>NÃO POSSUI</strong> direito ao benefício[m
[31m-                <strong>Falta(m) 20 ano(s) e 2 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>INTEGRAL</strong>. -->[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-            </div>[m
[31m-            <div>[m
[31m-              <sa-datatable [options]="calculoAnterior88TableOptions" *ngIf="!isUpdating && !erro"[m
[31m-                paginationLength="true" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>Competência</th>[m
[31m-                    <th>Contribuição Primária</th>[m
[31m-                    <th>Contribuição Secundária</th>[m
[31m-                    <th>Índice Anual INPS</th>[m
[31m-                    <th>Contribuição Primária Corrigida</th>[m
[31m-                    <th>Contribuição Secundária Corrigida</th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-              </sa-datatable>[m
[31m-          </div>[m
[31m-          <div class="widget-body" *ngIf="!isUpdating && !erro">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.total_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.media_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.divisor_calculo_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.media_contribuicoes}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Maior valor teto (MVT):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.maior_valor_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Menor valor teto (mvt):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.menor_valor_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">% de Cálculo do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.porcentagem_calculo_beneficio}}%</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Benefício mínimo com índice (Min para a RMI):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.beneficio_minimo_com_indice}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">95% do valor da média (Max para a RMI):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.noventaecinco_porcento_valor_da_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.renda_mensal_inicial}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Opções do Cálculo Entre 05/04/1991 e 15/12/1998 -->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculo91_98">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 346[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Calcular com base na tabela do INPC vigente na data da DIB</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-calculator"></i>[m
[31m-                  </span> CÁLCULAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Tabela e Informações do Cálculo Entre 05/04/1991 e 15/12/1998 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculo91_98">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} Entre 05/04/1991 e 15/12/1998</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimaria91_98.anos}} ano(s), {{contribuicaoPrimaria91_98.meses}} mês(es) e {{contribuicaoPrimaria91_98.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundaria91_98.anos}} ano(s), {{contribuicaoSecundaria91_98.meses}} mês(es) e {{contribuicaoSecundaria91_98.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-[m
[31m-              <div class="alert alert-warning margin-top-10" *ngFor="let erro of errosCalculo91_98" role="alert">[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-[m
[31m-              <!-- <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>NÃO POSSUI</strong> direito ao benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 16 ano(s)</strong> para atingir a idade mínima.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 18 ano(s) e 10 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 19 ano(s) e 11 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>PROPORCIONAL</strong>.</div> -->[m
[31m-[m
[31m-            </div>[m
[31m-            <div>[m
[31m-              <sa-datatable [options]="calculo91_98TableOptions" *ngIf="!isUpdating && errosCalculo91_98.length == 0"[m
[31m-                paginationLength="true" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>Competência</th>[m
[31m-                    <th>Fator</th>[m
[31m-                    <th>Contribuição Primaria</th>[m
[31m-                    <th>Contribuição Secundária</th>[m
[31m-                    <th>Contribuição Primária Corrigida</th>[m
[31m-                    <th>Contribuição Secundária Corrigida</th>[m
[31m-                    <th>Limite</th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-              </sa-datatable>[m
[31m-            </div>[m
[31m-            <div class="widget-body" *ngIf="!isUpdating && errosCalculo91_98.length == 0">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Índice de reajuste no teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.indice_reajuste_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.total_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.media_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.divisor_calculo_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.total_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.media_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.divisor_calculo_media_secundaria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Coeficiente:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.coeficiente}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.media_contribuicoes}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Salário Mínimo:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.salario_minimo}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.renda_mensal_inicial}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial na DIB:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.renda_mensal_inicial_data_dib}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Opções do Cálculo Entre 16/12/1998 e 28/11/1999 -->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculo91_98">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 346[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Calcular com base na tabela do INPC vigente na data da DIB</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-calculator"></i>[m
[31m-                  </span> CÁLCULAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-     <!-- Tabela e Informações do Cálculo Entre 16/12/1998 e 28/11/1999 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculo98_99">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} Entre 16/12/1998 e 28/11/1999</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimaria99.anos}} ano(s), {{contribuicaoPrimaria99.meses}} mês(es) e {{contribuicaoPrimaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundaria99.anos}} ano(s), {{contribuicaoSecundaria99.meses}} mês(es) e {{contribuicaoSecundaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-[m
[31m-              <div class="alert alert-warning margin-top-10" *ngFor="let erro of errosCalculo98_99" role="alert">[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-[m
[31m-              <!-- <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>NÃO POSSUI</strong> direito ao benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 16 ano(s)</strong> para atingir a idade mínima.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 18 ano(s) e 10 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 19 ano(s) e 11 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>PROPORCIONAL</strong>.</div> -->[m
[31m-[m
[31m-            </div>[m
[31m-            <div>[m
[31m-              <sa-datatable [options]="calculo98_99TableOptions" *ngIf="!isUpdating && errosCalculo98_99.length == 0"[m
[31m-                paginationLength="true" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>Competência</th>[m
[31m-                    <th>Fator</th>[m
[31m-                    <th>Contribuição Primaria</th>[m
[31m-                    <th>Contribuição Secundária</th>[m
[31m-                    <th>Contribuição Primária Corrigida</th>[m
[31m-                    <th>Contribuição Secundária Corrigida</th>[m
[31m-                    <th>Limite</th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-              </sa-datatable>[m
[31m-            </div>[m
[31m-            <div class="widget-body" *ngIf="!isUpdating && errosCalculo98_99.length == 0">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Índice de reajuste no teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.indice_reajuste_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.total_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.media_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.divisor_calculo_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.total_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.media_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.divisor_calculo_media_secundaria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Coeficiente:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.coeficiente}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.media_contribuicoes}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Salário Mínimo:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.salario_minimo}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.renda_mensal_inicial}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial na DIB:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.renda_mensal_inicial_data_dib}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Opções do Cálculo A partir de 29/11/1999-->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculoApos99">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 347[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Tabela e Informações do Cálculo A partir de 29/11/1999 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculoApos99">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} A partir de 29/11/1999</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimaria99.anos}} ano(s), {{contribuicaoPrimaria99.meses}} mês(es) e {{contribuicaoPrimaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundaria99.anos}} ano(s), {{contribuicaoSecundaria99.meses}} mês(es) e {{contribuicaoSecundaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-              <div class="alert alert-warning margin-top-10" *ngFor="let erro of errosCalculoApos99" role="alert">[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-              <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-                <div>[m
[31m-                  <div class="widget-body no-padding">[m
[31m-                    <sa-datatable [options]="calculoApos99TableOptions"[m
[31m-                      paginationLength="true" *ngIf="!isUpdating" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                      <thead>[m
[31m-                        <tr>[m
[31m-                          <th>#</th>[m
[31m-                          <th>Competência</th>[m
[31m-                          <!-- <th>Índice</th> TODO -->[m
[31m-                          <th>Índice</th>[m
[31m-                          <th>Contribuição Primária</th>[m
[31m-                          <th>Contribuição Secundária</th>[m
[31m-                          <th>Contribuição Primária Corrigida</th>[m
[31m-                          <th>Contribuição Secundária Corrigida</th>[m
[31m-                          <th>Observação</th>[m
[31m-                        </tr>[m
[31m-                      </thead>[m
[31m-                    </sa-datatable>[m
[31m-                  </div>[m
[31m-                </div>[m
[31m-              </sa-widget>[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr *ngFor="let conclusao of conclusoesApos99">[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">{{conclusao.string}}</span>[m
[31m-                    </td>[m
[31m-                    <td>{{conclusao.value}}</td>[m
[31m-                  </tr>[m
[31m-                  <!-- <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Soma das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td>R$ 790.293,52</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>197</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td>R$ 4.011,64</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Idade em anos:</span>[m
[31m-                    </td>[m
[31m-                    <td>55(55,52)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td>R$ 4.011,64</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">CT - Número de competências transcorridas desde 29/11/1999: </span>[m
[31m-                    </td>[m
[31m-                    <td>60</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Fórmula Fator:</span>[m
[31m-                    </td>[m
[31m-                    <td>((38,6493 * 0,31) / 26,2) * (1 + (55,52 + (38,6493 * 0,31)) / 100)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Fp - Fator Previdenciario:</span>[m
[31m-                    </td>[m
[31m-                    <td>0,766 - <strong>Não tem direito a Regra 85/95</strong></td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Índice de reajuste no teto:</span>[m
[31m-                    </td>[m
[31m-                    <td>1</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Expectativa de Sobrevida:</span>[m
[31m-                    </td>[m
[31m-                    <td>26,2</td>[m
[31m-                  </tr>[m
[31m-                  <tr class="success">[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial com Fator Previdenciario:</span>[m
[31m-                    </td>[m
[31m-                    <td><strong class="text-success">R$ 3.072,86</strong></td>[m
[31m-                  </tr> -->[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-[m
[31m-[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[32m+[m[32m      <app-rgps-resultados-anterior88 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      [isBlackHole]="isBlackHole" *ngIf="mostrarCalculoAnterior88"></app-rgps-resultados-anterior88>[m
[32m+[m
[32m+[m[32m      <app-rgps-resultados-entre91e98 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      [tipoCalculo]="'91_98'"[m
[32m+[m[32m      *ngIf="mostrarCalculo91_98"></app-rgps-resultados-entre91e98>[m
[32m+[m
[32m+[m[32m      <app-rgps-resultados-entre91e98 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      [tipoCalculo]="'98_99'"[m
[32m+[m[32m      *ngIf="mostrarCalculo98_99"></app-rgps-resultados-entre91e98>[m
[32m+[m
[32m+[m[32m      <app-rgps-resultados-apos99 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      *ngIf="mostrarCalculoApos99"></app-rgps-resultados-apos99>[m
 [m
     </div>[m
 [m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts[m
[1mindex c5a6561..9f744ca 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts[m
[36m@@ -263,13 +263,7 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     private route: ActivatedRoute,[m
     protected Segurado: SeguradoService,    [m
     protected CalculoRgps: CalculoRgpsService,[m
[31m-    protected ValoresContribuidos: ValorContribuidoService,[m
[31m-    private Moeda: MoedaService,[m
[31m-    private IndiceInps: IndiceInpsService,[m
[31m-    private SalarioMinimoMaximo: SalarioMinimoMaximoService,[m
[31m-    private CarenciaProgressiva:CarenciaProgressivaService,[m
[31m-    private ReajusteAutomatico:ReajusteAutomaticoService,[m
[31m-    private ExpectativaVida: ExpectativaVidaService,) {}[m
[32m+[m[32m  ) {}[m
 [m
   ngOnInit() {[m
   	this.idSegurado = this.route.snapshot.params['id_segurado'];[m
[36m@@ -286,303 +280,226 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
           .then(calculo => {[m
             this.calculo = calculo;[m
 [m
[31m-            this.tipoBeneficio = this.getEspecieBeneficio();[m
[32m+[m[32m            this.tipoBeneficio = this.getEspecieBeneficio(this.calculo);[m
             this.dataInicioBeneficio = moment(this.calculo.data_pedido_beneficio, 'DD/MM/YYYY');[m
[31m-            let dataInicio = this.getDataInicio();[m
[31m-            let dataLimite = this.getDataLimite(dataInicio);[m
             this.preencheGrupoDeCalculos();[m
             this.controleExibicao()[m
[31m-            this.CarenciaProgressiva.getCarencias()[m
[31m-              .then(carencias => {[m
[31m-                this.carenciasProgressivas = carencias;[m
[31m-              [m
[31m-                this.ValoresContribuidos.getByCalculoId(this.idCalculo, dataInicio, dataLimite)[m
[31m-                  .then(valorescontribuidos => {[m
[31m-                    this.listaValoresContribuidos = valorescontribuidos;[m
[31m-                    this.primeiraDataTabela = moment(this.listaValoresContribuidos[this.listaValoresContribuidos.length - 1].data);[m
[31m-                    this.Moeda.getByDateRange(this.primeiraDataTabela, moment())[m
[31m-                      .then((moeda: Moeda[]) => {[m
[31m-                        this.moeda = moeda;[m
[31m-    [m
[31m-                        if(this.dataInicioBeneficio < moment('1991-04-04')){[m
[31m-                          this.IndiceInps.getByDate(this.dataInicioBeneficio.clone().startOf('month'))[m
[31m-                            .then(indices => {[m
[31m-                              this.inpsList = indices;[m
[31m-                              this.SalarioMinimoMaximo.getByDate((this.dataInicioBeneficio.clone()).startOf('month'))[m
[31m-                                .then(salario => {[m
[31m-                                  this.salarioMinimoMaximo = salario[0];[m
[31m-                                  this.contribuicaoPrimariaAnterior88 = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[31m-                                  this.contribuicaoSecundariaAnterior88 = this.getContribuicaoObj(this.calculo.contribuicao_secundaria_98);[m
[31m-                                  this.calculoAnterior88(this.conclusoesAnterior88);[m
[31m-                                  [m
[31m-                                  if(this.calculo.tipo_aposentadoria == 'Entre 05/10/1988 e 04/04/1991'){[m
[31m-                                    this.ReajusteAutomatico.getByDate(this.dataDib98, this.dataInicioBeneficio)[m
[31m-                                      .then(reajustes => {[m
[31m-                                        this.reajustesAutomaticos = reajustes;[m
[31m-                                        this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                        this.isUpdating = false;[m
[31m-                                    });[m
[31m-                                  }[m
[31m-                                  this.isUpdating = false;[m
[31m-                                });[m
[31m-                            });[m
[31m-                        }[m
[31m-                        let dataReajustesAutomaticos = this.dataInicioBeneficio;[m
[31m-                        if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-                          dataReajustesAutomaticos = this.dataDib98;[m
[31m-                        }else if(this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999'){[m
[31m-                          dataReajustesAutomaticos = this.dataDib99;[m
[31m-                        }[m
[31m-                        if(this.dataInicioBeneficio >= moment('1991-04-04') && this.dataInicioBeneficio < moment('1999-11-29')){[m
[31m-                          this.ReajusteAutomatico.getByDate(dataReajustesAutomaticos, this.dataInicioBeneficio)[m
[31m-                            .then(reajustes => {[m
[31m-                              this.reajustesAutomaticos = reajustes;[m
[31m-                              if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-                                this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                this.isUpdating = false;[m
[31m-                              }[m
[31m-                              if(this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999'){[m
[31m-                                //entre 98 e 99 ( = entre 91 e 98) (tempo de contribuicao até a lei 99)(cálculos realizados em box separados)[m
[31m-                                this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                this.calculo91_98(this.errosCalculo98_99, this.conclusoes98_99, this.contribuicaoPrimaria99, this.contribuicaoSecundaria99, '98_99');[m
[31m-                                this.isUpdating = false;[m
[31m-                              }[m
[31m-                          });[m
[31m-                        }[m
[31m-    [m
[31m-                        if(this.dataInicioBeneficio >= moment('1999-11-29')){[m
[31m-                          this.ReajusteAutomatico.getByDate(dataReajustesAutomaticos, this.dataInicioBeneficio)[m
[31m-                            .then(reajustes => {[m
[31m-                              this.reajustesAutomaticos = reajustes;[m
[31m-                              [m
[31m-                            this.ExpectativaVida.getByIdade(Math.floor(this.idadeFracionada))[m
[31m-                              .then(expectativas => {[m
[31m-                                this.expectativasVida = expectativas;[m
[31m-                                this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                this.calculo91_98(this.errosCalculo98_99, this.conclusoes98_99, this.contribuicaoPrimaria99, this.contribuicaoSecundaria99, '98_99');[m
[31m-                                this.calculo_apos_99(this.errosCalculoApos99, this.conclusoesApos99, this.contribuicaoPrimaria99, this.contribuicaoSecundaria99);[m
[31m-                                this.isUpdating = false; [m
[31m-                            });[m
[31m-                          });[m
[31m-                        }[m
[31m-                      });[m
[31m-                  });[m
[31m-              });[m
[31m-          });[m
[31m-      });[m
[31m-  }[m
[31m-[m
[31m-  verificaErrosAnterior88(){[m
[31m-    let erro = "";[m
[31m-    let anoContribuicaoPrimariaAnterior88 = this.contribuicaoPrimariaAnterior88.anos;[m
[31m-    if ((this.calculo.tipo_seguro == "Aposentadoria por Idade (Rural)" ||[m
[31m-         this.calculo.tipo_seguro == "Aposentadoria por idade (Urbano)") && this.calculo.carencia < 60){[m
[31m-      erro = "Falta(m) "+ (60 - this.calculo.carencia) + " mês(es) para a carencia necessária.";[m
[31m-    }else if(this.segurado.sexo == 'h' && this.idadeSegurado < 65 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[31m-      erro = "O segurado não tem a idade mínima (65 anos) para se aposentar por idade. Falta(m) " + (65 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[31m-    }else if(this.segurado.sexo == 'm' && this.idadeSegurado < 60 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[31m-      erro = "O segurado não tem a idade mínima (60 anos) para se aposentar por idade. Falta(m) " + (60 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[31m-    }else if(this.calculo.tipo_seguro == "Aposentadoria por tempo de serviço" && [m
[31m-             anoContribuicaoPrimariaAnterior88 < 30){[m
[31m-      //TODO: Colocar mensagem completa :[m
[31m-      //Falta(m) "quantidade de anos que faltam" ano(s), "Quantidade de meses que faltam" mês(es) e quantidade de dia(s) para completar o tempo de serviço necessário.[m
[31m-      erro = "Erro no tempo de contibuição";[m
[31m-    }else if (this.listaValoresContribuidos.length == 0){[m
[31m-      erro = "Nenhuma contribuição encontrada em até 48 meses para este cálculo <a href='http://www.ieprev.com.br/legislacao/4506/decreto-no-83.080,-de-24-1-1979' target='_blank'>Art. 37 da Decreto nº 83.080, de 24/01/1979</a>"[m
[31m-    }[m
[31m-    return erro;[m
[32m+[m[32m            this.isUpdating = false;[m
[32m+[m[32m        });[m
[32m+[m[32m    });[m
   }[m
 [m
[31m-  calculoAnterior88(conclusoes){[m
[31m-    let index = 0;[m
[31m-    let mesPrimario = 0;[m
[31m-    let mesSecundario = 0;[m
[31m-    let tableData = [];[m
[31m-    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-    let totalPrimario = 0;[m
[31m-    let totalSecundario = 0;[m
[31m-    let anoPrimario = this.contribuicaoPrimariaAnterior88.anos;[m
[31m-    let anoSecundario = this.contribuicaoSecundariaAnterior88.anos;[m
[31m-[m
[31m-    for(let contribuicao of this.listaValoresContribuidos){[m
[31m-      let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[31m-      let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[31m-      let dataContribuicao = moment(contribuicao.data);[m
[31m-      let currency = this.loadCurrency(dataContribuicao);[m
[31m-[m
[31m-      if(valorSecundario){[m
[31m-        mesSecundario++;[m
[31m-      }else{[m
[31m-        valorSecundario = 0;[m
[31m-      }[m
[32m+[m[32m //  verificaErrosAnterior88(){[m
[32m+[m[32m //    let erro = "";[m
[32m+[m[32m //    let anoContribuicaoPrimariaAnterior88 = this.contribuicaoPrimariaAnterior88.anos;[m
[32m+[m[32m //    if ((this.calculo.tipo_seguro == "Aposentadoria por Idade (Rural)" ||[m
[32m+[m[32m //         this.calculo.tipo_seguro == "Aposentadoria por idade (Urbano)") && this.calculo.carencia < 60){[m
[32m+[m[32m //      erro = "Falta(m) "+ (60 - this.calculo.carencia) + " mês(es) para a carencia necessária.";[m
[32m+[m[32m //    }else if(this.segurado.sexo == 'h' && this.idadeSegurado < 65 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[32m+[m[32m //      erro = "O segurado não tem a idade mínima (65 anos) para se aposentar por idade. Falta(m) " + (65 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[32m+[m[32m //    }else if(this.segurado.sexo == 'm' && this.idadeSegurado < 60 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[32m+[m[32m //      erro = "O segurado não tem a idade mínima (60 anos) para se aposentar por idade. Falta(m) " + (60 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[32m+[m[32m //    }else if(this.calculo.tipo_seguro == "Aposentadoria por tempo de serviço" &&[m[41m [m
[32m+[m[32m //             anoContribuicaoPrimariaAnterior88 < 30){[m
[32m+[m[32m //      //TODO: Colocar mensagem completa :[m
[32m+[m[32m //      //Falta(m) "quantidade de anos que faltam" ano(s), "Quantidade de meses que faltam" mês(es) e quantidade de dia(s) para completar o tempo de serviço necessário.[m
[32m+[m[32m //      erro = "Erro no tempo de contibuição";[m
[32m+[m[32m //    }else if (this.listaValoresContribuidos.length == 0){[m
[32m+[m[32m //      erro = "Nenhuma contribuição encontrada em até 48 meses para este cálculo <a href='http://www.ieprev.com.br/legislacao/4506/decreto-no-83.080,-de-24-1-1979' target='_blank'>Art. 37 da Decreto nº 83.080, de 24/01/1979</a>"[m
[32m+[m[32m //    }[m
[32m+[m[32m //    return erro;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  calculoAnterior88(conclusoes){[m
[32m+[m[32m //    let index = 0;[m
[32m+[m[32m //    let mesPrimario = 0;[m
[32m+[m[32m //    let mesSecundario = 0;[m
[32m+[m[32m //    let tableData = [];[m
[32m+[m[32m //    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m //    let totalPrimario = 0;[m
[32m+[m[32m //    let totalSecundario = 0;[m
[32m+[m[32m //    let anoPrimario = this.contribuicaoPrimariaAnterior88.anos;[m
[32m+[m[32m //    let anoSecundario = this.contribuicaoSecundariaAnterior88.anos;[m
[32m+[m
[32m+[m[32m //    for(let contribuicao of this.listaValoresContribuidos){[m
[32m+[m[32m //      let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[32m+[m[32m //      let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[32m+[m[32m //      let dataContribuicao = moment(contribuicao.data);[m
[32m+[m[32m //      let currency = this.loadCurrency(dataContribuicao);[m
[32m+[m
[32m+[m[32m //      if(valorSecundario){[m
[32m+[m[32m //        mesSecundario++;[m
[32m+[m[32m //      }else{[m
[32m+[m[32m //        valorSecundario = 0;[m
[32m+[m[32m //      }[m
       [m
[31m-      let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[31m-      let contribuicaoSecundariaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currency.acronimo) : "";[m
[31m-      let inps = this.getInps(dataContribuicao.year());[m
[31m-[m
[31m-      let valorAjustadoObj = this.limitarTetosEMinimos(valorPrimario, dataContribuicao);[m
[31m-      valorPrimario = valorAjustadoObj.valor;[m
[31m-      let limiteString = valorAjustadoObj.aviso;[m
[31m-[m
[31m-      if (index > 11 && inps != null) {[m
[31m-        valorPrimario *= inps;[m
[31m-      }[m
[31m-      valorPrimario = this.convertCurrency(valorPrimario, dataContribuicao, this.dataInicioBeneficio);[m
[31m-        if (valorSecundario > 0){[m
[31m-        valorSecundario = (this.limitarTetosEMinimos(valorSecundario, dataContribuicao)).valor;[m
[31m-      }[m
[31m-[m
[31m-      if (index > 11 && inps != null) {[m
[31m-        valorSecundario *= inps;[m
[31m-      }[m
[31m-      valorSecundario = this.convertCurrency(valorSecundario, dataContribuicao, this.dataInicioBeneficio);[m
[31m-      totalPrimario += valorPrimario;[m
[31m-      totalSecundario += valorSecundario;[m
[31m-      let inpsString = '';[m
[31m-      if(index > 11 && inps != null){[m
[31m-        inpsString = inps;[m
[31m-      }else{[m
[31m-        inpsString  = '1.00';[m
[31m-      }[m
[31m-      let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimario, currencyDataInicioBeneficio.acronimo);[m
[31m-      let contribuicaoSecundariaRevisadaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currencyDataInicioBeneficio.acronimo) : '';[m
[31m-      let line = {competencia: dataContribuicao.format('MM/YYYY'),[m
[31m-              contribuicao_primaria: contribuicaoPrimariaString,[m
[31m-              contribuicao_secundaria: contribuicaoSecundariaString,[m
[31m-              inps: this.formatDecimal(inpsString,2),[m
[31m-              contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[31m-              contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[31m-              limite: limiteString};[m
[31m-      tableData.push(line);[m
[31m-      index++;[m
[31m-    }[m
[31m-    let somaContribuicoes = totalPrimario + totalSecundario;[m
[31m-    let mediaContribuicoesPrimaria = totalPrimario / index;[m
[31m-    let mediaContribuicoesSecundaria = 0;[m
[31m-    if(totalSecundario > 0){[m
[31m-      if((this.tipoBeneficio == 4 || this.tipoBeneficio == 6) && anoSecundario != 0 && mesSecundario != 0){[m
[31m-        mediaContribuicoesSecundaria = totalSecundario / (mesSecundario) * (anoSecundario / 30.0);[m
[31m-      }else if(anoSecundario != 0 && mesSecundario != 0){[m
[31m-        let lackAux = 0;[m
[31m-        if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[31m-          lackAux = 12;[m
[31m-        } else {[m
[31m-          lackAux = 60;[m
[31m-        }[m
[31m-        mediaContribuicoesSecundaria = totalSecundario * (mesSecundario / lackAux); [m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    let mediaTotal = mediaContribuicoesPrimaria + mediaContribuicoesSecundaria;[m
[31m-    let rmi = this.calculateRMI(mediaTotal,somaContribuicoes, conclusoes);[m
[31m-[m
[31m-    // Exibir as conclusões:[m
[31m-    conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimario, currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimaria, currencyDataInicioBeneficio.acronimo);[m
[31m-    if(totalSecundario > 0){[m
[31m-      conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundario, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaContribuicoesSecundaria, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.divisor_calculo_media_secundaria = mesSecundario;[m
[31m-    }[m
[31m-    conclusoes.divisor_calculo_media = index;[m
[31m-    conclusoes.media_contribuicoes = this.formatMoney(mediaTotal,currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currencyDataInicioBeneficio.acronimo);[m
[31m-[m
[31m-    this.calculoAnterior88TableData = tableData;[m
[31m-    this.calculoAnterior88TableOptions = {[m
[31m-      ...this.calculoAnterior88TableOptions,[m
[31m-      data: this.calculoAnterior88TableData,[m
[31m-    }[m
[31m-  }[m
[31m-[m
[31m-  calculateRMI(mediaTotal, somaContribuicoes, conclusoes){[m
[31m-    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-    let dataSalario = (this.dataInicioBeneficio.clone()).startOf('month');[m
[31m-    //let dataSalarioMoedaIndex = this.getIndex(dataSalario);[m
[31m-    let limitesSalariais = this.getLimitesSalariais(dataSalario);[m
[31m-    let grupoDos12 = this.calculo.grupo_dos_12;[m
[31m-[m
[31m-    conclusoes.maior_valor_teto = this.formatMoney(limitesSalariais.maximo, currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.menor_valor_teto = this.formatMoney(limitesSalariais.minimo, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[32m+[m[32m //      let contribuicaoSecundariaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currency.acronimo) : "";[m
[32m+[m[32m //      let inps = this.getInps(dataContribuicao.year());[m
[32m+[m
[32m+[m[32m //      let valorAjustadoObj = this.limitarTetosEMinimos(valorPrimario, dataContribuicao);[m
[32m+[m[32m //      valorPrimario = valorAjustadoObj.valor;[m
[32m+[m[32m //      let limiteString = valorAjustadoObj.aviso;[m
[32m+[m
[32m+[m[32m //      if (index > 11 && inps != null) {[m
[32m+[m[32m //        valorPrimario *= inps;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      valorPrimario = this.convertCurrency(valorPrimario, dataContribuicao, this.dataInicioBeneficio);[m
[32m+[m[32m //        if (valorSecundario > 0){[m
[32m+[m[32m //        valorSecundario = (this.limitarTetosEMinimos(valorSecundario, dataContribuicao)).valor;[m
[32m+[m[32m //      }[m
[32m+[m
[32m+[m[32m //      if (index > 11 && inps != null) {[m
[32m+[m[32m //        valorSecundario *= inps;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      valorSecundario = this.convertCurrency(valorSecundario, dataContribuicao, this.dataInicioBeneficio);[m
[32m+[m[32m //      totalPrimario += valorPrimario;[m
[32m+[m[32m //      totalSecundario += valorSecundario;[m
[32m+[m[32m //      let inpsString = '';[m
[32m+[m[32m //      if(index > 11 && inps != null){[m
[32m+[m[32m //        inpsString = inps;[m
[32m+[m[32m //      }else{[m
[32m+[m[32m //        inpsString  = '1.00';[m
[32m+[m[32m //      }[m
[32m+[m[32m //      let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimario, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      let contribuicaoSecundariaRevisadaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currencyDataInicioBeneficio.acronimo) : '';[m
[32m+[m[32m //      let line = {competencia: dataContribuicao.format('MM/YYYY'),[m
[32m+[m[32m //              contribuicao_primaria: contribuicaoPrimariaString,[m
[32m+[m[32m //              contribuicao_secundaria: contribuicaoSecundariaString,[m
[32m+[m[32m //              inps: this.formatDecimal(inpsString,2),[m
[32m+[m[32m //              contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[32m+[m[32m //              contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[32m+[m[32m //              limite: limiteString};[m
[32m+[m[32m //      tableData.push(line);[m
[32m+[m[32m //      index++;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    let somaContribuicoes = totalPrimario + totalSecundario;[m
[32m+[m[32m //    let mediaContribuicoesPrimaria = totalPrimario / index;[m
[32m+[m[32m //    let mediaContribuicoesSecundaria = 0;[m
[32m+[m[32m //    if(totalSecundario > 0){[m
[32m+[m[32m //      if((this.tipoBeneficio == 4 || this.tipoBeneficio == 6) && anoSecundario != 0 && mesSecundario != 0){[m
[32m+[m[32m //        mediaContribuicoesSecundaria = totalSecundario / (mesSecundario) * (anoSecundario / 30.0);[m
[32m+[m[32m //      }else if(anoSecundario != 0 && mesSecundario != 0){[m
[32m+[m[32m //        let lackAux = 0;[m
[32m+[m[32m //        if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[32m+[m[32m //          lackAux = 12;[m
[32m+[m[32m //        } else {[m
[32m+[m[32m //          lackAux = 60;[m
[32m+[m[32m //        }[m
[32m+[m[32m //        mediaContribuicoesSecundaria = totalSecundario * (mesSecundario / lackAux);[m[41m [m
[32m+[m[32m //      }[m
[32m+[m[32m //    }[m
[32m+[m
[32m+[m[32m //    let mediaTotal = mediaContribuicoesPrimaria + mediaContribuicoesSecundaria;[m
[32m+[m[32m //    let rmi = this.calculateRMI(mediaTotal,somaContribuicoes, conclusoes);[m
[32m+[m
[32m+[m[32m //    // Exibir as conclusões:[m
[32m+[m[32m //    conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimario, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimaria, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    if(totalSecundario > 0){[m
[32m+[m[32m //      conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundario, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaContribuicoesSecundaria, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.divisor_calculo_media_secundaria = mesSecundario;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    conclusoes.divisor_calculo_media = index;[m
[32m+[m[32m //    conclusoes.media_contribuicoes = this.formatMoney(mediaTotal,currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currencyDataInicioBeneficio.acronimo);[m
[32m+[m
[32m+[m[32m //    this.calculoAnterior88TableData = tableData;[m
[32m+[m[32m //    this.calculoAnterior88TableOptions = {[m
[32m+[m[32m //      ...this.calculoAnterior88TableOptions,[m
[32m+[m[32m //      data: this.calculoAnterior88TableData,[m
[32m+[m[32m //    }[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  calculateRMI(mediaTotal, somaContribuicoes, conclusoes){[m
[32m+[m[32m //    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m //    let dataSalario = (this.dataInicioBeneficio.clone()).startOf('month');[m
[32m+[m[32m //    //let dataSalarioMoedaIndex = this.getIndex(dataSalario);[m
[32m+[m[32m //    let limitesSalariais = this.getLimitesSalariais(dataSalario);[m
[32m+[m[32m //    let grupoDos12 = this.calculo.grupo_dos_12;[m
[32m+[m
[32m+[m[32m //    conclusoes.maior_valor_teto = this.formatMoney(limitesSalariais.maximo, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.menor_valor_teto = this.formatMoney(limitesSalariais.minimo, currencyDataInicioBeneficio.acronimo);[m
     [m
[31m-    let anoContribuicao = this.calculo.contribuicao_primaria_98.split('-')[0];[m
[31m-[m
[31m-    let indiceEspecie = this.getIndiceEspecie(this.tipoBeneficio, this.segurado.sexo, anoContribuicao); // Seção 1.1.4[m
[31m-    let rmi = 0;[m
[31m-    if(mediaTotal >= limitesSalariais.minimo) {[m
[31m-      let primeiraParcela = indiceEspecie * limitesSalariais.minimo;[m
[31m-      if(limitesSalariais.maximo <= mediaTotal){[m
[31m-        mediaTotal = limitesSalariais.maximo;[m
[31m-      }[m
[31m-      // Calculo do valor do excedente[m
[31m-      let excedente = mediaTotal - limitesSalariais.minimo;[m
[31m-      let segundaParcela = (grupoDos12 / 30) * excedente;[m
[31m-      if(segundaParcela > (0.8 * excedente)){[m
[31m-        segundaParcela = 0.8 * excedente;[m
[31m-      }[m
[31m-      let somaParcelas = primeiraParcela + segundaParcela;[m
[31m-      if(somaParcelas > (0.9 * limitesSalariais.maximo)){[m
[31m-        rmi = (0.9 * limitesSalariais.maximo);[m
[31m-      }else{[m
[31m-        rmi = somaParcelas;[m
[31m-      }[m
[31m-      //Inserir nas conclusões[m
[31m-      conclusoes.primeira_parcela_rmi = this.formatMoney(primeiraParcela, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.grupo_dos_12 =  grupoDos12;[m
[31m-      conclusoes.valor_excedente = this.formatMoney(excedente, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.segunda_parcela_rmi = this.formatMoney(segundaParcela, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.oitenta_porcento_valor_excedente = this.formatMoney((0.8 * excedente), currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.noventa_porcento_maior_valor_teto = this.formatMoney((0.9 * limitesSalariais.maximo),currencyDataInicioBeneficio.acronimo) ;[m
[31m-    } else {[m
[31m-      rmi = indiceEspecie * mediaTotal;[m
[31m-    }[m
[31m-[m
[31m-    let indiceSalarioMinimo = this.getIndiceSalarioMinimo(this.tipoBeneficio, anoContribuicao);[m
[31m-    let valorSalarioMinimo = indiceSalarioMinimo * (this.Moeda.getByDate(dataSalario)).salario_minimo;[m
[31m-    if (rmi > (0.95 * mediaTotal)) {[m
[31m-        rmi = 0.95 * mediaTotal;[m
[31m-    } else if (rmi < valorSalarioMinimo) {[m
[31m-        rmi = valorSalarioMinimo;[m
[31m-    }[m
[31m-    conclusoes.porcentagem_calculo_beneficio = indiceEspecie * 100;[m
[31m-    conclusoes.beneficio_minimo_com_indice =  this.formatMoney(valorSalarioMinimo, currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.noventaecinco_porcento_valor_da_media = this.formatMoney((0.95*mediaTotal), currencyDataInicioBeneficio.acronimo);[m
[31m-[m
[31m-    // TODO: Nesse momento Salvar o valor da RMI e da somaContribuições no BD do calculo.[m
[31m-    return rmi;[m
[31m-  }[m
[31m-[m
[31m-  getInps(year){[m
[31m-    if(this.inpsList){[m
[31m-      for(let inps of this.inpsList){[m
[31m-        if(inps.ano == year){[m
[31m-          return inps.valor;[m
[31m-        }[m
[31m-      }[m
[31m-      return null;[m
[31m-    }[m
[31m-    return null;[m
[31m-  }[m
[31m-[m
[31m-  getLimitesSalariais(data){[m
[31m-    let ret = {minimo: this.salarioMinimoMaximo.minimum_salary_ammount, maximo: this.salarioMinimoMaximo.maximum_salary_ammount};[m
[31m-    return ret;[m
[31m-  }[m
[31m-[m
[31m-  getIndiceSalarioMinimo(especie, anoContribuicao){[m
[31m-  	let index = 0.0;[m
[31m-  	if (especie === 1){[m
[31m-  		index = 0.75;[m
[31m-  	} else if ((especie > 1 && especie <= 5) || especie === 16){[m
[31m-  		index = 0.9;[m
[31m-  	} else if (especie === 20){[m
[31m-  		index = 0.25;[m
[31m-  		if (anoContribuicao >= 30 && anoContribuicao < 35){[m
[31m-        index = 0.2;[m
[31m-      }[m
[31m-  	}[m
[31m-    return index;[m
[31m-	}[m
[32m+[m[32m //    let anoContribuicao = this.calculo.contribuicao_primaria_98.split('-')[0];[m
[32m+[m
[32m+[m[32m //    let indiceEspecie = this.getIndiceEspecie(this.tipoBeneficio, this.segurado.sexo, anoContribuicao); // Seção 1.1.4[m
[32m+[m[32m //    let rmi = 0;[m
[32m+[m[32m //    if(mediaTotal >= limitesSalariais.minimo) {[m
[32m+[m[32m //      let primeiraParcela = indiceEspecie * limitesSalariais.minimo;[m
[32m+[m[32m //      if(limitesSalariais.maximo <= mediaTotal){[m
[32m+[m[32m //        mediaTotal = limitesSalariais.maximo;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      // Calculo do valor do excedente[m
[32m+[m[32m //      let excedente = mediaTotal - limitesSalariais.minimo;[m
[32m+[m[32m //      let segundaParcela = (grupoDos12 / 30) * excedente;[m
[32m+[m[32m //      if(segundaParcela > (0.8 * excedente)){[m
[32m+[m[32m //        segundaParcela = 0.8 * excedente;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      let somaParcelas = primeiraParcela + segundaParcela;[m
[32m+[m[32m //      if(somaParcelas > (0.9 * limitesSalariais.maximo)){[m
[32m+[m[32m //        rmi = (0.9 * limitesSalariais.maximo);[m
[32m+[m[32m //      }else{[m
[32m+[m[32m //        rmi = somaParcelas;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      //Inserir nas conclusões[m
[32m+[m[32m //      conclusoes.primeira_parcela_rmi = this.formatMoney(primeiraParcela, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.grupo_dos_12 =  grupoDos12;[m
[32m+[m[32m //      conclusoes.valor_excedente = this.formatMoney(excedente, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.segunda_parcela_rmi = this.formatMoney(segundaParcela, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.oitenta_porcento_valor_excedente = this.formatMoney((0.8 * excedente), currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.noventa_porcento_maior_valor_teto = this.formatMoney((0.9 * limitesSalariais.maximo),currencyDataInicioBeneficio.acronimo) ;[m
[32m+[m[32m //    } else {[m
[32m+[m[32m //      rmi = indiceEspecie * mediaTotal;[m
[32m+[m[32m //    }[m
[32m+[m
[32m+[m[32m //    let indiceSalarioMinimo = this.getIndiceSalarioMinimo(this.tipoBeneficio, anoContribuicao);[m
[32m+[m[32m //    let valorSalarioMinimo = indiceSalarioMinimo * (this.Moeda.getByDate(dataSalario)).salario_minimo;[m
[32m+[m[32m //    if (rmi > (0.95 * mediaTotal)) {[m
[32m+[m[32m //        rmi = 0.95 * mediaTotal;[m
[32m+[m[32m //    } else if (rmi < valorSalarioMinimo) {[m
[32m+[m[32m //        rmi = valorSalarioMinimo;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    conclusoes.porcentagem_calculo_beneficio = indiceEspecie * 100;[m
[32m+[m[32m //    conclusoes.beneficio_minimo_com_indice =  this.formatMoney(valorSalarioMinimo, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.noventaecinco_porcento_valor_da_media = this.formatMoney((0.95*mediaTotal), currencyDataInicioBeneficio.acronimo);[m
[32m+[m
[32m+[m[32m //    // TODO: Nesse momento Salvar o valor da RMI e da somaContribuições no BD do calculo.[m
[32m+[m[32m //    return rmi;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  getInps(year){[m
[32m+[m[32m //    if(this.inpsList){[m
[32m+[m[32m //      for(let inps of this.inpsList){[m
[32m+[m[32m //        if(inps.ano == year){[m
[32m+[m[32m //          return inps.valor;[m
[32m+[m[32m //        }[m
[32m+[m[32m //      }[m
[32m+[m[32m //      return null;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    return null;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  getLimitesSalariais(data){[m
[32m+[m[32m //    let ret = {minimo: this.salarioMinimoMaximo.minimum_salary_ammount, maximo: this.salarioMinimoMaximo.maximum_salary_ammount};[m
[32m+[m[32m //    return ret;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  getIndiceSalarioMinimo(especie, anoContribuicao){[m
[32m+[m[32m //  	let index = 0.0;[m
[32m+[m[32m //  	if (especie === 1){[m
[32m+[m[32m //  		index = 0.75;[m
[32m+[m[32m //  	} else if ((especie > 1 && especie <= 5) || especie === 16){[m
[32m+[m[32m //  		index = 0.9;[m
[32m+[m[32m //  	} else if (especie === 20){[m
[32m+[m[32m //  		index = 0.25;[m
[32m+[m[32m //  		if (anoContribuicao >= 30 && anoContribuicao < 35){[m
[32m+[m[32m //        index = 0.2;[m
[32m+[m[32m //      }[m
[32m+[m[32m //  	}[m
[32m+[m[32m //    return index;[m
[32m+[m	[32m// }[m
 [m
   loadCurrency(data){[m
     for(let currency of this.currencyList){[m
[36m@@ -594,345 +511,345 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     }[m
   }[m
 [m
[31m-  calculo91_98(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria, periodo){[m
[31m-    let dib = this.dataInicioBeneficio;[m
[31m-    let dibCurrency = this.loadCurrency(dib);[m
[31m-[m
[31m-    if (this.calculo.tipoAposentadoria == 'Entre 16/12/1998 e 28/11/1999' && [m
[31m-        this.dataInicioBeneficio > this.dataDib99) {[m
[31m-        dib = this.dataDib99;[m
[31m-    }[m
[31m-    if (this.calculo.tipoAposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[31m-        this.dataInicioBeneficio > this.dataDib98) {[m
[31m-        dib = this.dataDib98;[m
[31m-    }[m
[31m-[m
[31m-    let dataComparacao = (dib.clone()).startOf('month');[m
[31m-    let reajustesAdministrativos = true;[m
[31m-    if (reajustesAdministrativos) { // Definir tal booleano, a principio sempre true[m
[31m-      dataComparacao = (this.dataInicioBeneficio.clone()).startOf('month');[m
[31m-    }[m
[31m-[m
[31m-    let dibPrimeiro = (dib.clone()).startOf('month');[m
[31m-[m
[31m-    let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[31m-    let moedaDIB = this.Moeda.getByDate(dib);[m
[31m-[m
[31m-    if(this.listaValoresContribuidos.length == 0) {[m
[31m-      // Exibir MSG de erro e encerrar Cálculo.[m
[31m-      errorArray.push("Nenhuma contribuição encontrada em 48 meses anteriores a DIB conforme" + "http://www.ieprev.com.br/legislacao/10634/lei-no-8.213,-de-24-7-1991---atualizada-ate-dezembro-2008#art29' target='_blank'>Art. 29 da Lei nº 8.213, de 24/7/1991");[m
[31m-      return;[m
[31m-    }[m
[31m-[m
[31m-    if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[31m-      return;[m
[31m-    }[m
[31m-    let totalPrimaria = 0;[m
[31m-    let totalSecundaria = 0;[m
[31m-[m
[31m-    let contagemSecundaria = 0;[m
[31m-    let contagemPrimaria = 0;[m
[31m-    let tableData = [];[m
[31m-[m
[31m-    for(let contribuicao of this.listaValoresContribuidos) {[m
[31m-      contagemPrimaria++;[m
[32m+[m[32m  // calculo91_98(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria, periodo){[m
[32m+[m[32m  //   let dib = this.dataInicioBeneficio;[m
[32m+[m[32m  //   let dibCurrency = this.loadCurrency(dib);[m
[32m+[m
[32m+[m[32m  //   if (this.calculo.tipoAposentadoria == 'Entre 16/12/1998 e 28/11/1999' &&[m[41m [m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib99) {[m
[32m+[m[32m  //       dib = this.dataDib99;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   if (this.calculo.tipoAposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib98) {[m
[32m+[m[32m  //       dib = this.dataDib98;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let dataComparacao = (dib.clone()).startOf('month');[m
[32m+[m[32m  //   let reajustesAdministrativos = true;[m
[32m+[m[32m  //   if (reajustesAdministrativos) { // Definir tal booleano, a principio sempre true[m
[32m+[m[32m  //     dataComparacao = (this.dataInicioBeneficio.clone()).startOf('month');[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let dibPrimeiro = (dib.clone()).startOf('month');[m
[32m+[m
[32m+[m[32m  //   let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[32m+[m[32m  //   let moedaDIB = this.Moeda.getByDate(dib);[m
[32m+[m
[32m+[m[32m  //   if(this.listaValoresContribuidos.length == 0) {[m
[32m+[m[32m  //     // Exibir MSG de erro e encerrar Cálculo.[m
[32m+[m[32m  //     errorArray.push("Nenhuma contribuição encontrada em 48 meses anteriores a DIB conforme" + "http://www.ieprev.com.br/legislacao/10634/lei-no-8.213,-de-24-7-1991---atualizada-ate-dezembro-2008#art29' target='_blank'>Art. 29 da Lei nº 8.213, de 24/7/1991");[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   let totalPrimaria = 0;[m
[32m+[m[32m  //   let totalSecundaria = 0;[m
[32m+[m
[32m+[m[32m  //   let contagemSecundaria = 0;[m
[32m+[m[32m  //   let contagemPrimaria = 0;[m
[32m+[m[32m  //   let tableData = [];[m
[32m+[m
[32m+[m[32m  //   for(let contribuicao of this.listaValoresContribuidos) {[m
[32m+[m[32m  //     contagemPrimaria++;[m
       [m
[31m-      let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[31m-      let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[31m-      let dataContribuicao = moment(contribuicao.data);[m
[32m+[m[32m  //     let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[32m+[m[32m  //     let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[32m+[m[32m  //     let dataContribuicao = moment(contribuicao.data);[m
         [m
[31m-      let contribuicaoPrimaria = 0;[m
[32m+[m[32m  //     let contribuicaoPrimaria = 0;[m
         [m
[31m-      if (valorPrimario != null){[m
[31m-        contribuicaoPrimaria = valorPrimario;[m
[31m-      }[m
[32m+[m[32m  //     if (valorPrimario != null){[m
[32m+[m[32m  //       contribuicaoPrimaria = valorPrimario;[m
[32m+[m[32m  //     }[m
 [m
[31m-      let contribuicaoSecundaria = 0;[m
[31m-      if (valorSecundario != null){[m
[31m-        contribuicaoSecundaria = valorSecundario;[m
[31m-      }[m
[32m+[m[32m  //     let contribuicaoSecundaria = 0;[m
[32m+[m[32m  //     if (valorSecundario != null){[m
[32m+[m[32m  //       contribuicaoSecundaria = valorSecundario;[m
[32m+[m[32m  //     }[m
 [m
[31m-      let currency = this.loadCurrency(dataContribuicao); //Definido na seção de algortimos uteis[m
[32m+[m[32m  //     let currency = this.loadCurrency(dataContribuicao); //Definido na seção de algortimos uteis[m
       [m
[31m-      let dataContribuicaoString = dataContribuicao.format('MM/YYYY');[m
[31m-      let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[31m-      let contribuicaoSecundariaString = '';[m
[31m-[m
[31m-      if (!this.isBlackHole){[m
[31m-        contribuicaoSecundariaString = this.formatMoney(valorSecundario, currency.acronimo);[m
[31m-      }[m
[31m-[m
[31m-      let moeda = this.Moeda.getByDate(dataContribuicao);[m
[31m-      let fator = moeda.fator;[m
[31m-      let fatorLimite = moedaComparacao.fator;[m
[31m-      let fatorCorrigido = fator / fatorLimite;[m
[31m-      let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4);[m
[31m-[m
[31m-      let valorPrimarioCorrigido = 0;[m
[31m-      let valorSecundarioCorrigido = 0;[m
[31m-[m
[31m-      let limiteString = '';[m
[31m-      if (contribuicaoPrimaria != 0) {[m
[31m-[m
[31m-        let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[31m-        contribuicaoPrimaria =  valorAjustadoObj.valor;[m
[31m-        limiteString = valorAjustadoObj.aviso;[m
[31m-      }[m
[31m-[m
[31m-      if (contribuicaoSecundaria != 0) {[m
[31m-        contribuicaoSecundaria = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor;[m
[31m-        contagemSecundaria ++;[m
[31m-      }[m
[31m-[m
[31m-      valorPrimarioCorrigido = contribuicaoPrimaria * fatorCorrigido;[m
[31m-      valorSecundarioCorrigido = contribuicaoSecundaria * fatorCorrigido;[m
[31m-[m
[31m-      let valorPrimarioRevisado   = this.convertCurrency(valorPrimarioCorrigido  , dataContribuicao, dib);[m
[31m-      let valorSecundarioRevisado = this.convertCurrency(valorSecundarioCorrigido, dataContribuicao, dib);[m
[31m-[m
[31m-      totalPrimaria += valorPrimarioRevisado;[m
[31m-      totalSecundaria += valorSecundarioRevisado;[m
[31m-[m
[31m-      let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimarioRevisado, dibCurrency.acronimo);[m
[31m-      let contribuicaoSecundariaRevisadaString = "";[m
[31m-      if (!this.isBlackHole){[m
[31m-        contribuicaoSecundariaRevisadaString = this.formatMoney(valorSecundarioRevisado, dibCurrency.acronimo); // Acronimo da moeda após a conversão.[m
[31m-      }[m
[31m-      let line = {competencia: dataContribuicaoString,[m
[31m-                  contribuicao_primaria: contribuicaoPrimariaString,[m
[31m-                  contribuicao_secundaria: contribuicaoSecundariaString,[m
[31m-                  fator: fatorCorrigidoString,[m
[31m-                  contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[31m-                  contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[31m-                  limite: limiteString};[m
[31m-      tableData.push(line);[m
[31m-[m
[31m-    }[m
[31m-[m
[31m-[m
[31m-    if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 5 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16){[m
[31m-      if(contagemPrimaria < 24){[m
[31m-        contagemPrimaria = 24;[m
[31m-      }[m
[31m-      if(contagemSecundaria < 24){[m
[31m-        contagemSecundaria = 24;[m
[31m-      }[m
[31m-    }[m
[32m+[m[32m  //     let dataContribuicaoString = dataContribuicao.format('MM/YYYY');[m
[32m+[m[32m  //     let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[32m+[m[32m  //     let contribuicaoSecundariaString = '';[m
[32m+[m
[32m+[m[32m  //     if (!this.isBlackHole){[m
[32m+[m[32m  //       contribuicaoSecundariaString = this.formatMoney(valorSecundario, currency.acronimo);[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     let moeda = this.Moeda.getByDate(dataContribuicao);[m
[32m+[m[32m  //     let fator = moeda.fator;[m
[32m+[m[32m  //     let fatorLimite = moedaComparacao.fator;[m
[32m+[m[32m  //     let fatorCorrigido = fator / fatorLimite;[m
[32m+[m[32m  //     let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4);[m
[32m+[m
[32m+[m[32m  //     let valorPrimarioCorrigido = 0;[m
[32m+[m[32m  //     let valorSecundarioCorrigido = 0;[m
[32m+[m
[32m+[m[32m  //     let limiteString = '';[m
[32m+[m[32m  //     if (contribuicaoPrimaria != 0) {[m
[32m+[m
[32m+[m[32m  //       let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[32m+[m[32m  //       contribuicaoPrimaria =  valorAjustadoObj.valor;[m
[32m+[m[32m  //       limiteString = valorAjustadoObj.aviso;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     if (contribuicaoSecundaria != 0) {[m
[32m+[m[32m  //       contribuicaoSecundaria = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor;[m
[32m+[m[32m  //       contagemSecundaria ++;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     valorPrimarioCorrigido = contribuicaoPrimaria * fatorCorrigido;[m
[32m+[m[32m  //     valorSecundarioCorrigido = contribuicaoSecundaria * fatorCorrigido;[m
[32m+[m
[32m+[m[32m  //     let valorPrimarioRevisado   = this.convertCurrency(valorPrimarioCorrigido  , dataContribuicao, dib);[m
[32m+[m[32m  //     let valorSecundarioRevisado = this.convertCurrency(valorSecundarioCorrigido, dataContribuicao, dib);[m
[32m+[m
[32m+[m[32m  //     totalPrimaria += valorPrimarioRevisado;[m
[32m+[m[32m  //     totalSecundaria += valorSecundarioRevisado;[m
[32m+[m
[32m+[m[32m  //     let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimarioRevisado, dibCurrency.acronimo);[m
[32m+[m[32m  //     let contribuicaoSecundariaRevisadaString = "";[m
[32m+[m[32m  //     if (!this.isBlackHole){[m
[32m+[m[32m  //       contribuicaoSecundariaRevisadaString = this.formatMoney(valorSecundarioRevisado, dibCurrency.acronimo); // Acronimo da moeda após a conversão.[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     let line = {competencia: dataContribuicaoString,[m
[32m+[m[32m  //                 contribuicao_primaria: contribuicaoPrimariaString,[m
[32m+[m[32m  //                 contribuicao_secundaria: contribuicaoSecundariaString,[m
[32m+[m[32m  //                 fator: fatorCorrigidoString,[m
[32m+[m[32m  //                 contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[32m+[m[32m  //                 contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[32m+[m[32m  //                 limite: limiteString};[m
[32m+[m[32m  //     tableData.push(line);[m
[32m+[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 5 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16){[m
[32m+[m[32m  //     if(contagemPrimaria < 24){[m
[32m+[m[32m  //       contagemPrimaria = 24;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(contagemSecundaria < 24){[m
[32m+[m[32m  //       contagemSecundaria = 24;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
     [m
 [m
[31m-    let mediaPrimaria = totalPrimaria / contagemPrimaria;[m
[31m-    let mediaSecundaria = 0;[m
[31m-    if(totalSecundaria > 0) {[m
[31m-      mediaSecundaria = totalSecundaria / contagemSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    let contribuicaoMedia = mediaPrimaria + mediaSecundaria;[m
[31m-[m
[31m-    let rmi = (this.limitarTetosEMinimos(contribuicaoMedia, dataComparacao)).valor;[m
[31m-[m
[31m-    let indiceReajuste = contribuicaoMedia / rmi;[m
[31m-[m
[31m-    // Coeficiente Calculado na função direitoAposentadoria[m
[31m-    rmi = rmi * (this.coeficiente / 100);[m
[31m-[m
[31m-    rmi = (this.limitarTetosEMinimos(rmi, dataComparacao)).valor;[m
[31m-[m
[31m-    let rmiValoresAdministrativos = rmi;[m
[31m-[m
[31m-    if(reajustesAdministrativos && [m
[31m-      ((this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' && this.dataInicioBeneficio >= this.dataDib99) ||[m
[31m-       (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' && this.dataInicioBeneficio >= this.dataDib98))){[m
[31m-           rmiValoresAdministrativos = this.getValoresAdministrativos(rmiValoresAdministrativos);[m
[31m-    }[m
[31m-[m
[31m-    if (this.tipoBeneficio == 17 || //AuxilioAcidente30[m
[31m-        this.tipoBeneficio == 18 || //AuxilioAcidente40[m
[31m-        this.tipoBeneficio == 7  || //AuxilioAcidente50[m
[31m-        this.tipoBeneficio == 19){  //AuxilioAcidente60[m
[31m-        let fatorAuxilio;[m
[31m-        switch(this.tipoBeneficio){[m
[31m-          case 17:[m
[31m-            fatorAuxilio = 0.3;[m
[31m-            break;[m
[31m-          case 18:[m
[31m-            fatorAuxilio = 0.4;[m
[31m-            break;[m
[31m-          case 7:[m
[31m-            fatorAuxilio = 0.5;[m
[31m-            break;[m
[31m-          case 19:[m
[31m-            fatorAuxilio = 0.6;[m
[31m-            break;[m
[31m-        }[m
[31m-        let moedaAuxilio = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[31m-        let salMinimo = moedaAuxilio.salario_minimo;[m
[31m-[m
[31m-        if(contribuicaoMedia > rmiValoresAdministrativos){[m
[31m-          rmiValoresAdministrativos = contribuicaoMedia * fatorAuxilio;[m
[31m-        }else{[m
[31m-          rmiValoresAdministrativos = salMinimo * fatorAuxilio;[m
[31m-        }[m
[31m-[m
[31m-        if (contribuicaoMedia > rmi){[m
[31m-          rmi = contribuicaoMedia * fatorAuxilio;[m
[31m-        }else{[m
[31m-          rmi = rmi * fatorAuxilio;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    let somaContribuicoes = totalPrimaria + totalSecundaria;[m
[31m-[m
[31m-    if (reajustesAdministrativos) {[m
[31m-       //TODO: salvarBeneficiosNoBD;[m
[31m-    }[m
[31m-[m
[31m-    let currency = this.loadCurrency(dib);[m
[31m-[m
[31m-    //Conclusões abaixo da tabela:[m
[31m-    conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimaria, currency.acronimo);[m
[31m-    conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaPrimaria, currency.acronimo);[m
[31m-    conclusoes.divisor_calculo_media = contagemPrimaria;[m
[31m-[m
[31m-    if (totalSecundaria > 0)[m
[31m-      conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundaria, currency.acronimo);;[m
[31m-    if (mediaSecundaria > 0) {[m
[31m-      conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaSecundaria, currency.acronimo); [m
[31m-      conclusoes.divisor_calculo_media_secundaria = contagemSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    conclusoes.media_contribuicoes = this.formatMoney(contribuicaoMedia, currency.acronimo);[m
[31m-    conclusoes.coeficiente = this.coeficiente;[m
[31m-    conclusoes.indice_reajuste_teto = indiceReajuste;[m
[31m-    conclusoes.salario_minimo = this.formatMoney(moedaComparacao.salario_minimo, currency.acronimo);[m
[31m-    conclusoes.teto = this.formatMoney(moedaComparacao.teto, currency.acronimo);[m
[31m-    conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currency.acronimo);[m
[31m-    conclusoes.renda_mensal_inicial_data_dib = this.formatMoney(rmiValoresAdministrativos, currency.acronimo);[m
[32m+[m[32m  //   let mediaPrimaria = totalPrimaria / contagemPrimaria;[m
[32m+[m[32m  //   let mediaSecundaria = 0;[m
[32m+[m[32m  //   if(totalSecundaria > 0) {[m
[32m+[m[32m  //     mediaSecundaria = totalSecundaria / contagemSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let contribuicaoMedia = mediaPrimaria + mediaSecundaria;[m
[32m+[m
[32m+[m[32m  //   let rmi = (this.limitarTetosEMinimos(contribuicaoMedia, dataComparacao)).valor;[m
[32m+[m
[32m+[m[32m  //   let indiceReajuste = contribuicaoMedia / rmi;[m
[32m+[m
[32m+[m[32m  //   // Coeficiente Calculado na função direitoAposentadoria[m
[32m+[m[32m  //   rmi = rmi * (this.coeficiente / 100);[m
[32m+[m
[32m+[m[32m  //   rmi = (this.limitarTetosEMinimos(rmi, dataComparacao)).valor;[m
[32m+[m
[32m+[m[32m  //   let rmiValoresAdministrativos = rmi;[m
[32m+[m
[32m+[m[32m  //   if(reajustesAdministrativos &&[m[41m [m
[32m+[m[32m  //     ((this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' && this.dataInicioBeneficio >= this.dataDib99) ||[m
[32m+[m[32m  //      (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' && this.dataInicioBeneficio >= this.dataDib98))){[m
[32m+[m[32m  //          rmiValoresAdministrativos = this.getValoresAdministrativos(rmiValoresAdministrativos);[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 17 || //AuxilioAcidente30[m
[32m+[m[32m  //       this.tipoBeneficio == 18 || //AuxilioAcidente40[m
[32m+[m[32m  //       this.tipoBeneficio == 7  || //AuxilioAcidente50[m
[32m+[m[32m  //       this.tipoBeneficio == 19){  //AuxilioAcidente60[m
[32m+[m[32m  //       let fatorAuxilio;[m
[32m+[m[32m  //       switch(this.tipoBeneficio){[m
[32m+[m[32m  //         case 17:[m
[32m+[m[32m  //           fatorAuxilio = 0.3;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //         case 18:[m
[32m+[m[32m  //           fatorAuxilio = 0.4;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //         case 7:[m
[32m+[m[32m  //           fatorAuxilio = 0.5;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //         case 19:[m
[32m+[m[32m  //           fatorAuxilio = 0.6;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       let moedaAuxilio = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[32m+[m[32m  //       let salMinimo = moedaAuxilio.salario_minimo;[m
[32m+[m
[32m+[m[32m  //       if(contribuicaoMedia > rmiValoresAdministrativos){[m
[32m+[m[32m  //         rmiValoresAdministrativos = contribuicaoMedia * fatorAuxilio;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         rmiValoresAdministrativos = salMinimo * fatorAuxilio;[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       if (contribuicaoMedia > rmi){[m
[32m+[m[32m  //         rmi = contribuicaoMedia * fatorAuxilio;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         rmi = rmi * fatorAuxilio;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let somaContribuicoes = totalPrimaria + totalSecundaria;[m
[32m+[m
[32m+[m[32m  //   if (reajustesAdministrativos) {[m
[32m+[m[32m  //      //TODO: salvarBeneficiosNoBD;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let currency = this.loadCurrency(dib);[m
[32m+[m
[32m+[m[32m  //   //Conclusões abaixo da tabela:[m
[32m+[m[32m  //   conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimaria, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaPrimaria, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.divisor_calculo_media = contagemPrimaria;[m
[32m+[m
[32m+[m[32m  //   if (totalSecundaria > 0)[m
[32m+[m[32m  //     conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundaria, currency.acronimo);;[m
[32m+[m[32m  //   if (mediaSecundaria > 0) {[m
[32m+[m[32m  //     conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaSecundaria, currency.acronimo);[m[41m [m
[32m+[m[32m  //     conclusoes.divisor_calculo_media_secundaria = contagemSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   conclusoes.media_contribuicoes = this.formatMoney(contribuicaoMedia, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.coeficiente = this.coeficiente;[m
[32m+[m[32m  //   conclusoes.indice_reajuste_teto = indiceReajuste;[m
[32m+[m[32m  //   conclusoes.salario_minimo = this.formatMoney(moedaComparacao.salario_minimo, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.teto = this.formatMoney(moedaComparacao.teto, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.renda_mensal_inicial_data_dib = this.formatMoney(rmiValoresAdministrativos, currency.acronimo);[m
     [m
[31m-    if(periodo == '91_98'){[m
[31m-      this.calculo91_98TableData = tableData;[m
[31m-      this.calculo91_98TableOptions = {[m
[31m-        ...this.calculo91_98TableOptions,[m
[31m-        data: this.calculo91_98TableData,[m
[31m-      }[m
[31m-    }else if(periodo == '98_99'){[m
[31m-      this.calculo98_99TableData = tableData;[m
[31m-      this.calculo98_99TableOptions = {[m
[31m-        ...this.calculo98_99TableOptions,[m
[31m-        data: this.calculo98_99TableData,[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-  }[m
[31m-[m
[31m-  direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[31m-    let idadeDoSegurado = this.idadeSegurado;[m
[31m-    //let tempoContribuicaoPrimaria = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[31m-    let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[31m-    let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
[31m-    //let anosSecundaria = (this.getContribuicaoObj(this.calculo.contribuicao_secundaria_98)).anos;[m
[31m-    let anosSecundaria = tempoContribuicaoSecundaria.anos;[m
[31m-    let anosPrimaria = ((tempoContribuicaoPrimaria.anos * 365) + (tempoContribuicaoPrimaria.meses * 30) + tempoContribuicaoPrimaria.dias)/365;[m
[31m-[m
[31m-    let anosContribuicao = anosPrimaria;[m
[31m-    this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, false, dib); [m
[31m-[m
[31m-    let totalContribuicao98 = 0;[m
[31m-    let tempoContribuicaoPrimaria98 = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[31m-    if(tempoContribuicaoPrimaria98 != {anos:0, meses:0, dias:0}) {[m
[31m-      totalContribuicao98 = ((tempoContribuicaoPrimaria98.anos * 365) + (tempoContribuicaoPrimaria98.meses * 30) + tempoContribuicaoPrimaria98.dias) /365;[m
[31m-    }[m
[31m-[m
[31m-    let direito = true;[m
[31m-    let idadeMinima = true;[m
[31m-    let extra;[m
[31m-    let toll;[m
[31m-[m
[31m-    let erroString = '';[m
[31m-    if(this.tipoBeneficio == 4 || this.tipoBeneficio == 6){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 0);[m
[31m-      if (!direito){[m
[31m-        if (dib <= this.dataDib98) {[m
[31m-          direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 5);[m
[31m-          this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, true, dib); [m
[31m-        }else{[m
[31m-          extra = this.calcularExtra(totalContribuicao98, redutorSexo);[m
[31m-          toll = this.calcularToll(totalContribuicao98, 0.4, 5, redutorSexo);[m
[31m-          this.coeficiente = this.calcularCoeficiente(anosContribuicao, toll, redutorProfessor, redutorSexo, true, dib); [m
[31m-          direito = this.verificarIdadeNecessaria(idadeDoSegurado, 7, 0, redutorSexo, errorArray);[m
[31m-          direito = direito && this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, extra + 5);[m
[31m-        }[m
[31m-        let contribuicao = 35 - redutorProfessor - redutorSexo - anosContribuicao;[m
[31m-        let tempoFracionado = this.tratarTempoFracionado(contribuicao); //Separar o tempo de contribuicao em anos, meses e dias[m
[31m-        if (direito) {[m
[31m-          // Exibir Mensagem de beneficio Proporcional, com o tempo faltante;[m
[31m-          //"POSSUI direito ao benefício proporcional."[m
[31m-          //"Falta(m) 'tempoFracionado' para possuir o direito ao benefício INTEGRAL."[m
[31m-          errorArray.push("POSSUI direito ao benefício proporcional. Falta(m) " + tempoFracionado + " para possuir o direito ao benefício INTEGRAL."); [m
[31m-        }else{[m
[31m-          // Exibir Mensagem de beneficio nao concedido.[m
[31m-          // Falta(m) 'tempoFracionado' para completar o tempo de serviço necessário para o benefício INTEGRAL.[m
[31m-          errorArray.push("Falta(m) "+ tempoFracionado + " para completar o tempo de serviço necessário para o benefício INTEGRAL.");[m
[31m-          if (totalContribuicao98 > 0) {[m
[31m-            let tempo = 35 - redutorProfessor - (extra + 5) - anosContribuicao;[m
[31m-            let tempoProporcional = this.tratarTempoFracionado(tempo);[m
[31m-            // Exibir Mensagem com o tempo faltante para o beneficio proporcioanl;[m
[31m-            // Falta(m) 'tempoProporcional' para completar o tempo de serviço necessário para o benefício PROPORCIONAL.[m
[31m-             errorArray.push("Falta(m) "+ tempoProporcional + " para completar o tempo de serviço necessário para o benefício PROPORCIONAL.");[m
[31m-          }[m
[31m-        }    [m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 3){[m
[31m-      idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[31m-      if (!idadeMinima){ [m
[31m-        return false;[m
[31m-      }[m
[31m-      if(!this.verificarCarencia(-5, redutorProfessor, redutorSexo, errorArray)){[m
[31m-        return false;[m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 5){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, 0, 20);[m
[31m-      if(!direito) {[m
[31m-        errorArray.push("Não possui direito ao benefício de aposentadoria especial.");[m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 16){[m
[31m-      idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[31m-      if (!idadeMinima){[m
[31m-        return false;[m
[31m-      }[m
[31m-      if (!this.verificarCarencia(0, redutorProfessor, redutorSexo, errorArray)){[m
[31m-        return false;[m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 25){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 10);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.    [m
[31m-      }[m
[31m-    }else if (this.tipoBeneficio == 26){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 6);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.    [m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 27){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 2);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.   [m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 28){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 20);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m
[31m-      }[m
[31m-      if (!this.verificarIdadeMinima(idadeDoSegurado, errorArray)){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a idade faltando;[m
[31m-      }[m
[31m-    }[m
[31m-    return direito;[m
[31m-  }[m
[32m+[m[32m  //   if(periodo == '91_98'){[m
[32m+[m[32m  //     this.calculo91_98TableData = tableData;[m
[32m+[m[32m  //     this.calculo91_98TableOptions = {[m
[32m+[m[32m  //       ...this.calculo91_98TableOptions,[m
[32m+[m[32m  //       data: this.calculo91_98TableData,[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(periodo == '98_99'){[m
[32m+[m[32m  //     this.calculo98_99TableData = tableData;[m
[32m+[m[32m  //     this.calculo98_99TableOptions = {[m
[32m+[m[32m  //       ...this.calculo98_99TableOptions,[m
[32m+[m[32m  //       data: this.calculo98_99TableData,[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[32m+[m[32m  //   let idadeDoSegurado = this.idadeSegurado;[m
[32m+[m[32m  //   //let tempoContribuicaoPrimaria = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[32m+[m[32m  //   let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[32m+[m[32m  //   let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
[32m+[m[32m  //   //let anosSecundaria = (this.getContribuicaoObj(this.calculo.contribuicao_secundaria_98)).anos;[m
[32m+[m[32m  //   let anosSecundaria = tempoContribuicaoSecundaria.anos;[m
[32m+[m[32m  //   let anosPrimaria = ((tempoContribuicaoPrimaria.anos * 365) + (tempoContribuicaoPrimaria.meses * 30) + tempoContribuicaoPrimaria.dias)/365;[m
[32m+[m
[32m+[m[32m  //   let anosContribuicao = anosPrimaria;[m
[32m+[m[32m  //   this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, false, dib);[m[41m [m
[32m+[m
[32m+[m[32m  //   let totalContribuicao98 = 0;[m
[32m+[m[32m  //   let tempoContribuicaoPrimaria98 = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[32m+[m[32m  //   if(tempoContribuicaoPrimaria98 != {anos:0, meses:0, dias:0}) {[m
[32m+[m[32m  //     totalContribuicao98 = ((tempoContribuicaoPrimaria98.anos * 365) + (tempoContribuicaoPrimaria98.meses * 30) + tempoContribuicaoPrimaria98.dias) /365;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let direito = true;[m
[32m+[m[32m  //   let idadeMinima = true;[m
[32m+[m[32m  //   let extra;[m
[32m+[m[32m  //   let toll;[m
[32m+[m
[32m+[m[32m  //   let erroString = '';[m
[32m+[m[32m  //   if(this.tipoBeneficio == 4 || this.tipoBeneficio == 6){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 0);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       if (dib <= this.dataDib98) {[m
[32m+[m[32m  //         direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 5);[m
[32m+[m[32m  //         this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, true, dib);[m[41m [m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         extra = this.calcularExtra(totalContribuicao98, redutorSexo);[m
[32m+[m[32m  //         toll = this.calcularToll(totalContribuicao98, 0.4, 5, redutorSexo);[m
[32m+[m[32m  //         this.coeficiente = this.calcularCoeficiente(anosContribuicao, toll, redutorProfessor, redutorSexo, true, dib);[m[41m [m
[32m+[m[32m  //         direito = this.verificarIdadeNecessaria(idadeDoSegurado, 7, 0, redutorSexo, errorArray);[m
[32m+[m[32m  //         direito = direito && this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, extra + 5);[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       let contribuicao = 35 - redutorProfessor - redutorSexo - anosContribuicao;[m
[32m+[m[32m  //       let tempoFracionado = this.tratarTempoFracionado(contribuicao); //Separar o tempo de contribuicao em anos, meses e dias[m
[32m+[m[32m  //       if (direito) {[m
[32m+[m[32m  //         // Exibir Mensagem de beneficio Proporcional, com o tempo faltante;[m
[32m+[m[32m  //         //"POSSUI direito ao benefício proporcional."[m
[32m+[m[32m  //         //"Falta(m) 'tempoFracionado' para possuir o direito ao benefício INTEGRAL."[m
[32m+[m[32m  //         errorArray.push("POSSUI direito ao benefício proporcional. Falta(m) " + tempoFracionado + " para possuir o direito ao benefício INTEGRAL.");[m[41m [m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         // Exibir Mensagem de beneficio nao concedido.[m
[32m+[m[32m  //         // Falta(m) 'tempoFracionado' para completar o tempo de serviço necessário para o benefício INTEGRAL.[m
[32m+[m[32m  //         errorArray.push("Falta(m) "+ tempoFracionado + " para completar o tempo de serviço necessário para o benefício INTEGRAL.");[m
[32m+[m[32m  //         if (totalContribuicao98 > 0) {[m
[32m+[m[32m  //           let tempo = 35 - redutorProfessor - (extra + 5) - anosContribuicao;[m
[32m+[m[32m  //           let tempoProporcional = this.tratarTempoFracionado(tempo);[m
[32m+[m[32m  //           // Exibir Mensagem com o tempo faltante para o beneficio proporcioanl;[m
[32m+[m[32m  //           // Falta(m) 'tempoProporcional' para completar o tempo de serviço necessário para o benefício PROPORCIONAL.[m
[32m+[m[32m  //            errorArray.push("Falta(m) "+ tempoProporcional + " para completar o tempo de serviço necessário para o benefício PROPORCIONAL.");[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m[41m    [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 3){[m
[32m+[m[32m  //     idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[32m+[m[32m  //     if (!idadeMinima){[m[41m [m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(!this.verificarCarencia(-5, redutorProfessor, redutorSexo, errorArray)){[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 5){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, 0, 20);[m
[32m+[m[32m  //     if(!direito) {[m
[32m+[m[32m  //       errorArray.push("Não possui direito ao benefício de aposentadoria especial.");[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 16){[m
[32m+[m[32m  //     idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[32m+[m[32m  //     if (!idadeMinima){[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (!this.verificarCarencia(0, redutorProfessor, redutorSexo, errorArray)){[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 25){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 10);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m[41m    [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if (this.tipoBeneficio == 26){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 6);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m[41m    [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 27){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 2);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m[41m   [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 28){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 20);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (!this.verificarIdadeMinima(idadeDoSegurado, errorArray)){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a idade faltando;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return direito;[m
[32m+[m[32m  // }[m
 [m
   calcularCoeficiente(anosContribuicao, toll, redutorProfessor, redutorSexo, proporcional, dib) {[m
     let coeficienteAux = 0;[m
[36m@@ -1104,27 +1021,27 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     return valorBeneficio;[m
   }[m
 [m
[31m-  verificarCarencia(redutorIdade, redutorProfessor, redutorSexo, errorArray) {[m
[31m-    if (this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[31m-      let mesesCarencia = 180;[m
[31m-      if (moment(this.segurado.data_filiacao, 'DD/MM/YYYY') < this.dataLei8213) { // Verificar se a data de filiação existe[m
[31m-        let anoNecessario = this.getAnoNecessario(redutorIdade, redutorProfessor, redutorSexo)[m
[31m-        let carenciaProgressiva = this.CarenciaProgressiva.getCarencia(anoNecessario);[m
[31m-        if (carenciaProgressiva != 0) {[m
[31m-            mesesCarencia = carenciaProgressiva;[m
[31m-        } else if (anoNecessario < 1991) {[m
[31m-            mesesCarencia = 60;[m
[31m-        }[m
[31m-      }[m
[31m-[m
[31m-      if (this.calculo.carencia < mesesCarencia) {[m
[31m-        let erroCarencia = "Falta(m) " + (mesesCarencia - this.calculo.carencia) + " mês(es) para a carência necessária.";[m
[31m-        errorArray.push(erroCarencia);[m
[31m-        return false;[m
[31m-      }[m
[31m-    }[m
[31m-    return true;[m
[31m-  }[m
[32m+[m[32m  // verificarCarencia(redutorIdade, redutorProfessor, redutorSexo, errorArray) {[m
[32m+[m[32m  //   if (this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[32m+[m[32m  //     let mesesCarencia = 180;[m
[32m+[m[32m  //     if (moment(this.segurado.data_filiacao, 'DD/MM/YYYY') < this.dataLei8213) { // Verificar se a data de filiação existe[m
[32m+[m[32m  //       let anoNecessario = this.getAnoNecessario(redutorIdade, redutorProfessor, redutorSexo)[m
[32m+[m[32m  //       let carenciaProgressiva = this.CarenciaProgressiva.getCarencia(anoNecessario);[m
[32m+[m[32m  //       if (carenciaProgressiva != 0) {[m
[32m+[m[32m  //           mesesCarencia = carenciaProgressiva;[m
[32m+[m[32m  //       } else if (anoNecessario < 1991) {[m
[32m+[m[32m  //           mesesCarencia = 60;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     if (this.calculo.carencia < mesesCarencia) {[m
[32m+[m[32m  //       let erroCarencia = "Falta(m) " + (mesesCarencia - this.calculo.carencia) + " mês(es) para a carência necessária.";[m
[32m+[m[32m  //       errorArray.push(erroCarencia);[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return true;[m
[32m+[m[32m  // }[m
 [m
   calcularExtra(tempoServico, redutorSexo) {[m
     let extra;[m
[36m@@ -1189,803 +1106,803 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
 [m
   //INICIO Cálculo após 99[m
 [m
[31m-  calculo_apos_99(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[31m-    let dib = this.dataInicioBeneficio;[m
[31m-    let dibCurrency = this.loadCurrency(dib);[m
[31m-    let moedaDib = this.Moeda.getByDate(dib);[m
[31m-    let dataComparacao = (dib.clone()).startOf('month');[m
[31m-    let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[31m-[m
[31m-    if(this.listaValoresContribuidos.length == 0) {[m
[31m-      // Exibir MSG de erro e encerrar Cálculo.[m
[31m-      errorArray.push("Nenhuma contribuição encontrada posterior a 07/1994 conforme " + "http://www.ieprev.com.br//legislacao/2754/lei-no-9.876,-de-26-11-1999' target='_blank'>Art. 02 da Lei nº 9.876, de 29/11/1999");[m
[31m-      return;[m
[31m-    }[m
[31m-[m
[31m-    if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[31m-      return;[m
[31m-    }[m
[31m-[m
[31m-    let totalContribuicaoPrimaria = 0;[m
[31m-    let totalContribuicaoSecundaria = 0;[m
[31m-    let totalContribuicaoPrimaria12 = 0;[m
[31m-    let totalContribuicaoSecundaria12 = 0;[m
[31m-[m
[31m-    let contadorSecundario = 0;[m
[31m-    let contadorPrimario = 0;[m
[31m-[m
[31m-    let primeirasContribuicoes = [];[m
[31m-    let tabelaIndex = 0;[m
[31m-    let tableData = [][m
[31m-    for(let contribuicao of this.listaValoresContribuidos) {[m
[31m-      let contribuicaoPrimaria = parseFloat(contribuicao.valor_primaria);[m
[31m-      let contribuicaoSecundaria = parseFloat(contribuicao.valor_secundaria);[m
[31m-      let dataContribuicao = moment(contribuicao.data);[m
[31m-      let currency = this.loadCurrency(dataContribuicao);[m
[31m-[m
[31m-      let idString = contadorPrimario + 1; //tabela['id'] = contadorPrimario;[m
[31m-      contadorPrimario++;[m
[31m-      let dataContribuicaoString = dataContribuicao.format('MM/YYYY');//tabela['dataContribuicao'] = contribuicao.dataContribuicao;[m
[31m-      let contribuicaoPrimariaString = this.formatMoney(contribuicaoPrimaria, currency.acronimo); //tabela['Contribuicao Primaria'] = currency.acronimo + contribuicaoPrimaria;[m
[31m-      let contribuicaoSecundariaString = this.formatMoney(contribuicaoSecundaria, currency.acronimo); //tabela['Contribuicao Secundaria'] = currency.acronimo + contribuicaoSecundaria;[m
[32m+[m[32m  // calculo_apos_99(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[32m+[m[32m  //   let dib = this.dataInicioBeneficio;[m
[32m+[m[32m  //   let dibCurrency = this.loadCurrency(dib);[m
[32m+[m[32m  //   let moedaDib = this.Moeda.getByDate(dib);[m
[32m+[m[32m  //   let dataComparacao = (dib.clone()).startOf('month');[m
[32m+[m[32m  //   let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[32m+[m
[32m+[m[32m  //   if(this.listaValoresContribuidos.length == 0) {[m
[32m+[m[32m  //     // Exibir MSG de erro e encerrar Cálculo.[m
[32m+[m[32m  //     errorArray.push("Nenhuma contribuição encontrada posterior a 07/1994 conforme " + "http://www.ieprev.com.br//legislacao/2754/lei-no-9.876,-de-26-11-1999' target='_blank'>Art. 02 da Lei nº 9.876, de 29/11/1999");[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let totalContribuicaoPrimaria = 0;[m
[32m+[m[32m  //   let totalContribuicaoSecundaria = 0;[m
[32m+[m[32m  //   let totalContribuicaoPrimaria12 = 0;[m
[32m+[m[32m  //   let totalContribuicaoSecundaria12 = 0;[m
[32m+[m
[32m+[m[32m  //   let contadorSecundario = 0;[m
[32m+[m[32m  //   let contadorPrimario = 0;[m
[32m+[m
[32m+[m[32m  //   let primeirasContribuicoes = [];[m
[32m+[m[32m  //   let tabelaIndex = 0;[m
[32m+[m[32m  //   let tableData = [][m
[32m+[m[32m  //   for(let contribuicao of this.listaValoresContribuidos) {[m
[32m+[m[32m  //     let contribuicaoPrimaria = parseFloat(contribuicao.valor_primaria);[m
[32m+[m[32m  //     let contribuicaoSecundaria = parseFloat(contribuicao.valor_secundaria);[m
[32m+[m[32m  //     let dataContribuicao = moment(contribuicao.data);[m
[32m+[m[32m  //     let currency = this.loadCurrency(dataContribuicao);[m
[32m+[m
[32m+[m[32m  //     let idString = contadorPrimario + 1; //tabela['id'] = contadorPrimario;[m
[32m+[m[32m  //     contadorPrimario++;[m
[32m+[m[32m  //     let dataContribuicaoString = dataContribuicao.format('MM/YYYY');//tabela['dataContribuicao'] = contribuicao.dataContribuicao;[m
[32m+[m[32m  //     let contribuicaoPrimariaString = this.formatMoney(contribuicaoPrimaria, currency.acronimo); //tabela['Contribuicao Primaria'] = currency.acronimo + contribuicaoPrimaria;[m
[32m+[m[32m  //     let contribuicaoSecundariaString = this.formatMoney(contribuicaoSecundaria, currency.acronimo); //tabela['Contribuicao Secundaria'] = currency.acronimo + contribuicaoSecundaria;[m
       [m
[31m-      let moeda = this.Moeda.getByDate(dataContribuicao);[m
[31m-      let fator = moeda.fator;[m
[31m-      let fatorLimite = moedaComparacao.fator;[m
[31m-      let fatorCorrigido = fator / fatorLimite;[m
[31m-      let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4); // tabela['fatorCorrigido'] = fator/fatorLimite;[m
[32m+[m[32m  //     let moeda = this.Moeda.getByDate(dataContribuicao);[m
[32m+[m[32m  //     let fator = moeda.fator;[m
[32m+[m[32m  //     let fatorLimite = moedaComparacao.fator;[m
[32m+[m[32m  //     let fatorCorrigido = fator / fatorLimite;[m
[32m+[m[32m  //     let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4); // tabela['fatorCorrigido'] = fator/fatorLimite;[m
        [m
[31m-      let contribuicaoPrimariaRevisada = 0;[m
[31m-      let contribuicaoSecundariaRevisada = 0;[m
[31m-[m
[31m-      let limiteString = '';[m
[31m-      if(contribuicaoPrimaria != 0){[m
[31m-        let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[31m-        contribuicaoPrimariaRevisada = valorAjustadoObj.valor;[m
[31m-        limiteString = valorAjustadoObj.aviso;[m
[31m-      }[m
[31m-      if (contribuicaoSecundaria != 0) {[m
[31m-        contribuicaoSecundariaRevisada = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor; //Inserir texto 'Limitado ao teto' e 'limitado ao minimo' quando cabivel.[m
[31m-        contadorSecundario++;[m
[31m-      }[m
[31m-[m
[31m-      contribuicaoPrimariaRevisada = contribuicaoPrimariaRevisada * fatorCorrigido;[m
[31m-      contribuicaoSecundariaRevisada = contribuicaoSecundariaRevisada * fatorCorrigido;[m
[31m-[m
[31m-      contribuicaoPrimariaRevisada   = this.convertCurrency(contribuicaoPrimariaRevisada  , dataContribuicao, dib);[m
[31m-      contribuicaoSecundariaRevisada   = this.convertCurrency(contribuicaoSecundariaRevisada  , dataContribuicao, dib);[m
[31m-[m
[31m-      totalContribuicaoPrimaria += contribuicaoPrimariaRevisada;[m
[31m-      totalContribuicaoSecundaria += contribuicaoSecundariaRevisada;[m
[31m-[m
[31m-[m
[31m-      let contribuicaoPrimariaRevisadaString = this.formatMoney(contribuicaoPrimariaRevisada, dibCurrency.acronimo);[m
[31m-      let contribuicaoSecundariaRevisadaString = this.formatMoney(contribuicaoSecundariaRevisada, dibCurrency.acronimo);[m
[31m-      //tabela['Contribuicao Primaria Corrigida'] = currency.Acronimo + contribuicaoPrimariaRevisada[m
[31m-      //tabela['Contribuicao Secundaria Corrigida'] = currency.Acronimo + contribuicaoSecundariaRevisada[m
[31m-[m
[31m-      let line = {id:idString,[m
[31m-                  competencia: dataContribuicaoString,[m
[31m-                  contribuicao_primaria: contribuicaoPrimariaString,[m
[31m-                  contribuicao_secundaria: contribuicaoSecundariaString,[m
[31m-                  indice_corrigido: fatorCorrigidoString,[m
[31m-                  contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[31m-                  contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[31m-                  limite: limiteString,[m
[31m-                  valor_primario:contribuicaoPrimariaRevisada,[m
[31m-                  valor_secundario:contribuicaoSecundariaRevisada};[m
[31m-      tableData.push(line);[m
[31m-      if(tabelaIndex < 12){[m
[31m-        primeirasContribuicoes.push(line);[m
[31m-      }[m
[31m-      tabelaIndex++;[m
[31m-    }[m
[31m-[m
[31m-    if (contadorSecundario < 24){[m
[31m-      contadorSecundario = 24;[m
[31m-    }[m
[31m-[m
[31m-    let mesesContribuicao = this.getDifferenceInMonths(moment('1994-07-01'), this.dataInicioBeneficio);[m
[31m-    let mesesContribuicao80 = Math.trunc((mesesContribuicao * 0.8) - 0.5);[m
[31m-    let mesesContribuicao60 = Math.trunc((mesesContribuicao * 0.6) - 0.5);[m
[31m-    let divisorMinimo = Math.trunc(mesesContribuicao * 0.6);[m
[31m-[m
[31m-    if (contadorSecundario < mesesContribuicao * 0.6) {[m
[31m-      contadorSecundario = Math.trunc(mesesContribuicao * 0.6);[m
[31m-    }else if(contadorSecundario < mesesContribuicao * 0.6){[m
[31m-      contadorSecundario = Math.trunc(mesesContribuicao * 0.8);[m
[31m-    }[m
[31m-[m
[31m-    let numeroContribuicoes = tableData.length;//Numero de contribuicoes carregadas para o periodo;[m
[31m-    let divisorMediaPrimaria = numeroContribuicoes;[m
[31m-    let divisorSecundario = contadorSecundario;[m
[31m-    if(divisorSecundario < mesesContribuicao * 0.6){[m
[31m-      divisorSecundario = Math.round(mesesContribuicao * 0.6);[m
[31m-    }else if(divisorSecundario < mesesContribuicao * 0.8){[m
[31m-      divisorSecundario = Math.round(mesesContribuicao * 0.8);[m
[31m-    }[m
[31m-    let label;[m
[31m-    switch(this.tipoBeneficio) {[m
[31m-      case 1: // Auxilio Doença Previdenciario[m
[31m-        divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.6)-0.5);[m
[31m-        divisorSecundario = Math.trunc((contadorSecundario * 0.8) - 0.5);[m
[31m-        if (this.withMemo) {[m
[31m-          // Exibir Label contendo o texto[m
[31m-          label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários .";[m
[31m-        }[m
[31m-        break;[m
[31m-      case 2: // Aposentadoria Por Invalidez previdenciaria[m
[31m-        if (divisorMediaPrimaria >= divisorMinimo || this.withMemo) {[m
[31m-          divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          if (this.withMemo) {[m
[31m-            // Exibir Label contendo o texto[m
[31m-            label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários.";[m
[31m-          }[m
[31m-        }[m
[31m-        break;[m
[31m-      case 7: // Auxilio Doença Previdenciario 50%[m
[31m-        divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-        break;[m
[31m-    }[m
[31m-[m
[31m-    if (this.dataFiliacao >= this.dataDib99){[m
[31m-      switch(this.tipoBeneficio){[m
[31m-        case 1: //Auxilio Doença Previdenciario[m
[31m-        case 2: //Aposentadoria por invalidez previdenciaria[m
[31m-          if (numeroContribuicoes >= 144 || this.withMemo) {[m
[31m-            divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          }else{[m
[31m-            divisorMediaPrimaria = numeroContribuicoes;[m
[31m-          }[m
[31m-          break;[m
[31m-        case 5: // Aposentadoria Especial[m
[31m-        case 7: // Auxilio Acidente Previdenciario 50%[m
[31m-          if (numeroContribuicoes < 144 || this.withMemo) {[m
[31m-            divisorMediaPrimaria = numeroContribuicoes;[m
[31m-          }else{                [m
[31m-            divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          }[m
[31m-          break;[m
[31m-        case 3 ://Aposentadoria Idade Trabalhador Urbano[m
[31m-        case 4 ://Aposentadoria Tempo de Contribuicao[m
[31m-        case 16://Aposentadoria Idade Trabalhafor Rural[m
[31m-        case 25://Deficiencia Grave[m
[31m-        case 27://Deficiencia Leva[m
[31m-        case 26://Deficiencia Moderado[m
[31m-        case 28://Deficiencia PorSalvar Idade[m
[31m-          divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          break;[m
[31m-      }[m
[31m-    }else if(this.dataFiliacao < this.dataDib99){[m
[31m-      if(this.tipoBeneficio == 3 || this.tipoBeneficio == 4 || this.tipoBeneficio == 5 || this.tipoBeneficio == 6 ||    [m
[31m-      this.tipoBeneficio == 16 || this.tipoBeneficio == 25 || this.tipoBeneficio == 27 || this.tipoBeneficio == 26 ||              [m
[31m-      this.tipoBeneficio == 28){[m
[31m-           // Deficiencia Por Idade, Deficiencia Grave, Deficiencia Leve, Deficiencia Moderada, Aposentadoria Idade trabalhador Rural,[m
[31m-           // Aposentadoria Idade Urbano, Aposentadoria Tempo Contribuicao, Aposentadoria Especial, Aposentadoria Tempo Servico Professor[m
[31m-        divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-        if (numeroContribuicoes < mesesContribuicao60) {[m
[31m-          divisorMediaPrimaria = mesesContribuicao60[m
[31m-        }[m
[31m-        if (numeroContribuicoes >= mesesContribuicao60 && numeroContribuicoes <= mesesContribuicao80) {[m
[31m-          if (this.withIN45) {[m
[31m-            divisorMediaPrimaria = numeroContribuicoes;[m
[31m-          }else{[m
[31m-            divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          }[m
[31m-        }[m
[31m-        if(divisorMediaPrimaria < divisorMinimo){[m
[31m-          divisorMediaPrimaria = divisorMinimo;[m
[31m-        }[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    let totalMediaDozeContribuicoes = 0;[m
[31m-    switch(this.tipoBeneficio){[m
[31m-      case 1: // Auxilio Doenca Previdenciario[m
[31m-        if (this.dataInicioBeneficio >= this.dataMP664) {[m
[31m-          let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-          if (numeroContribuicoes >= 12) {[m
[31m-            let contribuicoesPrimarias12 = 0;[m
[31m-            let contribuicoesSecundarias12 = 0;[m
[31m-            for (let contribuicao of primeirasContribuicoes) {[m
[31m-              contribuicoesPrimarias12 += contribuicao.valor_primario;[m
[31m-              contribuicoesSecundarias12 += contribuicao.valor_secundario;[m
[31m-            }[m
[31m-            let moeda = this.Moeda.getByDate(this.dataInicioBeneficio);// Carregar 1 linha da tabela moeda onde a data é menor ou igual que data_pedido_beneficio;[m
[31m-            let salarioMinimoRMI = moeda.salario_minimo;[m
[31m-            let divisorContribuicoes = this.formatDecimal((contribuicoesPrimarias12 + contribuicoesSecundarias12) /12 , 1);[m
[31m-            if (divisorContribuicoes < salarioMinimoRMI) {[m
[31m-              divisorContribuicoes = salarioMinimoRMI;[m
[31m-            }[m
[31m-            totalMediaDozeContribuicoes = divisorContribuicoes;[m
[31m-            // Inserir nas conclusoes:[m
[31m-            //conclusoes.soma_doze_ultimas_contribuicoes = this.formatMoney(contribuicoesPrimarias12, currency.acronimo);[m
[31m-            conclusoes.push({string:"Soma das 12 últimas contribuções", value:this.formatMoney(contribuicoesPrimarias12, currency.acronimo)});  [m
[31m-            //conclusoes.media_doze_ultimas_contribuicoes = this.formatMoney(divisorContribuicoes, currency.acronimo);[m
[31m-            conclusoes.push({string:"Média das 12 últimas contribuções", value:this.formatMoney(divisorContribuicoes, currency.acronimo)}); [m
[31m-          }[m
[31m-        }[m
[31m-        break;[m
[31m-      case 2: //Aposentadoria por invalidez previdenciaria[m
[31m-        if (this.dataInicioBeneficio >= this.dataDecreto6939_2009 && divisorMediaPrimaria > 1) {[m
[31m-          divisorMediaPrimaria = this.formatDecimal((numeroContribuicoes * 0.8)-0.5, 1);[m
[31m-        }[m
[31m-        break;[m
[31m-    }[m
[31m-[m
[31m-[m
[31m-    tableData.sort((entry1, entry2) => {[m
[31m-      if(entry1.valor_primario > entry2.valor_primario){[m
[31m-        return 1;[m
[31m-      }[m
[31m-      if(entry1.valor_primario < entry2.valor_primario){[m
[31m-        return -1;[m
[31m-      }[m
[31m-      return 0;[m
[31m-    });[m
[31m-    if (numeroContribuicoes > divisorMediaPrimaria){[m
[31m-      totalContribuicaoPrimaria = 0[m
[31m-      for(let i=0; i < tableData.length; i++){[m
[31m-        if (i >= tableData.length-divisorMediaPrimaria) {[m
[31m-          totalContribuicaoPrimaria += tableData[i].valor_primario;[m
[31m-        }else{[m
[31m-          tableData[i].limite = "DESCONSIDERADO";[m
[31m-        }[m
[31m-      }[m
[31m-    }[m
[31m-    tableData.sort((entry1, entry2) => {[m
[31m-      if(entry1.id > entry2.id){[m
[31m-        return 1;[m
[31m-      }[m
[31m-      if(entry1.id < entry2.id){[m
[31m-        return -1;[m
[31m-      }[m
[31m-      return 0;[m
[31m-    });[m
[31m-    let numeroCompetencias = this.getDifferenceInMonths(this.dataDib99, this.dataInicioBeneficio); // Calcular a quantidade de meses contida entre as duas datas.[m
[31m-[m
[31m-    if (numeroCompetencias > 60) {[m
[31m-        numeroCompetencias = 60;[m
[31m-    }[m
[31m-[m
[31m-    let expectativa = this.projetarExpectativa(this.idadeFracionada, this.dataInicioBeneficio,conclusoes);[m
[31m-[m
[31m-    let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[31m-    let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
[32m+[m[32m  //     let contribuicaoPrimariaRevisada = 0;[m
[32m+[m[32m  //     let contribuicaoSecundariaRevisada = 0;[m
[32m+[m
[32m+[m[32m  //     let limiteString = '';[m
[32m+[m[32m  //     if(contribuicaoPrimaria != 0){[m
[32m+[m[32m  //       let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[32m+[m[32m  //       contribuicaoPrimariaRevisada = valorAjustadoObj.valor;[m
[32m+[m[32m  //       limiteString = valorAjustadoObj.aviso;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (contribuicaoSecundaria != 0) {[m
[32m+[m[32m  //       contribuicaoSecundariaRevisada = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor; //Inserir texto 'Limitado ao teto' e 'limitado ao minimo' quando cabivel.[m
[32m+[m[32m  //       contadorSecundario++;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     contribuicaoPrimariaRevisada = contribuicaoPrimariaRevisada * fatorCorrigido;[m
[32m+[m[32m  //     contribuicaoSecundariaRevisada = contribuicaoSecundariaRevisada * fatorCorrigido;[m
[32m+[m
[32m+[m[32m  //     contribuicaoPrimariaRevisada   = this.convertCurrency(contribuicaoPrimariaRevisada  , dataContribuicao, dib);[m
[32m+[m[32m  //     contribuicaoSecundariaRevisada   = this.convertCurrency(contribuicaoSecundariaRevisada  , dataContribuicao, dib);[m
[32m+[m
[32m+[m[32m  //     totalContribuicaoPrimaria += contribuicaoPrimariaRevisada;[m
[32m+[m[32m  //     totalContribuicaoSecundaria += contribuicaoSecundariaRevisada;[m
[32m+[m
[32m+[m
[32m+[m[32m  //     let contribuicaoPrimariaRevisadaString = this.formatMoney(contribuicaoPrimariaRevisada, dibCurrency.acronimo);[m
[32m+[m[32m  //     let contribuicaoSecundariaRevisadaString = this.formatMoney(contribuicaoSecundariaRevisada, dibCurrency.acronimo);[m
[32m+[m[32m  //     //tabela['Contribuicao Primaria Corrigida'] = currency.Acronimo + contribuicaoPrimariaRevisada[m
[32m+[m[32m  //     //tabela['Contribuicao Secundaria Corrigida'] = currency.Acronimo + contribuicaoSecundariaRevisada[m
[32m+[m
[32m+[m[32m  //     let line = {id:idString,[m
[32m+[m[32m  //                 competencia: dataContribuicaoString,[m
[32m+[m[32m  //                 contribuicao_primaria: contribuicaoPrimariaString,[m
[32m+[m[32m  //                 contribuicao_secundaria: contribuicaoSecundariaString,[m
[32m+[m[32m  //                 indice_corrigido: fatorCorrigidoString,[m
[32m+[m[32m  //                 contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[32m+[m[32m  //                 contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[32m+[m[32m  //                 limite: limiteString,[m
[32m+[m[32m  //                 valor_primario:contribuicaoPrimariaRevisada,[m
[32m+[m[32m  //                 valor_secundario:contribuicaoSecundariaRevisada};[m
[32m+[m[32m  //     tableData.push(line);[m
[32m+[m[32m  //     if(tabelaIndex < 12){[m
[32m+[m[32m  //       primeirasContribuicoes.push(line);[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     tabelaIndex++;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (contadorSecundario < 24){[m
[32m+[m[32m  //     contadorSecundario = 24;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let mesesContribuicao = this.getDifferenceInMonths(moment('1994-07-01'), this.dataInicioBeneficio);[m
[32m+[m[32m  //   let mesesContribuicao80 = Math.trunc((mesesContribuicao * 0.8) - 0.5);[m
[32m+[m[32m  //   let mesesContribuicao60 = Math.trunc((mesesContribuicao * 0.6) - 0.5);[m
[32m+[m[32m  //   let divisorMinimo = Math.trunc(mesesContribuicao * 0.6);[m
[32m+[m
[32m+[m[32m  //   if (contadorSecundario < mesesContribuicao * 0.6) {[m
[32m+[m[32m  //     contadorSecundario = Math.trunc(mesesContribuicao * 0.6);[m
[32m+[m[32m  //   }else if(contadorSecundario < mesesContribuicao * 0.6){[m
[32m+[m[32m  //     contadorSecundario = Math.trunc(mesesContribuicao * 0.8);[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let numeroContribuicoes = tableData.length;//Numero de contribuicoes carregadas para o periodo;[m
[32m+[m[32m  //   let divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //   let divisorSecundario = contadorSecundario;[m
[32m+[m[32m  //   if(divisorSecundario < mesesContribuicao * 0.6){[m
[32m+[m[32m  //     divisorSecundario = Math.round(mesesContribuicao * 0.6);[m
[32m+[m[32m  //   }else if(divisorSecundario < mesesContribuicao * 0.8){[m
[32m+[m[32m  //     divisorSecundario = Math.round(mesesContribuicao * 0.8);[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   let label;[m
[32m+[m[32m  //   switch(this.tipoBeneficio) {[m
[32m+[m[32m  //     case 1: // Auxilio Doença Previdenciario[m
[32m+[m[32m  //       divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.6)-0.5);[m
[32m+[m[32m  //       divisorSecundario = Math.trunc((contadorSecundario * 0.8) - 0.5);[m
[32m+[m[32m  //       if (this.withMemo) {[m
[32m+[m[32m  //         // Exibir Label contendo o texto[m
[32m+[m[32m  //         label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários .";[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 2: // Aposentadoria Por Invalidez previdenciaria[m
[32m+[m[32m  //       if (divisorMediaPrimaria >= divisorMinimo || this.withMemo) {[m
[32m+[m[32m  //         divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         if (this.withMemo) {[m
[32m+[m[32m  //           // Exibir Label contendo o texto[m
[32m+[m[32m  //           label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários.";[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 7: // Auxilio Doença Previdenciario 50%[m
[32m+[m[32m  //       divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (this.dataFiliacao >= this.dataDib99){[m
[32m+[m[32m  //     switch(this.tipoBeneficio){[m
[32m+[m[32m  //       case 1: //Auxilio Doença Previdenciario[m
[32m+[m[32m  //       case 2: //Aposentadoria por invalidez previdenciaria[m
[32m+[m[32m  //         if (numeroContribuicoes >= 144 || this.withMemo) {[m
[32m+[m[32m  //           divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         }else{[m
[32m+[m[32m  //           divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 5: // Aposentadoria Especial[m
[32m+[m[32m  //       case 7: // Auxilio Acidente Previdenciario 50%[m
[32m+[m[32m  //         if (numeroContribuicoes < 144 || this.withMemo) {[m
[32m+[m[32m  //           divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //         }else{[m[41m                [m
[32m+[m[32m  //           divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 3 ://Aposentadoria Idade Trabalhador Urbano[m
[32m+[m[32m  //       case 4 ://Aposentadoria Tempo de Contribuicao[m
[32m+[m[32m  //       case 16://Aposentadoria Idade Trabalhafor Rural[m
[32m+[m[32m  //       case 25://Deficiencia Grave[m
[32m+[m[32m  //       case 27://Deficiencia Leva[m
[32m+[m[32m  //       case 26://Deficiencia Moderado[m
[32m+[m[32m  //       case 28://Deficiencia PorSalvar Idade[m
[32m+[m[32m  //         divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.dataFiliacao < this.dataDib99){[m
[32m+[m[32m  //     if(this.tipoBeneficio == 3 || this.tipoBeneficio == 4 || this.tipoBeneficio == 5 || this.tipoBeneficio == 6 ||[m[41m    [m
[32m+[m[32m  //     this.tipoBeneficio == 16 || this.tipoBeneficio == 25 || this.tipoBeneficio == 27 || this.tipoBeneficio == 26 ||[m[41m              [m
[32m+[m[32m  //     this.tipoBeneficio == 28){[m
[32m+[m[32m  //          // Deficiencia Por Idade, Deficiencia Grave, Deficiencia Leve, Deficiencia Moderada, Aposentadoria Idade trabalhador Rural,[m
[32m+[m[32m  //          // Aposentadoria Idade Urbano, Aposentadoria Tempo Contribuicao, Aposentadoria Especial, Aposentadoria Tempo Servico Professor[m
[32m+[m[32m  //       divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //       if (numeroContribuicoes < mesesContribuicao60) {[m
[32m+[m[32m  //         divisorMediaPrimaria = mesesContribuicao60[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       if (numeroContribuicoes >= mesesContribuicao60 && numeroContribuicoes <= mesesContribuicao80) {[m
[32m+[m[32m  //         if (this.withIN45) {[m
[32m+[m[32m  //           divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //         }else{[m
[32m+[m[32m  //           divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       if(divisorMediaPrimaria < divisorMinimo){[m
[32m+[m[32m  //         divisorMediaPrimaria = divisorMinimo;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let totalMediaDozeContribuicoes = 0;[m
[32m+[m[32m  //   switch(this.tipoBeneficio){[m
[32m+[m[32m  //     case 1: // Auxilio Doenca Previdenciario[m
[32m+[m[32m  //       if (this.dataInicioBeneficio >= this.dataMP664) {[m
[32m+[m[32m  //         let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m  //         if (numeroContribuicoes >= 12) {[m
[32m+[m[32m  //           let contribuicoesPrimarias12 = 0;[m
[32m+[m[32m  //           let contribuicoesSecundarias12 = 0;[m
[32m+[m[32m  //           for (let contribuicao of primeirasContribuicoes) {[m
[32m+[m[32m  //             contribuicoesPrimarias12 += contribuicao.valor_primario;[m
[32m+[m[32m  //             contribuicoesSecundarias12 += contribuicao.valor_secundario;[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //           let moeda = this.Moeda.getByDate(this.dataInicioBeneficio);// Carregar 1 linha da tabela moeda onde a data é menor ou igual que data_pedido_beneficio;[m
[32m+[m[32m  //           let salarioMinimoRMI = moeda.salario_minimo;[m
[32m+[m[32m  //           let divisorContribuicoes = this.formatDecimal((contribuicoesPrimarias12 + contribuicoesSecundarias12) /12 , 1);[m
[32m+[m[32m  //           if (divisorContribuicoes < salarioMinimoRMI) {[m
[32m+[m[32m  //             divisorContribuicoes = salarioMinimoRMI;[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //           totalMediaDozeContribuicoes = divisorContribuicoes;[m
[32m+[m[32m  //           // Inserir nas conclusoes:[m
[32m+[m[32m  //           //conclusoes.soma_doze_ultimas_contribuicoes = this.formatMoney(contribuicoesPrimarias12, currency.acronimo);[m
[32m+[m[32m  //           conclusoes.push({string:"Soma das 12 últimas contribuções", value:this.formatMoney(contribuicoesPrimarias12, currency.acronimo)});[m[41m  [m
[32m+[m[32m  //           //conclusoes.media_doze_ultimas_contribuicoes = this.formatMoney(divisorContribuicoes, currency.acronimo);[m
[32m+[m[32m  //           conclusoes.push({string:"Média das 12 últimas contribuções", value:this.formatMoney(divisorContribuicoes, currency.acronimo)});[m[41m [m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 2: //Aposentadoria por invalidez previdenciaria[m
[32m+[m[32m  //       if (this.dataInicioBeneficio >= this.dataDecreto6939_2009 && divisorMediaPrimaria > 1) {[m
[32m+[m[32m  //         divisorMediaPrimaria = this.formatDecimal((numeroContribuicoes * 0.8)-0.5, 1);[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m
[32m+[m[32m  //   tableData.sort((entry1, entry2) => {[m
[32m+[m[32m  //     if(entry1.valor_primario > entry2.valor_primario){[m
[32m+[m[32m  //       return 1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(entry1.valor_primario < entry2.valor_primario){[m
[32m+[m[32m  //       return -1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     return 0;[m
[32m+[m[32m  //   });[m
[32m+[m[32m  //   if (numeroContribuicoes > divisorMediaPrimaria){[m
[32m+[m[32m  //     totalContribuicaoPrimaria = 0[m
[32m+[m[32m  //     for(let i=0; i < tableData.length; i++){[m
[32m+[m[32m  //       if (i >= tableData.length-divisorMediaPrimaria) {[m
[32m+[m[32m  //         totalContribuicaoPrimaria += tableData[i].valor_primario;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         tableData[i].limite = "DESCONSIDERADO";[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   tableData.sort((entry1, entry2) => {[m
[32m+[m[32m  //     if(entry1.id > entry2.id){[m
[32m+[m[32m  //       return 1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(entry1.id < entry2.id){[m
[32m+[m[32m  //       return -1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     return 0;[m
[32m+[m[32m  //   });[m
[32m+[m[32m  //   let numeroCompetencias = this.getDifferenceInMonths(this.dataDib99, this.dataInicioBeneficio); // Calcular a quantidade de meses contida entre as duas datas.[m
[32m+[m
[32m+[m[32m  //   if (numeroCompetencias > 60) {[m
[32m+[m[32m  //       numeroCompetencias = 60;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let expectativa = this.projetarExpectativa(this.idadeFracionada, this.dataInicioBeneficio,conclusoes);[m
[32m+[m
[32m+[m[32m  //   let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[32m+[m[32m  //   let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
  [m
[31m-    let tempoTotalContribuicao = this.getTempoServico(redutorProfessor, redutorSexo, false);[m
[31m-[m
[31m-    let fatorSeguranca = 1;[m
[31m-    let aliquota = 0.31;[m
[31m-    let naoFocado = false;[m
[31m-[m
[31m-    switch(this.tipoBeneficio) {[m
[31m-      case 1: // Auxilio Doenca Previdenciario[m
[31m-      case 2:         // Aposentadoria Invalidez Previdenciaria;[m
[31m-      case 5:         // Aposentadoria Especial[m
[31m-      case 7:         // Auxiolio Acidente 50[m
[31m-        naoFocado = true;[m
[31m-        break;[m
[31m-      default:[m
[31m-        fatorSeguranca = ((tempoTotalContribuicao * aliquota) / expectativa) * (1 + this.idadeFracionada + (tempoTotalContribuicao * aliquota) / 100);[m
[31m-        // Adicionar nas conclusões a fórmula com os valores, não os resutlados:[m
[31m-       //conclusoes.formula_fator = "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)";[m
[31m-        conclusoes.push({string:"Fórmula Fator:",value: "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+this.idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)"});[m
[31m-        break;[m
[31m-    }[m
[31m-[m
[31m-    if (this.tipoBeneficio == 16|| // Aposentadoria Travalhador Rural[m
[31m-        this.tipoBeneficio ==  3|| // Aposentadoria Trabalhador Urbano[m
[31m-        this.tipoBeneficio == 25|| // Deficiencia Grave[m
[31m-        this.tipoBeneficio == 26|| // Deficiencia Leve[m
[31m-        this.tipoBeneficio == 27|| // Deficiencia Moderada[m
[31m-        this.tipoBeneficio == 28){  // Deficiencia Por Idade[m
[31m-        if (fatorSeguranca < 1) {[m
[31m-          fatorSeguranca = 1;[m
[31m-          naoFocado = true;[m
[31m-        }else if(fatorSeguranca > 1) {[m
[31m-          naoFocado = true;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    //Índice de Reajuste no Teto.[m
[31m-    let irt = 1;[m
[31m-[m
[31m-    let mediaContribuicoesPrimarias = totalContribuicaoPrimaria;[m
[31m-    if (divisorMediaPrimaria > 1) {[m
[31m-        mediaContribuicoesPrimarias /= divisorMediaPrimaria;[m
[31m-    }[m
[31m-[m
[31m-    let mediaContribuicoesSecundarias = totalContribuicaoSecundaria;[m
[31m-    if (divisorSecundario > 1) {[m
[31m-        mediaContribuicoesSecundarias /= divisorSecundario;    [m
[31m-    }[m
[31m-[m
[31m-    if (mediaContribuicoesSecundarias > moedaDib.teto) {[m
[31m-        mediaContribuicoesSecundarias = moedaDib.teto;[m
[31m-    }[m
[31m-[m
[31m-    this.limited = false;[m
[31m-[m
[31m-    let rmi = fatorSeguranca * numeroCompetencias * mediaContribuicoesPrimarias / 60;[m
[31m-[m
[31m-    rmi += mediaContribuicoesPrimarias * ((60 - numeroCompetencias) / 60);[m
[31m-[m
[31m-    let taxaSecundaria = 0;[m
[31m-    let taxaMediaSecundaria = 0;[m
[31m-[m
[31m-    if (mediaContribuicoesSecundarias != 0) {[m
[31m-      taxaSecundaria = this.getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario);[m
[31m-      taxaMediaSecundaria = mediaContribuicoesSecundarias * taxaSecundaria;[m
[31m-      if (taxaMediaSecundaria > mediaContribuicoesSecundarias) {[m
[31m-        taxaMediaSecundaria = mediaContribuicoesSecundarias;[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    let coeficiente = this.coeficiente;[m
[31m-[m
[31m-    let somaMedias = mediaContribuicoesPrimarias + taxaMediaSecundaria;[m
[31m-    let somaMediasAux = this.corrigirBeneficio(somaMedias, coeficiente, moedaDib);[m
[31m-[m
[31m-    if (this.limited){[m
[31m-      irt = (somaMedias * (coeficiente / 100))/somaMediasAux;[m
[31m-    }[m
[31m-[m
[31m-    rmi += (fatorSeguranca * numeroCompetencias) / 60;[m
[31m-    rmi += taxaMediaSecundaria * ((60 - numeroCompetencias) / 60)[m
[31m-    rmi *= (coeficiente / 100);[m
[31m-[m
[31m-    this.limited = false;[m
[31m-[m
[31m-    let rmiAux = this.corrigirBeneficio(rmi, coeficiente, moedaDib);[m
[31m-    rmi = rmiAux;[m
[31m-[m
[31m-    //let objMoeda = this.moeda[this.getIndex(this.dataInicioBeneficio)];//carregar apenas uma TMoeda onde currency Date é menor ou igual a Calculo.data_pedido_beneficio[m
[31m-    let objMoeda = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[31m-    let salarioAcidente = objMoeda.salario_minimo;[m
[31m-    if (mediaContribuicoesPrimarias > salarioAcidente) {[m
[31m-      switch(this.tipoBeneficio){[m
[31m-        case 17:// Auxilio Acidente 30[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.3;[m
[31m-          break;[m
[31m-        case 18: // Auxilio Acidente 40[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.4;[m
[31m-          break;[m
[31m-        case 7: // Auxilio Acidente 50[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.5;[m
[31m-          break;[m
[31m-        case 19: // Auxilio Acidente 60[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.6;[m
[31m-          break;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    let somaContribuicoes = totalContribuicaoPrimaria + totalContribuicaoSecundaria;[m
[31m-[m
[31m-    let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-[m
[31m-    //conclusoes.coeficiente_calculo = coeficiente;//resultados['Coeficiente do Cálculo'] = coeficiente //Arrendodar para duas casas decimais;[m
[31m-    //conclusoes.soma_contribuicoes_primarias = this.formatMoney(totalContribuicoesPrimarias, currency.acronimo);//resultados['Soma das Contribuições Primarias'] = currency.acrônimo + totalContribuicoesPrimarias;[m
[31m-    //conclusoes.divisor_calculo_media_primaria = divisorMediaPrimaria;//resultados['Divisor do Cálculo da média primária: '] = divisorMediaPrimaria;[m
[31m-    //conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo);//resultados['Média das contribuições primárias'] = currency.acrônimo + mediaContribuicoesPrimarias;[m
[31m-    conclusoes.push({string:"Coeficiente do Cálculo:",value:coeficiente+'%'});[m
[31m-    conclusoes.push({string:"Soma das Contribuições Primarias:",value:this.formatMoney(totalContribuicaoPrimaria, currency.acronimo)});[m
[31m-    conclusoes.push({string:"Divisor do Cálculo da média primária:",value:divisorMediaPrimaria});[m
[31m-    conclusoes.push({string:"Média das contribuições primárias",value:this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo)});[m
[31m-[m
[31m-    if (totalContribuicaoSecundaria > 0) {[m
[31m-      conclusoes.push({string:"Soma das contribuições secundárias:",value:this.formatMoney(totalContribuicaoSecundaria, currency.acronimo)});//resultados['Soma das contribuições secundárias'] = currency.acrônumo + totalContribuicoesSecundarias;[m
[31m-      conclusoes.push({string:"Divisor do Cálculo da média secundária:",value:divisorSecundario});//resultados['Divisor do Cálculo da média secundária: '] = divisorMediaPrimaria;[m
[31m-      conclusoes.push({string:"Média das contribuições Secundárias:",value:this.formatMoney(mediaContribuicoesSecundarias, currency.acronimo)});//resultados['Média das contribuições Secundárias: '] =  currency.acrônumo + mediaContribuicoesSecundarias;[m
[31m-      conclusoes.push({string:"Taxa:",value:taxaSecundaria});//resultados['Taxa: '] =  taxaSecundaria;[m
[31m-      conclusoes.push({string:"Média Secundárias - Pós Taxa:",value:this.formatMoney(taxaSecundaria, currency.acronimo)});//resultados['Média Secundárias - Pós Taxa: '] =  currency.acrônimo + taxaSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    conclusoes.push({string:"Idade em anos:",value:Math.trunc(this.idadeFracionada)});//resultados['Idade em anos'] = truncate(idadeFracionada) (idadeFracionada);[m
[31m-    conclusoes.push({string:"Média das contribuições:",value:this.formatMoney(somaMedias, currency.acronimo)});//resultados['Média das contribuições'] = currency.acrônimo + somaMedias;[m
[31m-    conclusoes.push({string:"CT - Número de competências transcorridas desde 29/11/1999:",value:numeroCompetencias});//resultados['CT - Número de competências transcorridas desde 29/11/1999:'] = numeroCompetencias;[m
[31m-[m
[31m-    if (this.tipoBeneficio == 6 && redutorSexo == 5){[m
[31m-      this.contribuicaoTotal -= this.contribuicaoTotal - 5;[m
[31m-    }[m
[31m-[m
[31m-    let contribuicao85_95 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao86_96 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao87_97 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao88_98 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao89_99 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao90_100 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-[m
[31m-    let dateFormat = "DD/MM/YYYY";[m
[31m-    let dataRegra85_95 = moment('17/06/2016', dateFormat);[m
[31m-    let dataRegra86_96 = moment('31/12/2018', dateFormat);[m
[31m-    let dataRegra87_97 = moment('31/12/2020', dateFormat);[m
[31m-    let dataRegra88_98 = moment('31/12/2022', dateFormat);[m
[31m-    let dataRegra89_99 = moment('31/12/2024', dateFormat);[m
[31m-    let dataRegra90_100 = moment('31/12/2026', dateFormat);[m
[31m-[m
[31m-    let dataFimRegra85_95 = moment('30/12/2018', dateFormat);[m
[31m-    let dataFimRegra86_96 = moment('30/12/2020', dateFormat);[m
[31m-    let dataFimRegra87_97 = moment('30/12/2022', dateFormat);[m
[31m-    let dataFimRegra88_98 = moment('30/12/2024', dateFormat);[m
[31m-    let dataFimRegra89_99 = moment('30/12/2026', dateFormat);[m
[31m-    let dataFimRegra90_100 = moment('30/12/2052', dateFormat);[m
[31m-[m
[31m-    let dataBeneficio = this.dataInicioBeneficio;[m
[31m-    let teto = moedaDib.teto;[m
[31m-    let minimo = moedaDib.salario_minimo;[m
[31m-[m
[31m-    let comparacaoContribuicao = 35 - redutorSexo;[m
[31m-    if(naoFocado){[m
[31m-      if(fatorSeguranca <= 1){[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator previdenciário'] = fatorSeguranca;[m
[31m-      }else{[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '(Incide fator previdenciario)'});//resultados['Fp - fator previdenciário'] = fatorSeguranca + '(Incide fator previdenciario)';[m
[31m-      }[m
[31m-    }else{[m
[31m-      if (dataBeneficio >= dataRegra85_95) {[m
[31m-        if (dataBeneficio <= dataFimRegra85_95) {[m
[31m-          if (fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao - redutorSexo && this.tipoBeneficio == 4) {[m
[31m-            somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-            conclusoes.push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias[m
[31m-          }else if(fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 6) {     [m
[31m-            somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-            conclusoes.push({string:"Renda Mensal Inicial com Regra 80/90:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 80/90: '] = currency.acronimo + somaMedias[m
[31m-          }else if(fatorSeguranca < 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 4) {[m
[31m-            somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)';[m
[31m-            conclusoes.contribuicao89_99push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias;[m
[31m-          }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[31m-            if (this.tipoBeneficio == 6) {[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[31m-            }else{[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[31m-            }[m
[31m-          }else if(fatorSeguranca > 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[31m-            if (this.tipoBeneficio == 6) {[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[31m-            }else{[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[31m-            }[m
[31m-          }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao >= comparacaoContribuicao) {[m
[31m-            if (this.tipoBeneficio == 6) {[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[31m-            }else{[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[31m-            }[m
[31m-          }else if(dataBeneficio < dataRegra85_95 || dataBeneficio > dataFimRegra85_95){[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator Previdenciario: '] = fatorSeguranca;[m
[31m-          }[m
[31m-        }else if(dataBeneficio >= dataRegra86_96 && dataBeneficio <= dataFimRegra86_96){[m
[31m-          this.tratamentoDeRegras(dataRegra86_96, dataFimRegra86_96, contribuicao86_96, 96, tempoTotalContribuicao, fatorSeguranca, '86/96', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra87_97  && dataBeneficio <= dataFimRegra87_97) {[m
[31m-          this.tratamentoDeRegras(dataRegra87_97, dataFimRegra87_97, contribuicao87_97, 97, tempoTotalContribuicao, fatorSeguranca, '87/97', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra88_98  && dataBeneficio <= dataFimRegra88_98) {[m
[31m-          this.tratamentoDeRegras(dataRegra88_98, dataFimRegra88_98, contribuicao88_98, 98, tempoTotalContribuicao, fatorSeguranca, '88/98', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra89_99  && dataBeneficio <= dataFimRegra89_99) {[m
[31m-          this.tratamentoDeRegras(dataRegra89_99, dataFimRegra89_99, contribuicao89_99, 99, tempoTotalContribuicao, fatorSeguranca, '89/99', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra90_100  && dataBeneficio <= dataFimRegra90_100) {[m
[31m-          this.tratamentoDeRegras(dataRegra90_100, dataFimRegra90_100, contribuicao90_100, 100, tempoTotalContribuicao, fatorSeguranca, '90/100', comparacaoContribuicao, conclusoes);[m
[31m-        }[m
[31m-        }else{[m
[31m-          conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca;[m
[31m-        }[m
[31m-      }[m
[31m-        if (irt >= 1) {[m
[31m-          conclusoes.push({string:"Índice de reajuste no teto:",value:this.formatDecimal(irt, 4)});//resultados['Índice de reajuste no teto: '] = irt; // Arredondar para 4 casas decimais;[m
[31m-        }[m
[31m-[m
[31m-        conclusoes.push({string:"Expectativa de Sobrevida:",value:this.formatDecimal(expectativa, 4)});//resultados['Expectativa de Sobrevida: '] = expectativa; // Arredondar para 4 casas decimais;[m
[31m-[m
[31m-        if (this.tipoBeneficio == 29) {[m
[31m-          rmi = somaMedias * (coeficiente / 100);[m
[31m-          if (rmi <= moedaDib.salario_minimo) {[m
[31m-            rmi = moedaDib.salario_minimo;[m
[31m-          }[m
[31m-        }[m
[31m-[m
[31m-        if (dataBeneficio >= this.dataMP664) {[m
[31m-          if (this.tipoBeneficio == 1 && rmi > totalMediaDozeContribuicoes) {[m
[31m-            if (totalMediaDozeContribuicoes > 0) [m
[31m-              rmi = totalMediaDozeContribuicoes;[m
[31m-          }[m
[31m-          if (this.tipoBeneficio == 1) {[m
[31m-            let rmi2 = 0;[m
[31m-            rmi2 = somaMedias * (coeficiente / 100);[m
[31m-            conclusoes.push({string:"Média das contribuições x Coeficiente do Cálculo:",value:this.formatMoney(rmi2, currency.acronimo)});//resultados['Média das contribuições x Coeficiente do Cálculo: '] = currency.acronimo + rmi2;[m
[31m-          }[m
[31m-        }[m
[31m-[m
[31m-        if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[31m-          conclusoes.push({string:"Renda Mensal Inicial com Fator Previdenciario:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial com Fator Previdenciario: '] = currency.acronimo + rmi;[m
[31m-        }else{[m
[31m-          conclusoes.push({string:"Renda Mensal Inicial:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial: '] = currency.acronimo + rmi;[m
[31m-        }[m
[31m-        this.calculoApos99TableData = tableData;[m
[31m-        this.calculoApos99TableOptions = {[m
[31m-            ...this.calculoApos99TableOptions,[m
[31m-            data: this.calculoApos99TableData,[m
[31m-        }[m
[31m-        // TODO: Salvar Valor do Beneficio no Banco de Dados (rmi, somaContribuicoes);[m
[31m-  }[m
[31m-[m
[31m-  corrigirBeneficio(beneficio, coeficiente, moeda) {[m
[31m-    let beneficioCorrigido = beneficio;[m
[31m-    if (beneficio > moeda.teto){[m
[31m-      beneficioCorrigido = moeda.teto * coeficiente /100;[m
[31m-      this.limited = true;[m
[31m-    }[m
[31m-    if (beneficio < moeda.salario_minimo && this.tipoBeneficio != 7) {[m
[31m-      beneficioCorrigido = moeda.salario_minimo[m
[31m-    }[m
[31m-    return beneficioCorrigido;[m
[31m-  }[m
[31m-[m
[31m-  projetarExpectativa(idadeFracionada, dib, conclusoes) {[m
[31m-    let expectativa = 0;[m
[31m-[m
[31m-    let dataInicio = moment('2000-11-30');[m
[31m-    let dataFim = moment('2016-12-01');[m
[31m-    let dataHoje = moment();[m
[31m-[m
[31m-    if (dib > dataHoje) {[m
[31m-      let anos = dataHoje.diff(dib, 'years');[m
[31m-[m
[31m-      let tempo1 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-2, 'years')).year(), null, null);[m
[31m-      let tempo2 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-3, 'years')).year(), null, null);[m
[31m-      let tempo3 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-4, 'years')).year(), null, null);[m
[31m-      expectativa = (anos * Math.abs((tempo1 + tempo2 + tempo3) / 3) - tempo1) + tempo1;[m
[31m-      conclusoes.push({string:'Fórmula Expectativa de Sobrevida:' ,value: "("+anos+ " * (((" + tempo1 + " + " + tempo2 + "+" + tempo3 + ") / 3) -" + tempo1 + "))" + "+" + tempo1});//formula_expectativa_sobrevida = "(anos * (((tempo1 + tempo2 + tempo3) / 3) - tempo1)) + tempo1";[m
[31m-    } else if (dib <= dataInicio) {[m
[31m-      expectativa = this.procurarExpectativa(idadeFracionada, null, null, dataInicio);[m
[31m-    } else if (dib >= dataFim) {[m
[31m-      expectativa = this.procurarExpectativa(idadeFracionada, null, dib, null);[m
[31m-    } else {[m
[31m-      expectativa = this.procurarExpectativa(idadeFracionada, null, dib, dib);[m
[31m-    }[m
[31m-[m
[31m-    if (expectativa <= 0) {[m
[31m-      expectativa = 6;[m
[31m-    }[m
[31m-[m
[31m-    return expectativa;[m
[31m-  }[m
[31m-[m
[31m-  procurarExpectativa(idadeFracionada, ano, dataInicio, dataFim) {[m
[31m-    let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[31m-    let dataAgora = moment();[m
[31m-    let expectativaVida;[m
[31m-    if (idadeFracionada > 80){[m
[31m-      idadeFracionada = 80;[m
[31m-    }    [m
[31m-    if (ano != null) {[m
[31m-      expectativaVida = this.ExpectativaVida.getByAno(ano);//Carregar do BD na tabela ExpectativaVida onde age == idadeFracionada e year == ano[m
[31m-    }else{[m
[31m-      expectativaVida = this.ExpectativaVida.getByDates(dataInicio, dataFim);[m
[31m-    }[m
[31m-    return expectativaVida;[m
[31m-  }[m
[31m-[m
[31m-  tratamentoDeRegras(dataRegra, dataFimRegra, valorRegra, valorComparacao, tempoTotalContribuicao, fatorSeguranca, resultString, comparacaoTempoContribuicao, conclusoes) {[m
[31m-    let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-    let somaMedias;[m
[31m-    if (fatorSeguranca >= 1 && valorRegra >=  valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao && this.tipoBeneficio == 4) {[m
[31m-      somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-      conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[31m-      //resultados['Renda Mensal Inicial com Regra ' + resultString + ': '] = currency.acronimo + somaMedias;[m
[31m-    }else if(fatorSeguranca >= 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao){[m
[31m-      if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[31m-        somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-        conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[31m-        //resultados['Renda Mensal Inicial com Regra'+ resultString + ' : '] = currency.acronimo + somaMedias[m
[31m-      }[m
[31m-    }else if(fatorSeguranca < 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[31m-      if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[31m-        somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString + ')'});//conclusoes.fator_previdenciario = fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString+ ')';[m
[31m-        conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[31m-        //resultados['specieKind = 4Renda Mensal Inicial com Regra'+ resultString + ': '] = currency.acronimo + somaMedias;[m
[31m-      }[m
[31m-    }else if(fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao){[m
[31m-      if (this.tipoBeneficio == 6 || this.tipoBeneficio == 4) {[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra' + resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra' + resultString;[m
[31m-      }[m
[31m-    }else if (fatorSeguranca > 1 && valorRegra >= valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao) {[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)'});//conclusoes.fator_previdenciario =  fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)';[m
[31m-    }else if (fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra '+ resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra'+ resultString;[m
[31m-    }else if (this.dataInicioBeneficio < dataRegra || this.dataInicioBeneficio > dataFimRegra){[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//conclusoes.fator_previdenciario = fatorSeguranca;[m
[31m-    }[m
[31m-  }[m
[31m-[m
[31m-  getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario) {[m
[31m-    let taxaSecundaria = 0;[m
[31m-    let tempoServicoSecundario = this.getTempoServico(0,0,true);[m
[31m-    let quantidadePBCSecudaria = contadorSecundario;[m
[31m-[m
[31m-    let specieKind;[m
[31m-    if(this.tipoBeneficio == 4 || this.tipoBeneficio ==  5 || this.tipoBeneficio ==  6 ||[m
[31m-      this.tipoBeneficio == 8 || this.tipoBeneficio ==  9 || this.tipoBeneficio ==  10 ||[m
[31m-      this.tipoBeneficio == 14 || this.tipoBeneficio ==  15){[m
[31m-      specieKind = 1;[m
[31m-    }else if(this.tipoBeneficio == 3 || this.tipoBeneficio == 16|| this.tipoBeneficio == 13){[m
[31m-      specieKind = 2;[m
[31m-    }else if(this.tipoBeneficio == 1 || this.tipoBeneficio == 2 || this.tipoBeneficio == 11[m
[31m-             || this.tipoBeneficio == 29){[m
[31m-      specieKind = 3;[m
[31m-    }else if(this.tipoBeneficio == 25){[m
[31m-      specieKind = 4;[m
[31m-    }else{[m
[31m-      specieKind = null;[m
[31m-    }[m
[31m-[m
[31m-    let tempoServico = 0;[m
[31m-    switch(specieKind){[m
[31m-      case 1:[m
[31m-        tempoServico = tempoServicoSecundario / 365;   [m
[31m-        let redutorProporcional = 0;[m
[31m-        if(this.isProportional){[m
[31m-            redutorProporcional = 5;[m
[31m-        }[m
[31m-        taxaSecundaria = tempoServico / (35 - redutorProfessor - redutorSexo - redutorProporcional);[m
[31m-        break;[m
[31m-      case 2:[m
[31m-        tempoServico = tempoServicoSecundario / 30;[m
[31m-        let carenciaMeses = this.getMesesCarencia();[m
[31m-        taxaSecundaria = tempoServico / carenciaMeses;[m
[31m-        break;[m
[31m-      case 3:[m
[31m-          taxaSecundaria = quantidadePBCSecudaria / 12;[m
[31m-          break;[m
[31m-      case 4:[m
[31m-        tempoServico = tempoServicoSecundario / 365;[m
[31m-        if(redutorSexo == 5){[m
[31m-          taxaSecundaria = tempoServico / 20;[m
[31m-        }else{[m
[31m-          taxaSecundaria = tempoServico / 25;[m
[31m-        }[m
[31m-        break;[m
[31m-      case 5:[m
[31m-        tempoServico = tempoServicoSecundario / 365;[m
[31m-        if(redutorSexo == 5){[m
[31m-          taxaSecundaria = tempoServico / 23;[m
[31m-        }else{[m
[31m-          taxaSecundaria = tempoServico / 28;[m
[31m-        }[m
[31m-        break;[m
[31m-      case 6:[m
[31m-        tempoServico = tempoServicoSecundario / 365;[m
[31m-        if(redutorSexo == 5){[m
[31m-          taxaSecundaria = tempoServico / 28;[m
[31m-        }else{[m
[31m-          taxaSecundaria = tempoServico / 33;[m
[31m-        }[m
[31m-        break;[m
[31m-    }[m
[31m-    return taxaSecundaria;[m
[31m-  }[m
[31m-[m
[31m-  getMesesCarencia(){[m
[31m-    let mesesCarencia = 180;[m
[31m-    if (this.dataFiliacao <= this.dataLei8213) {[m
[31m-      let progressiveLack = this.CarenciaProgressiva.getCarencia(this.dataInicioBeneficio.year());[m
[31m-      if(progressiveLack != 0){[m
[31m-        mesesCarencia = progressiveLack;[m
[31m-      }[m
[31m-    }[m
[31m-    return mesesCarencia;[m
[31m-  }[m
[31m-  [m
[31m-  getTempoServico(redutorProfessor, redutorSexo, secundario) {[m
[31m-    let tempo;[m
[31m-[m
[31m-    if(secundario){[m
[31m-      tempo = this.contribuicaoSecundaria99;[m
[31m-      let contagemSecundaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[31m-      return contagemSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    tempo = this.contribuicaoPrimaria99;[m
[31m-    let contagemPrimaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[31m-    let contagemPrimariaAnos = contagemPrimaria / 365;[m
[31m-    if (this.tipoBeneficio == 6) { // Tempo de Serviço Professor[m
[31m-      contagemPrimariaAnos += redutorProfessor + redutorSexo;[m
[31m-    }[m
[31m-[m
[31m-    this.contribuicaoTotal = contagemPrimariaAnos; [m
[31m-[m
[31m-    if (redutorSexo > 0) {[m
[31m-      if (this.tipoBeneficio == 16 || this.tipoBeneficio == 3 || this.tipoBeneficio == 4) {[m
[31m-        contagemPrimariaAnos += redutorSexo;[m
[31m-      }[m
[31m-    }[m
[31m-    return contagemPrimariaAnos;[m
[31m-  }[m
[31m-[m
[31m-  getIndiceEspecie(especie, sexo, anoContribuicao){[m
[31m-		let indiceAno = 0.0[m
[31m-    if (anoContribuicao != 0 ) {[m
[31m-        indiceAno = anoContribuicao / 100;[m
[31m-    }[m
[31m-[m
[31m-    let index = 0.0;[m
[31m-    switch (especie){[m
[31m-      case 1: {// Auxílio Doença[m
[31m-      	index = 0.7;[m
[31m-        if (indiceAno > 0.2){[m
[31m-        	indiceAno = 0.2;[m
[31m-        }[m
[31m-        index += indiceAno;[m
[31m-        break;[m
[31m-      }[m
[31m-      case 2: {// Aposentadoria por invalidez[m
[31m-      	index = 0.7;[m
[31m-      	if (indiceAno > 0.3){[m
[31m-      	    indiceAno = 0.3;[m
[31m-      	}[m
[31m-      	index += indiceAno;[m
[31m-      	break;[m
[31m-      }[m
[31m-      case 3: { // Idade - trabalhador Rural[m
[31m-        index = 0.7;[m
[31m-        if (indiceAno > 0.25) {[m
[31m-        	indiceAno = 0.25;[m
[31m-        }[m
[31m-        index += indiceAno;[m
[31m-        break;[m
[31m-      }[m
[31m-      case 5: { // Idade - trabalhador Urbano[m
[31m-        index = 0.7;[m
[31m-        if (indiceAno > 0.25){[m
[31m-					indiceAno = 0.25;[m
[31m-				}[m
[31m-        index += indiceAno;[m
[31m-      	break;[m
[31m-      }[m
[31m-      case 16: {//Aposentadoria Especial.[m
[31m-      	index = 0.7;[m
[31m-        if (indiceAno > 0.25){[m
[31m-        	indiceAno = 0.25;[m
[31m-        }[m
[31m-        index += indiceAno;[m
[31m-        break;[m
[31m-      }[m
[31m-      case 4: {  // Aposentadoria por tempo de contribuição[m
[31m-      	if(sexo === 'm'){[m
[31m-      	  index = 0.8;[m
[31m-      	  let indiceAnoAux = anoContribuicao - 30;[m
[31m-      	  if(indiceAnoAux > 5){[m
[31m-      	  	indiceAnoAux = 5;[m
[31m-      	  }[m
[31m-      	  if(indiceAnoAux < 0){[m
[31m-      	  	indiceAnoAux = 0;[m
[31m-      	  }[m
[31m-      	  index += (0.03 * indiceAnoAux);[m
[31m-      	}else{[m
[31m-      	    index = 0.95;[m
[31m-      	}[m
[31m-      	break;[m
[31m-      }[m
[31m-      case 20: { [m
[31m-        index = 0.2;[m
[31m-        break;[m
[31m-      }[m
[31m-      default:{[m
[31m-      	index = 0;[m
[31m-      	break;[m
[31m-      }[m
[31m-    }[m
[31m-    return index;[m
[31m-  }[m
[31m-[m
[31m-  getEspecieBeneficio(){[m
[32m+[m[32m  //   let tempoTotalContribuicao = this.getTempoServico(redutorProfessor, redutorSexo, false);[m
[32m+[m
[32m+[m[32m  //   let fatorSeguranca = 1;[m
[32m+[m[32m  //   let aliquota = 0.31;[m
[32m+[m[32m  //   let naoFocado = false;[m
[32m+[m
[32m+[m[32m  //   switch(this.tipoBeneficio) {[m
[32m+[m[32m  //     case 1: // Auxilio Doenca Previdenciario[m
[32m+[m[32m  //     case 2:         // Aposentadoria Invalidez Previdenciaria;[m
[32m+[m[32m  //     case 5:         // Aposentadoria Especial[m
[32m+[m[32m  //     case 7:         // Auxiolio Acidente 50[m
[32m+[m[32m  //       naoFocado = true;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     default:[m
[32m+[m[32m  //       fatorSeguranca = ((tempoTotalContribuicao * aliquota) / expectativa) * (1 + this.idadeFracionada + (tempoTotalContribuicao * aliquota) / 100);[m
[32m+[m[32m  //       // Adicionar nas conclusões a fórmula com os valores, não os resutlados:[m
[32m+[m[32m  //      //conclusoes.formula_fator = "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)";[m
[32m+[m[32m  //       conclusoes.push({string:"Fórmula Fator:",value: "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+this.idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)"});[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 16|| // Aposentadoria Travalhador Rural[m
[32m+[m[32m  //       this.tipoBeneficio ==  3|| // Aposentadoria Trabalhador Urbano[m
[32m+[m[32m  //       this.tipoBeneficio == 25|| // Deficiencia Grave[m
[32m+[m[32m  //       this.tipoBeneficio == 26|| // Deficiencia Leve[m
[32m+[m[32m  //       this.tipoBeneficio == 27|| // Deficiencia Moderada[m
[32m+[m[32m  //       this.tipoBeneficio == 28){  // Deficiencia Por Idade[m
[32m+[m[32m  //       if (fatorSeguranca < 1) {[m
[32m+[m[32m  //         fatorSeguranca = 1;[m
[32m+[m[32m  //         naoFocado = true;[m
[32m+[m[32m  //       }else if(fatorSeguranca > 1) {[m
[32m+[m[32m  //         naoFocado = true;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   //Índice de Reajuste no Teto.[m
[32m+[m[32m  //   let irt = 1;[m
[32m+[m
[32m+[m[32m  //   let mediaContribuicoesPrimarias = totalContribuicaoPrimaria;[m
[32m+[m[32m  //   if (divisorMediaPrimaria > 1) {[m
[32m+[m[32m  //       mediaContribuicoesPrimarias /= divisorMediaPrimaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let mediaContribuicoesSecundarias = totalContribuicaoSecundaria;[m
[32m+[m[32m  //   if (divisorSecundario > 1) {[m
[32m+[m[32m  //       mediaContribuicoesSecundarias /= divisorSecundario;[m[41m    [m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (mediaContribuicoesSecundarias > moedaDib.teto) {[m
[32m+[m[32m  //       mediaContribuicoesSecundarias = moedaDib.teto;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   this.limited = false;[m
[32m+[m
[32m+[m[32m  //   let rmi = fatorSeguranca * numeroCompetencias * mediaContribuicoesPrimarias / 60;[m
[32m+[m
[32m+[m[32m  //   rmi += mediaContribuicoesPrimarias * ((60 - numeroCompetencias) / 60);[m
[32m+[m
[32m+[m[32m  //   let taxaSecundaria = 0;[m
[32m+[m[32m  //   let taxaMediaSecundaria = 0;[m
[32m+[m
[32m+[m[32m  //   if (mediaContribuicoesSecundarias != 0) {[m
[32m+[m[32m  //     taxaSecundaria = this.getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario);[m
[32m+[m[32m  //     taxaMediaSecundaria = mediaContribuicoesSecundarias * taxaSecundaria;[m
[32m+[m[32m  //     if (taxaMediaSecundaria > mediaContribuicoesSecundarias) {[m
[32m+[m[32m  //       taxaMediaSecundaria = mediaContribuicoesSecundarias;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let coeficiente = this.coeficiente;[m
[32m+[m
[32m+[m[32m  //   let somaMedias = mediaContribuicoesPrimarias + taxaMediaSecundaria;[m
[32m+[m[32m  //   let somaMediasAux = this.corrigirBeneficio(somaMedias, coeficiente, moedaDib);[m
[32m+[m
[32m+[m[32m  //   if (this.limited){[m
[32m+[m[32m  //     irt = (somaMedias * (coeficiente / 100))/somaMediasAux;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   rmi += (fatorSeguranca * numeroCompetencias) / 60;[m
[32m+[m[32m  //   rmi += taxaMediaSecundaria * ((60 - numeroCompetencias) / 60)[m
[32m+[m[32m  //   rmi *= (coeficiente / 100);[m
[32m+[m
[32m+[m[32m  //   this.limited = false;[m
[32m+[m
[32m+[m[32m  //   let rmiAux = this.corrigirBeneficio(rmi, coeficiente, moedaDib);[m
[32m+[m[32m  //   rmi = rmiAux;[m
[32m+[m
[32m+[m[32m  //   //let objMoeda = this.moeda[this.getIndex(this.dataInicioBeneficio)];//carregar apenas uma TMoeda onde currency Date é menor ou igual a Calculo.data_pedido_beneficio[m
[32m+[m[32m  //   let objMoeda = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[32m+[m[32m  //   let salarioAcidente = objMoeda.salario_minimo;[m
[32m+[m[32m  //   if (mediaContribuicoesPrimarias > salarioAcidente) {[m
[32m+[m[32m  //     switch(this.tipoBeneficio){[m
[32m+[m[32m  //       case 17:// Auxilio Acidente 30[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.3;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 18: // Auxilio Acidente 40[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.4;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 7: // Auxilio Acidente 50[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.5;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 19: // Auxilio Acidente 60[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.6;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let somaContribuicoes = totalContribuicaoPrimaria + totalContribuicaoSecundaria;[m
[32m+[m
[32m+[m[32m  //   let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m
[32m+[m[32m  //   //conclusoes.coeficiente_calculo = coeficiente;//resultados['Coeficiente do Cálculo'] = coeficiente //Arrendodar para duas casas decimais;[m
[32m+[m[32m  //   //conclusoes.soma_contribuicoes_primarias = this.formatMoney(totalContribuicoesPrimarias, currency.acronimo);//resultados['Soma das Contribuições Primarias'] = currency.acrônimo + totalContribuicoesPrimarias;[m
[32m+[m[32m  //   //conclusoes.divisor_calculo_media_primaria = divisorMediaPrimaria;//resultados['Divisor do Cálculo da média primária: '] = divisorMediaPrimaria;[m
[32m+[m[32m  //   //conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo);//resultados['Média das contribuições primárias'] = currency.acrônimo + mediaContribuicoesPrimarias;[m
[32m+[m[32m  //   conclusoes.push({string:"Coeficiente do Cálculo:",value:coeficiente+'%'});[m
[32m+[m[32m  //   conclusoes.push({string:"Soma das Contribuições Primarias:",value:this.formatMoney(totalContribuicaoPrimaria, currency.acronimo)});[m
[32m+[m[32m  //   conclusoes.push({string:"Divisor do Cálculo da média primária:",value:divisorMediaPrimaria});[m
[32m+[m[32m  //   conclusoes.push({string:"Média das contribuições primárias",value:this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo)});[m
[32m+[m
[32m+[m[32m  //   if (totalContribuicaoSecundaria > 0) {[m
[32m+[m[32m  //     conclusoes.push({string:"Soma das contribuições secundárias:",value:this.formatMoney(totalContribuicaoSecundaria, currency.acronimo)});//resultados['Soma das contribuições secundárias'] = currency.acrônumo + totalContribuicoesSecundarias;[m
[32m+[m[32m  //     conclusoes.push({string:"Divisor do Cálculo da média secundária:",value:divisorSecundario});//resultados['Divisor do Cálculo da média secundária: '] = divisorMediaPrimaria;[m
[32m+[m[32m  //     conclusoes.push({string:"Média das contribuições Secundárias:",value:this.formatMoney(mediaContribuicoesSecundarias, currency.acronimo)});//resultados['Média das contribuições Secundárias: '] =  currency.acrônumo + mediaContribuicoesSecundarias;[m
[32m+[m[32m  //     conclusoes.push({string:"Taxa:",value:taxaSecundaria});//resultados['Taxa: '] =  taxaSecundaria;[m
[32m+[m[32m  //     conclusoes.push({string:"Média Secundárias - Pós Taxa:",value:this.formatMoney(taxaSecundaria, currency.acronimo)});//resultados['Média Secundárias - Pós Taxa: '] =  currency.acrônimo + taxaSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   conclusoes.push({string:"Idade em anos:",value:Math.trunc(this.idadeFracionada)});//resultados['Idade em anos'] = truncate(idadeFracionada) (idadeFracionada);[m
[32m+[m[32m  //   conclusoes.push({string:"Média das contribuições:",value:this.formatMoney(somaMedias, currency.acronimo)});//resultados['Média das contribuições'] = currency.acrônimo + somaMedias;[m
[32m+[m[32m  //   conclusoes.push({string:"CT - Número de competências transcorridas desde 29/11/1999:",value:numeroCompetencias});//resultados['CT - Número de competências transcorridas desde 29/11/1999:'] = numeroCompetencias;[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 6 && redutorSexo == 5){[m
[32m+[m[32m  //     this.contribuicaoTotal -= this.contribuicaoTotal - 5;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let contribuicao85_95 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao86_96 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao87_97 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao88_98 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao89_99 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao90_100 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m
[32m+[m[32m  //   let dateFormat = "DD/MM/YYYY";[m
[32m+[m[32m  //   let dataRegra85_95 = moment('17/06/2016', dateFormat);[m
[32m+[m[32m  //   let dataRegra86_96 = moment('31/12/2018', dateFormat);[m
[32m+[m[32m  //   let dataRegra87_97 = moment('31/12/2020', dateFormat);[m
[32m+[m[32m  //   let dataRegra88_98 = moment('31/12/2022', dateFormat);[m
[32m+[m[32m  //   let dataRegra89_99 = moment('31/12/2024', dateFormat);[m
[32m+[m[32m  //   let dataRegra90_100 = moment('31/12/2026', dateFormat);[m
[32m+[m
[32m+[m[32m  //   let dataFimRegra85_95 = moment('30/12/2018', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra86_96 = moment('30/12/2020', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra87_97 = moment('30/12/2022', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra88_98 = moment('30/12/2024', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra89_99 = moment('30/12/2026', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra90_100 = moment('30/12/2052', dateFormat);[m
[32m+[m
[32m+[m[32m  //   let dataBeneficio = this.dataInicioBeneficio;[m
[32m+[m[32m  //   let teto = moedaDib.teto;[m
[32m+[m[32m  //   let minimo = moedaDib.salario_minimo;[m
[32m+[m
[32m+[m[32m  //   let comparacaoContribuicao = 35 - redutorSexo;[m
[32m+[m[32m  //   if(naoFocado){[m
[32m+[m[32m  //     if(fatorSeguranca <= 1){[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator previdenciário'] = fatorSeguranca;[m
[32m+[m[32m  //     }else{[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '(Incide fator previdenciario)'});//resultados['Fp - fator previdenciário'] = fatorSeguranca + '(Incide fator previdenciario)';[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     if (dataBeneficio >= dataRegra85_95) {[m
[32m+[m[32m  //       if (dataBeneficio <= dataFimRegra85_95) {[m
[32m+[m[32m  //         if (fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao - redutorSexo && this.tipoBeneficio == 4) {[m
[32m+[m[32m  //           somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //           conclusoes.push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias[m
[32m+[m[32m  //         }else if(fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 6) {[m[41m     [m
[32m+[m[32m  //           somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //           conclusoes.push({string:"Renda Mensal Inicial com Regra 80/90:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 80/90: '] = currency.acronimo + somaMedias[m
[32m+[m[32m  //         }else if(fatorSeguranca < 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 4) {[m
[32m+[m[32m  //           somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)';[m
[32m+[m[32m  //           conclusoes.contribuicao89_99push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias;[m
[32m+[m[32m  //         }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[32m+[m[32m  //           if (this.tipoBeneficio == 6) {[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[32m+[m[32m  //           }else{[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //         }else if(fatorSeguranca > 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[32m+[m[32m  //           if (this.tipoBeneficio == 6) {[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[32m+[m[32m  //           }else{[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //         }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao >= comparacaoContribuicao) {[m
[32m+[m[32m  //           if (this.tipoBeneficio == 6) {[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[32m+[m[32m  //           }else{[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //         }else if(dataBeneficio < dataRegra85_95 || dataBeneficio > dataFimRegra85_95){[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator Previdenciario: '] = fatorSeguranca;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra86_96 && dataBeneficio <= dataFimRegra86_96){[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra86_96, dataFimRegra86_96, contribuicao86_96, 96, tempoTotalContribuicao, fatorSeguranca, '86/96', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra87_97  && dataBeneficio <= dataFimRegra87_97) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra87_97, dataFimRegra87_97, contribuicao87_97, 97, tempoTotalContribuicao, fatorSeguranca, '87/97', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra88_98  && dataBeneficio <= dataFimRegra88_98) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra88_98, dataFimRegra88_98, contribuicao88_98, 98, tempoTotalContribuicao, fatorSeguranca, '88/98', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra89_99  && dataBeneficio <= dataFimRegra89_99) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra89_99, dataFimRegra89_99, contribuicao89_99, 99, tempoTotalContribuicao, fatorSeguranca, '89/99', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra90_100  && dataBeneficio <= dataFimRegra90_100) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra90_100, dataFimRegra90_100, contribuicao90_100, 100, tempoTotalContribuicao, fatorSeguranca, '90/100', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //       if (irt >= 1) {[m
[32m+[m[32m  //         conclusoes.push({string:"Índice de reajuste no teto:",value:this.formatDecimal(irt, 4)});//resultados['Índice de reajuste no teto: '] = irt; // Arredondar para 4 casas decimais;[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       conclusoes.push({string:"Expectativa de Sobrevida:",value:this.formatDecimal(expectativa, 4)});//resultados['Expectativa de Sobrevida: '] = expectativa; // Arredondar para 4 casas decimais;[m
[32m+[m
[32m+[m[32m  //       if (this.tipoBeneficio == 29) {[m
[32m+[m[32m  //         rmi = somaMedias * (coeficiente / 100);[m
[32m+[m[32m  //         if (rmi <= moedaDib.salario_minimo) {[m
[32m+[m[32m  //           rmi = moedaDib.salario_minimo;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       if (dataBeneficio >= this.dataMP664) {[m
[32m+[m[32m  //         if (this.tipoBeneficio == 1 && rmi > totalMediaDozeContribuicoes) {[m
[32m+[m[32m  //           if (totalMediaDozeContribuicoes > 0)[m[41m [m
[32m+[m[32m  //             rmi = totalMediaDozeContribuicoes;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //         if (this.tipoBeneficio == 1) {[m
[32m+[m[32m  //           let rmi2 = 0;[m
[32m+[m[32m  //           rmi2 = somaMedias * (coeficiente / 100);[m
[32m+[m[32m  //           conclusoes.push({string:"Média das contribuições x Coeficiente do Cálculo:",value:this.formatMoney(rmi2, currency.acronimo)});//resultados['Média das contribuições x Coeficiente do Cálculo: '] = currency.acronimo + rmi2;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[32m+[m[32m  //         conclusoes.push({string:"Renda Mensal Inicial com Fator Previdenciario:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial com Fator Previdenciario: '] = currency.acronimo + rmi;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         conclusoes.push({string:"Renda Mensal Inicial:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial: '] = currency.acronimo + rmi;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       this.calculoApos99TableData = tableData;[m
[32m+[m[32m  //       this.calculoApos99TableOptions = {[m
[32m+[m[32m  //           ...this.calculoApos99TableOptions,[m
[32m+[m[32m  //           data: this.calculoApos99TableData,[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       // TODO: Salvar Valor do Beneficio no Banco de Dados (rmi, somaContribuicoes);[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // corrigirBeneficio(beneficio, coeficiente, moeda) {[m
[32m+[m[32m  //   let beneficioCorrigido = beneficio;[m
[32m+[m[32m  //   if (beneficio > moeda.teto){[m
[32m+[m[32m  //     beneficioCorrigido = moeda.teto * coeficiente /100;[m
[32m+[m[32m  //     this.limited = true;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   if (beneficio < moeda.salario_minimo && this.tipoBeneficio != 7) {[m
[32m+[m[32m  //     beneficioCorrigido = moeda.salario_minimo[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return beneficioCorrigido;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // projetarExpectativa(idadeFracionada, dib, conclusoes) {[m
[32m+[m[32m  //   let expectativa = 0;[m
[32m+[m
[32m+[m[32m  //   let dataInicio = moment('2000-11-30');[m
[32m+[m[32m  //   let dataFim = moment('2016-12-01');[m
[32m+[m[32m  //   let dataHoje = moment();[m
[32m+[m
[32m+[m[32m  //   if (dib > dataHoje) {[m
[32m+[m[32m  //     let anos = dataHoje.diff(dib, 'years');[m
[32m+[m
[32m+[m[32m  //     let tempo1 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-2, 'years')).year(), null, null);[m
[32m+[m[32m  //     let tempo2 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-3, 'years')).year(), null, null);[m
[32m+[m[32m  //     let tempo3 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-4, 'years')).year(), null, null);[m
[32m+[m[32m  //     expectativa = (anos * Math.abs((tempo1 + tempo2 + tempo3) / 3) - tempo1) + tempo1;[m
[32m+[m[32m  //     conclusoes.push({string:'Fórmula Expectativa de Sobrevida:' ,value: "("+anos+ " * (((" + tempo1 + " + " + tempo2 + "+" + tempo3 + ") / 3) -" + tempo1 + "))" + "+" + tempo1});//formula_expectativa_sobrevida = "(anos * (((tempo1 + tempo2 + tempo3) / 3) - tempo1)) + tempo1";[m
[32m+[m[32m  //   } else if (dib <= dataInicio) {[m
[32m+[m[32m  //     expectativa = this.procurarExpectativa(idadeFracionada, null, null, dataInicio);[m
[32m+[m[32m  //   } else if (dib >= dataFim) {[m
[32m+[m[32m  //     expectativa = this.procurarExpectativa(idadeFracionada, null, dib, null);[m
[32m+[m[32m  //   } else {[m
[32m+[m[32m  //     expectativa = this.procurarExpectativa(idadeFracionada, null, dib, dib);[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (expectativa <= 0) {[m
[32m+[m[32m  //     expectativa = 6;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   return expectativa;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // procurarExpectativa(idadeFracionada, ano, dataInicio, dataFim) {[m
[32m+[m[32m  //   let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[32m+[m[32m  //   let dataAgora = moment();[m
[32m+[m[32m  //   let expectativaVida;[m
[32m+[m[32m  //   if (idadeFracionada > 80){[m
[32m+[m[32m  //     idadeFracionada = 80;[m
[32m+[m[32m  //   }[m[41m    [m
[32m+[m[32m  //   if (ano != null) {[m
[32m+[m[32m  //     expectativaVida = this.ExpectativaVida.getByAno(ano);//Carregar do BD na tabela ExpectativaVida onde age == idadeFracionada e year == ano[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     expectativaVida = this.ExpectativaVida.getByDates(dataInicio, dataFim);[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return expectativaVida;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // tratamentoDeRegras(dataRegra, dataFimRegra, valorRegra, valorComparacao, tempoTotalContribuicao, fatorSeguranca, resultString, comparacaoTempoContribuicao, conclusoes) {[m
[32m+[m[32m  //   let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m  //   let somaMedias;[m
[32m+[m[32m  //   if (fatorSeguranca >= 1 && valorRegra >=  valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao && this.tipoBeneficio == 4) {[m
[32m+[m[32m  //     somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //     conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[32m+[m[32m  //     //resultados['Renda Mensal Inicial com Regra ' + resultString + ': '] = currency.acronimo + somaMedias;[m
[32m+[m[32m  //   }else if(fatorSeguranca >= 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao){[m
[32m+[m[32m  //     if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[32m+[m[32m  //       somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //       conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[32m+[m[32m  //       //resultados['Renda Mensal Inicial com Regra'+ resultString + ' : '] = currency.acronimo + somaMedias[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(fatorSeguranca < 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[32m+[m[32m  //     if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[32m+[m[32m  //       somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString + ')'});//conclusoes.fator_previdenciario = fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString+ ')';[m
[32m+[m[32m  //       conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[32m+[m[32m  //       //resultados['specieKind = 4Renda Mensal Inicial com Regra'+ resultString + ': '] = currency.acronimo + somaMedias;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao){[m
[32m+[m[32m  //     if (this.tipoBeneficio == 6 || this.tipoBeneficio == 4) {[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra' + resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra' + resultString;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if (fatorSeguranca > 1 && valorRegra >= valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao) {[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)'});//conclusoes.fator_previdenciario =  fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)';[m
[32m+[m[32m  //   }else if (fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra '+ resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra'+ resultString;[m
[32m+[m[32m  //   }else if (this.dataInicioBeneficio < dataRegra || this.dataInicioBeneficio > dataFimRegra){[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//conclusoes.fator_previdenciario = fatorSeguranca;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario) {[m
[32m+[m[32m  //   let taxaSecundaria = 0;[m
[32m+[m[32m  //   let tempoServicoSecundario = this.getTempoServico(0,0,true);[m
[32m+[m[32m  //   let quantidadePBCSecudaria = contadorSecundario;[m
[32m+[m
[32m+[m[32m  //   let specieKind;[m
[32m+[m[32m  //   if(this.tipoBeneficio == 4 || this.tipoBeneficio ==  5 || this.tipoBeneficio ==  6 ||[m
[32m+[m[32m  //     this.tipoBeneficio == 8 || this.tipoBeneficio ==  9 || this.tipoBeneficio ==  10 ||[m
[32m+[m[32m  //     this.tipoBeneficio == 14 || this.tipoBeneficio ==  15){[m
[32m+[m[32m  //     specieKind = 1;[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 3 || this.tipoBeneficio == 16|| this.tipoBeneficio == 13){[m
[32m+[m[32m  //     specieKind = 2;[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 1 || this.tipoBeneficio == 2 || this.tipoBeneficio == 11[m
[32m+[m[32m  //            || this.tipoBeneficio == 29){[m
[32m+[m[32m  //     specieKind = 3;[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 25){[m
[32m+[m[32m  //     specieKind = 4;[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     specieKind = null;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let tempoServico = 0;[m
[32m+[m[32m  //   switch(specieKind){[m
[32m+[m[32m  //     case 1:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m[41m   [m
[32m+[m[32m  //       let redutorProporcional = 0;[m
[32m+[m[32m  //       if(this.isProportional){[m
[32m+[m[32m  //           redutorProporcional = 5;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       taxaSecundaria = tempoServico / (35 - redutorProfessor - redutorSexo - redutorProporcional);[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 2:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 30;[m
[32m+[m[32m  //       let carenciaMeses = this.getMesesCarencia();[m
[32m+[m[32m  //       taxaSecundaria = tempoServico / carenciaMeses;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 3:[m
[32m+[m[32m  //         taxaSecundaria = quantidadePBCSecudaria / 12;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //     case 4:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m
[32m+[m[32m  //       if(redutorSexo == 5){[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 20;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 25;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 5:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m
[32m+[m[32m  //       if(redutorSexo == 5){[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 23;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 28;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 6:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m
[32m+[m[32m  //       if(redutorSexo == 5){[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 28;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 33;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return taxaSecundaria;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getMesesCarencia(){[m
[32m+[m[32m  //   let mesesCarencia = 180;[m
[32m+[m[32m  //   if (this.dataFiliacao <= this.dataLei8213) {[m
[32m+[m[32m  //     let progressiveLack = this.CarenciaProgressiva.getCarencia(this.dataInicioBeneficio.year());[m
[32m+[m[32m  //     if(progressiveLack != 0){[m
[32m+[m[32m  //       mesesCarencia = progressiveLack;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return mesesCarencia;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getTempoServico(redutorProfessor, redutorSexo, secundario) {[m
[32m+[m[32m  //   let tempo;[m
[32m+[m
[32m+[m[32m  //   if(secundario){[m
[32m+[m[32m  //     tempo = this.contribuicaoSecundaria99;[m
[32m+[m[32m  //     let contagemSecundaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[32m+[m[32m  //     return contagemSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   tempo = this.contribuicaoPrimaria99;[m
[32m+[m[32m  //   let contagemPrimaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[32m+[m[32m  //   let contagemPrimariaAnos = contagemPrimaria / 365;[m
[32m+[m[32m  //   if (this.tipoBeneficio == 6) { // Tempo de Serviço Professor[m
[32m+[m[32m  //     contagemPrimariaAnos += redutorProfessor + redutorSexo;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   this.contribuicaoTotal = contagemPrimariaAnos;[m[41m [m
[32m+[m
[32m+[m[32m  //   if (redutorSexo > 0) {[m
[32m+[m[32m  //     if (this.tipoBeneficio == 16 || this.tipoBeneficio == 3 || this.tipoBeneficio == 4) {[m
[32m+[m[32m  //       contagemPrimariaAnos += redutorSexo;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return contagemPrimariaAnos;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getIndiceEspecie(especie, sexo, anoContribuicao){[m
[32m+[m		[32m// let indiceAno = 0.0[m
[32m+[m[32m  //   if (anoContribuicao != 0 ) {[m
[32m+[m[32m  //       indiceAno = anoContribuicao / 100;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let index = 0.0;[m
[32m+[m[32m  //   switch (especie){[m
[32m+[m[32m  //     case 1: {// Auxílio Doença[m
[32m+[m[32m  //     	index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.2){[m
[32m+[m[32m  //       	indiceAno = 0.2;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 2: {// Aposentadoria por invalidez[m
[32m+[m[32m  //     	index = 0.7;[m
[32m+[m[32m  //     	if (indiceAno > 0.3){[m
[32m+[m[32m  //     	    indiceAno = 0.3;[m
[32m+[m[32m  //     	}[m
[32m+[m[32m  //     	index += indiceAno;[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 3: { // Idade - trabalhador Rural[m
[32m+[m[32m  //       index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.25) {[m
[32m+[m[32m  //       	indiceAno = 0.25;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 5: { // Idade - trabalhador Urbano[m
[32m+[m[32m  //       index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.25){[m
[32m+[m		[32m// 			indiceAno = 0.25;[m
[32m+[m		[32m// 		}[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 16: {//Aposentadoria Especial.[m
[32m+[m[32m  //     	index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.25){[m
[32m+[m[32m  //       	indiceAno = 0.25;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 4: {  // Aposentadoria por tempo de contribuição[m
[32m+[m[32m  //     	if(sexo === 'm'){[m
[32m+[m[32m  //     	  index = 0.8;[m
[32m+[m[32m  //     	  let indiceAnoAux = anoContribuicao - 30;[m
[32m+[m[32m  //     	  if(indiceAnoAux > 5){[m
[32m+[m[32m  //     	  	indiceAnoAux = 5;[m
[32m+[m[32m  //     	  }[m
[32m+[m[32m  //     	  if(indiceAnoAux < 0){[m
[32m+[m[32m  //     	  	indiceAnoAux = 0;[m
[32m+[m[32m  //     	  }[m
[32m+[m[32m  //     	  index += (0.03 * indiceAnoAux);[m
[32m+[m[32m  //     	}else{[m
[32m+[m[32m  //     	    index = 0.95;[m
[32m+[m[32m  //     	}[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 20: {[m[41m [m
[32m+[m[32m  //       index = 0.2;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     default:{[m
[32m+[m[32m  //     	index = 0;[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return index;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  getEspecieBeneficio(calculo){[m
     let numeroEspecie = 0;[m
[31m-    switch (this.calculo.tipo_seguro) {[m
[32m+[m[32m    switch (calculo.tipo_seguro) {[m
       case "Auxílio Doença":[m
         numeroEspecie = 1;[m
         break;[m
[36m@@ -2058,22 +1975,22 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
       return '';[m
   }[m
 [m
[31m-  limitarTetosEMinimos(valor, data){[m
[31m-    let moeda = this.Moeda.getByDate(data);[m
[31m-    let salarioMinimo = moeda.salario_minimo;[m
[31m-    let tetoSalarial = moeda.teto;[m
[31m-    let avisoString = '';[m
[31m-    let valorRetorno = valor;[m
[31m-[m
[31m-    if(valor < salarioMinimo){[m
[31m-      valorRetorno = salarioMinimo;[m
[31m-      avisoString = 'LIMITADO AO MÍNIMO'[m
[31m-    }else if(valor > tetoSalarial){[m
[31m-      valorRetorno = tetoSalarial;[m
[31m-      avisoString = 'LIMITADO AO TETO'[m
[31m-    }[m
[31m-    return {valor:valorRetorno, aviso:avisoString};[m
[31m-  }[m
[32m+[m[32m  // limitarTetosEMinimos(valor, data){[m
[32m+[m[32m  //   let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m  //   let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m  //   let tetoSalarial = moeda.teto;[m
[32m+[m[32m  //   let avisoString = '';[m
[32m+[m[32m  //   let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m  //   if(valor < salarioMinimo){[m
[32m+[m[32m  //     valorRetorno = salarioMinimo;[m
[32m+[m[32m  //     avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m  //   }else if(valor > tetoSalarial){[m
[32m+[m[32m  //     valorRetorno = tetoSalarial;[m
[32m+[m[32m  //     avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  // }[m
 [m
   getIndex(data){[m
     return this.getDifferenceInMonths(this.primeiraDataTabela,data);[m
[36m@@ -2148,25 +2065,25 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     return returnObj;[m
   }[m
 [m
[31m-  getDataInicio(){[m
[31m-    let dataInicio;[m
[31m-    if(this.calculo.tipo_aposentadoria == 'Anterior a 05/10/1988'){[m
[31m-      dataInicio = this.dataInicioBeneficio;[m
[31m-    }else{[m
[31m-      let dib = this.dataInicioBeneficio;[m
[31m-      if (this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' && [m
[31m-        this.dataInicioBeneficio > this.dataDib99) {[m
[31m-        dib = this.dataDib99;[m
[31m-      }[m
[31m-      if (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[31m-        this.dataInicioBeneficio > this.dataDib98) {[m
[31m-        dib = this.dataDib98;[m
[31m-      }[m
[31m-[m
[31m-      dataInicio = (dib.clone()).startOf('month');[m
[31m-    }[m
[31m-    return dataInicio;[m
[31m-  }[m
[32m+[m[32m  // getDataInicio(){[m
[32m+[m[32m  //   let dataInicio;[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'Anterior a 05/10/1988'){[m
[32m+[m[32m  //     dataInicio = this.dataInicioBeneficio;[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     let dib = this.dataInicioBeneficio;[m
[32m+[m[32m  //     if (this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' &&[m[41m [m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib99) {[m
[32m+[m[32m  //       dib = this.dataDib99;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib98) {[m
[32m+[m[32m  //       dib = this.dataDib98;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     dataInicio = (dib.clone()).startOf('month');[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return dataInicio;[m
[32m+[m[32m  // }[m
 [m
   controleExibicao(){[m
     let data88 = moment('1988-10-05');[m
[36m@@ -2224,53 +2141,53 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     }[m
   }[m
 [m
[31m-  getDataLimite(dataInicio){[m
[31m-    let mesesLimite = 0;[m
[31m-    let mesesLimiteTotal = 0;[m
[31m-    if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[31m-      mesesLimite = 18;[m
[31m-      mesesLimiteTotal = 12;[m
[31m-    } else {[m
[31m-      mesesLimite = 48;[m
[31m-      mesesLimiteTotal = 36;[m
[31m-    }[m
[31m-[m
[31m-    if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-      mesesLimite = 36;[m
[31m-      mesesLimiteTotal = 48;[m
[31m-    }[m
[31m-[m
[31m-    if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-      mesesLimite = 36;[m
[31m-      mesesLimiteTotal = 48;[m
[31m-    }[m
[31m-[m
[31m-    if(this.calculo.tipo_aposentadoria == 'A partir de 29/11/1999'){[m
[31m-      mesesLimite = 0;[m
[31m-      mesesLimiteTotal = 0;[m
[31m-    }[m
[31m-[m
[31m-    let dataLimite;[m
[31m-    if(mesesLimite > 0){[m
[31m-      dataLimite = (dataInicio.clone()).add(-mesesLimite,'months');[m
[31m-    }else{[m
[31m-      dataLimite = moment('1994-07-01');[m
[31m-    }[m
[31m-    return dataLimite;[m
[31m-  }[m
[31m-[m
[31m-  getIdadeFracionada(){[m
[31m-    let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[31m-    let idadeEmDias = this.dataInicioBeneficio.diff(dataNascimento, 'days');[m
[31m-    return idadeEmDias/365.25;[m
[31m-  }[m
[31m-[m
[31m-  getIN45(){[m
[31m-    this.withIN45 = true;[m
[31m-    if(this.tipoBeneficio == 25 || this.tipoBeneficio == 26 || this.tipoBeneficio == 27 || this.tipoBeneficio == 28){[m
[31m-      this.withIN45 = false;[m
[31m-    }[m
[31m-  }[m
[32m+[m[32m  // getDataLimite(dataInicio){[m
[32m+[m[32m  //   let mesesLimite = 0;[m
[32m+[m[32m  //   let mesesLimiteTotal = 0;[m
[32m+[m[32m  //   if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[32m+[m[32m  //     mesesLimite = 18;[m
[32m+[m[32m  //     mesesLimiteTotal = 12;[m
[32m+[m[32m  //   } else {[m
[32m+[m[32m  //     mesesLimite = 48;[m
[32m+[m[32m  //     mesesLimiteTotal = 36;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[32m+[m[32m  //     mesesLimite = 36;[m
[32m+[m[32m  //     mesesLimiteTotal = 48;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[32m+[m[32m  //     mesesLimite = 36;[m
[32m+[m[32m  //     mesesLimiteTotal = 48;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'A partir de 29/11/1999'){[m
[32m+[m[32m  //     mesesLimite = 0;[m
[32m+[m[32m  //     mesesLimiteTotal = 0;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let dataLimite;[m
[32m+[m[32m  //   if(mesesLimite > 0){[m
[32m+[m[32m  //     dataLimite = (dataInicio.clone()).add(-mesesLimite,'months');[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     dataLimite = moment('1994-07-01');[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return dataLimite;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getIdadeFracionada(){[m
[32m+[m[32m  //   let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[32m+[m[32m  //   let idadeEmDias = this.dataInicioBeneficio.diff(dataNascimento, 'days');[m
[32m+[m[32m  //   return idadeEmDias/365.25;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getIN45(){[m
[32m+[m[32m  //   this.withIN45 = true;[m
[32m+[m[32m  //   if(this.tipoBeneficio == 25 || this.tipoBeneficio == 26 || this.tipoBeneficio == 27 || this.tipoBeneficio == 28){[m
[32m+[m[32m  //     this.withIN45 = false;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  // }[m
 [m
   preencheGrupoDeCalculos(){[m
     let especie = this.calculo.tipo_seguro;[m

                   SSUUMMMMAARRYY OOFF LLEESSSS CCOOMMMMAANNDDSS

      Commands marked with * may be preceded by a number, _N.
      Notes in parentheses indicate the behavior if _N is given.
      A key preceded by a caret indicates the Ctrl key; thus ^K is ctrl-K.

  h  H                 Display this help.
  q  :q  Q  :Q  ZZ     Exit.
 ---------------------------------------------------------------------------

                           MMOOVVIINNGG

  e  ^E  j  ^N  CR  *  Forward  one line   (or _N lines).
  y  ^Y  k  ^K  ^P  *  Backward one line   (or _N lines).
  f  ^F  ^V  SPACE  *  Forward  one window (or _N lines).
  b  ^B  ESC-v      *  Backward one window (or _N lines).
  z                 *  Forward  one window (and set window to _N).
  w                 *  Backward one window (and set window to _N).
  ESC-SPACE         *  Forward  one window, but don't stop at end-of-file.
  d  ^D             *  Forward  one half-window (and set half-window to _N).
  u  ^U             *  Backward one half-window (and set half-window to _N).
  ESC-)  RightArrow *  Left  one half screen width (or _N positions).
  ESC-(  LeftArrow  *  Right one half screen width (or _N positions).
  F                    Forward forever; like "tail -f".
  ESC-F                Like F but stop when search pattern is found.
  r  ^R  ^L            Repaint screen.
  R                    Repaint screen, discarding buffered input.
        ---------------------------------------------------
        Default "window" is the screen height.
        Default "half-window" is half of the screen height.
 ---------------------------------------------------------------------------

                          SSEEAARRCCHHIINNGG

  /_p_a_t_t_e_r_n          *  Search forward for (_N-th) matching line.
  ?_p_a_t_t_e_r_n          *  Search backward for (_N-th) matching line.
  n                 *  Repeat previous search (for _N-th occurrence).
  N                 *  Repeat previous search in reverse direction.
  ESC-n             *  Repeat previous search, spanning files.
  ESC-N             *  Repeat previous search, reverse dir. & spanning files.
  ESC-u                Undo (toggle) search highlighting.
  &_p_a_t_t_e_r_n          *  Display only matching lines
        ---------------------------------------------------
        A search pattern may be preceded by one or more of:
        ^N or !  Search for NON-matching lines.
        ^E or *  Search multiple files (pass thru END OF FILE).
        ^F or @  Start search at FIRST file (for /) or last file (for ?).
        ^K       Highlight matches, but don't move (KEEP position).
        ^R       Don't use REGULAR EXPRESSIONS.
 ---------------------------------------------------------------------------

                           JJUUMMPPIINNGG

  g  <  ESC-<       *  Go to first line in file (or line _N).
  G  >  ESC->       *  Go to last line in file (or line _N).
  p  %              *  Go to beginning of file (or _N percent into file).
  t                 *  Go to the (_N-th) next tag.
  T                 *  Go to the (_N-th) previous tag.
  {  (  [           *  Find close bracket } ) ].
  }  )  ]           *  Find open bracket { ( [.
  ESC-^F _<_c_1_> _<_c_2_>  *  Find close bracket _<_c_2_>.
  ESC-^B _<_c_1_> _<_c_2_>  *  Find open bracket _<_c_1_> 
        ---------------------------------------------------
        Each "find close bracket" command goes forward to the close bracket 
          matching the (_N-th) open bracket in the top line.
        Each "find open bracket" command goes backward to the open bracket 
          matching the (_N-th) close bracket in the bottom line.

  m_<_l_e_t_t_e_r_>            Mark the current position with <letter>.
  '_<_l_e_t_t_e_r_>            Go to a previously marked position.
  ''                   Go to the previous position.
  ^X^X                 Same as '.
        ---------------------------------------------------
        A mark is any upper-case or lower-case letter.
        Certain marks are predefined:
             ^  means  beginning of the file
             $  means  end of the file
 ---------------------------------------------------------------------------

                        CCHHAANNGGIINNGG FFIILLEESS

  :e [_f_i_l_e]            Examine a new file.
  ^X^V                 Same as :e.
  :n                *  Examine the (_N-th) next file from the command line.
  :p                *  Examine the (_N-th) previous file from the command line.
  :x                *  Examine the first (or _N-th) file from the command line.
  :d                   Delete the current file from the command line list.
  =  ^G  :f            Print current file name.
 ---------------------------------------------------------------------------

                    MMIISSCCEELLLLAANNEEOOUUSS CCOOMMMMAANNDDSS

  -_<_f_l_a_g_>              Toggle a command line option [see OPTIONS below].
  --_<_n_a_m_e_>             Toggle a command line option, by name.
  __<_f_l_a_g_>              Display the setting of a command line option.
  ___<_n_a_m_e_>             Display the setting of an option, by name.
  +_c_m_d                 Execute the less cmd each time a new file is examined.

  !_c_o_m_m_a_n_d             Execute the shell command with $SHELL.
  |XX_c_o_m_m_a_n_d            Pipe file between current pos & mark XX to shell command.
  v                    Edit the current file with $VISUAL or $EDITOR.
  V                    Print version number of "less".
 ---------------------------------------------------------------------------

                           OOPPTTIIOONNSS

        Most options may be changed either on the command line,
        or from within less by using the - or -- command.
        Options may be given in one of two forms: either a single
        character preceded by a -, or a name preceded by --.

  -?  ........  --help
                  Display help (from command line).
  -a  ........  --search-skip-screen
                  Search skips current screen.
  -A  ........  --SEARCH-SKIP-SCREEN
                  Search starts just after target line.
  -b [_N]  ....  --buffers=[_N]
                  Number of buffers.
  -B  ........  --auto-buffers
                  Don't automatically allocate buffers for pipes.
  -c  ........  --clear-screen
                  Repaint by clearing rather than scrolling.
  -d  ........  --dumb
                  Dumb terminal.
  -D [_x_n_._n]  .  --color=_x_n_._n
                  Set screen colors. (MS-DOS only)
  -e  -E  ....  --quit-at-eof  --QUIT-AT-EOF
                  Quit at end of file.
  -f  ........  --force
                  Force open non-regular files.
  -F  ........  --quit-if-one-screen
                  Quit if entire file fits on first screen.
  -g  ........  --hilite-search
                  Highlight only last match for searches.
  -G  ........  --HILITE-SEARCH
                  Don't highlight any matches for searches.
  -h [_N]  ....  --max-back-scroll=[_N]
                  Backward scroll limit.
  -i  ........  --ignore-case
                  Ignore case in searches that do not contain uppercase.
  -I  ........  --IGNORE-CASE
                  Ignore case in all searches.
  -j [_N]  ....  --jump-target=[_N]
                  Screen position of target lines.
  -J  ........  --status-column
                  Display a status column at left edge of screen.
  -k [_f_i_l_e]  .  --lesskey-file=[_f_i_l_e]
                  Use a lesskey file.
  -K            --quit-on-intr
                  Exit less in response to ctrl-C.
  -L  ........  --no-lessopen
                  Ignore the LESSOPEN environment variable.
  -m  -M  ....  --long-prompt  --LONG-PROMPT
                  Set prompt style.
  -n  -N  ....  --line-numbers  --LINE-NUMBERS
                  Don't use line numbers.
  -o [_f_i_l_e]  .  --log-file=[_f_i_l_e]
                  Copy to log file (standard input only).
  -O [_f_i_l_e]  .  --LOG-FILE=[_f_i_l_e]
                  Copy to log file (unconditionally overwrite).
  -p [_p_a_t_t_e_r_n]  --pattern=[_p_a_t_t_e_r_n]
                  Start at pattern (from command line).
  -P [_p_r_o_m_p_t]   --prompt=[_p_r_o_m_p_t]
                  Define new prompt.
  -q  -Q  ....  --quiet  --QUIET  --silent --SILENT
                  Quiet the terminal bell.
  -r  -R  ....  --raw-control-chars  --RAW-CONTROL-CHARS
                  Output "raw" control characters.
  -s  ........  --squeeze-blank-lines
                  Squeeze multiple blank lines.
  -S  ........  --chop-long-lines
                  Chop (truncate) long lines rather than wrapping.
  -t [_t_a_g]  ..  --tag=[_t_a_g]
                  Find a tag.
  -T [_t_a_g_s_f_i_l_e] --tag-file=[_t_a_g_s_f_i_l_e]
                  Use an alternate tags file.
  -u  -U  ....  --underline-special  --UNDERLINE-SPECIAL
                  Change handling of backspaces.
  -V  ........  --version
                  Display the version number of "less".
  -w  ........  --hilite-unread
                  Highlight first new line after forward-screen.
  -W  ........  --HILITE-UNREAD
                  Highlight first new line after any forward movement.
  -x [_N[,...]]  --tabs=[_N[,...]]
                  Set tab stops.
  -X  ........  --no-init
                  Don't use termcap init/deinit strings.
  -y [_N]  ....  --max-forw-scroll=[_N]
                  Forward scroll limit.
  -z [_N]  ....  --window=[_N]
                  Set size of window.
  -" [_c[_c]]  .  --quotes=[_c[_c]]
                  Set shell quote characters.
  -~  ........  --tilde
                  Don't display tildes after end of file.
  -# [_N]  ....  --shift=[_N]
                  Horizontal scroll amount (0 = one half screen width)
      ........  --no-keypad
                  Don't send termcap keypad init/deinit strings.
      ........  --follow-name
                  The F command changes files if the input file is renamed.
      ........  --use-backslash
                  Subsequent options use backslash as escape char.


 ---------------------------------------------------------------------------

                          LLIINNEE EEDDIITTIINNGG

        These keys can be used to edit text being entered 
        on the "command line" at the bottom of the screen.

 RightArrow ..................... ESC-l ... Move cursor right one character.
 LeftArrow ...................... ESC-h ... Move cursor left one character.
 ctrl-RightArrow  ESC-RightArrow  ESC-w ... Move cursor right one word.
 ctrl-LeftArrow   ESC-LeftArrow   ESC-b ... Move cursor left one word.
 HOME ........................... ESC-0 ... Move cursor to start of line.
 END ............................ ESC-$ ... Move cursor to end of line.
 BACKSPACE ................................ Delete char to left of cursor.
 DELETE ......................... ESC-x ... Delete char under cursor.
 ctrl-BACKSPACE   ESC-BACKSPACE ........... Delete word to left of cursor.
 ctrl-DELETE .... ESC-DELETE .... ESC-X ... Delete word under cursor.
 ctrl-U ......... ESC (MS-DOS only) ....... Delete entire line.
 UpArrow ........................ ESC-k ... Retrieve previous command line.
 DownArrow ...................... ESC-j ... Retrieve next command line.
 TAB ...................................... Complete filename & cycle.
 SHIFT-TAB ...................... ESC-TAB   Complete filename & reverse cycle.
 ctrl-L ................................... Complete filename, list all.



                   SSUUMMMMAARRYY OOFF LLEESSSS CCOOMMMMAANNDDSS

      Commands marked with * may be preceded by a number, _N.
      Notes in parentheses indicate the behavior if _N is given.
      A key preceded by a caret indicates the Ctrl key; thus ^K is ctrl-K.

  h  H                 Display this help.
  q  :q  Q  :Q  ZZ     Exit.
 ---------------------------------------------------------------------------

                           MMOOVVIINNGG

  e  ^E  j  ^N  CR  *  Forward  one line   (or _N lines).
  y  ^Y  k  ^K  ^P  *  Backward one line   (or _N lines).
  f  ^F  ^V  SPACE  *  Forward  one window (or _N lines).
  b  ^B  ESC-v      *  Backward one window (or _N lines).
  z                 *  Forward  one window (and set window to _N).
  w                 *  Backward one window (and set window to _N).
  ESC-SPACE         *  Forward  one window, but don't stop at end-of-file.
  d  ^D             *  Forward  one half-window (and set half-window to _N).
  u  ^U             *  Backward one half-window (and set half-window to _N).
  ESC-)  RightArrow *  Left  one half screen width (or _N positions).
  ESC-(  LeftArrow  *  Right one half screen width (or _N positions).
  F                    Forward forever; like "tail -f".
  ESC-F                Like F but stop when search pattern is found.
  r  ^R  ^L            Repaint screen.
  R                    Repaint screen, discarding buffered input.
        ---------------------------------------------------
        Default "window" is the screen height.
        Default "half-window" is half of the screen height.
 ---------------------------------------------------------------------------

                          SSEEAARRCCHHIINNGG

  /_p_a_t_t_e_r_n          *  Search forward for (_N-th) matching line.
  ?_p_a_t_t_e_r_n          *  Search backward for (_N-th) matching line.
  n                 *  Repeat previous search (for _N-th occurrence).
  N                 *  Repeat previous search in reverse direction.
  ESC-n             *  Repeat previous search, spanning files.
  ESC-N             *  Repeat previous search, reverse dir. & spanning files.
  ESC-u                Undo (toggle) search highlighting.
  &_p_a_t_t_e_r_n          *  Display only matching lines
        ---------------------------------------------------
        A search pattern may be preceded by one or more of:
        ^N or !  Search for NON-matching lines.
        ^E or *  Search multiple files (pass thru END OF FILE).
        ^F or @  Start search at FIRST file (for /) or last file (for ?).
        ^K       Highlight matches, but don't move (KEEP position).
        ^R       Don't use REGULAR EXPRESSIONS.
 ---------------------------------------------------------------------------

                           JJUUMMPPIINNGG

  g  <  ESC-<       *  Go to first line in file (or line _N).
  G  >  ESC->       *  Go to last line in file (or line _N).
  p  %              *  Go to beginning of file (or _N percent into file).
  t                 *  Go to the (_N-th) next tag.
  T                 *  Go to the (_N-th) previous tag.
  {  (  [           *  Find close bracket } ) ].
  }  )  ]           *  Find open bracket { ( [.
  ESC-^F _<_c_1_> _<_c_2_>  *  Find close bracket _<_c_2_>.
  ESC-^B _<_c_1_> _<_c_2_>  *  Find open bracket _<_c_1_> 
        ---------------------------------------------------
        Each "find close bracket" command goes forward to the close bracket 
          matching the (_N-th) open bracket in the top line.
        Each "find open bracket" command goes backward to the open bracket 
          matching the (_N-th) close bracket in the bottom line.

  m_<_l_e_t_t_e_r_>            Mark the current position with <letter>.
  '_<_l_e_t_t_e_r_>            Go to a previously marked position.
  ''                   Go to the previous position.
  ^X^X                 Same as '.
        ---------------------------------------------------
        A mark is any upper-case or lower-case letter.
        Certain marks are predefined:
             ^  means  beginning of the file
             $  means  end of the file
 ---------------------------------------------------------------------------

                        CCHHAANNGGIINNGG FFIILLEESS

  :e [_f_i_l_e]            Examine a new file.
  ^X^V                 Same as :e.
  :n                *  Examine the (_N-th) next file from the command line.
  :p                *  Examine the (_N-th) previous file from the command line.
  :x                *  Examine the first (or _N-th) file from the command line.
  :d                   Delete the current file from the command line list.
  =  ^G  :f            Print current file name.
 ---------------------------------------------------------------------------

                    MMIISSCCEELLLLAANNEEOOUUSS CCOOMMMMAANNDDSS

  -_<_f_l_a_g_>              Toggle a command line option [see OPTIONS below].
  --_<_n_a_m_e_>             Toggle a command line option, by name.
  __<_f_l_a_g_>              Display the setting of a command line option.
  ___<_n_a_m_e_>             Display the setting of an option, by name.
  +_c_m_d                 Execute the less cmd each time a new file is examined.

  !_c_o_m_m_a_n_d             Execute the shell command with $SHELL.
  |XX_c_o_m_m_a_n_d            Pipe file between current pos & mark XX to shell command.
  v                    Edit the current file with $VISUAL or $EDITOR.
  V                    Print version number of "less".
 ---------------------------------------------------------------------------

                           OOPPTTIIOONNSS

        Most options may be changed either on the command line,
        or from within less by using the - or -- command.
        Options may be given in one of two forms: either a single
        character preceded by a -, or a name preceded by --.

  -?  ........  --help
                  Display help (from command line).
  -a  ........  --search-skip-screen
                  Search skips current screen.
  -A  ........  --SEARCH-SKIP-SCREEN
                  Search starts just after target line.
  -b [_N]  ....  --buffers=[_N]
                  Number of buffers.
  -B  ........  --auto-buffers
                  Don't automatically allocate buffers for pipes.
  -c  ........  --clear-screen
                  Repaint by clearing rather than scrolling.
  -d  ........  --dumb
                  Dumb terminal.
  -D [_x_n_._n]  .  --color=_x_n_._n
                  Set screen colors. (MS-DOS only)
  -e  -E  ....  --quit-at-eof  --QUIT-AT-EOF
                  Quit at end of file.
  -f  ........  --force
                  Force open non-regular files.
  -F  ........  --quit-if-one-screen
                  Quit if entire file fits on first screen.
  -g  ........  --hilite-search
                  Highlight only last match for searches.
  -G  ........  --HILITE-SEARCH
                  Don't highlight any matches for searches.
  -h [_N]  ....  --max-back-scroll=[_N]
                  Backward scroll limit.
  -i  ........  --ignore-case
                  Ignore case in searches that do not contain uppercase.
  -I  ........  --IGNORE-CASE
                  Ignore case in all searches.
  -j [_N]  ....  --jump-target=[_N]
                  Screen position of target lines.
  -J  ........  --status-column
                  Display a status column at left edge of screen.
  -k [_f_i_l_e]  .  --lesskey-file=[_f_i_l_e]
                  Use a lesskey file.
  -K            --quit-on-intr
                  Exit less in response to ctrl-C.
  -L  ........  --no-lessopen
                  Ignore the LESSOPEN environment variable.
  -m  -M  ....  --long-prompt  --LONG-PROMPT
                  Set prompt style.
  -n  -N  ....  --line-numbers  --LINE-NUMBERS
                  Don't use line numbers.
  -o [_f_i_l_e]  .  --log-file=[_f_i_l_e]
                  Copy to log file (standard input only).
  -O [_f_i_l_e]  .  --LOG-FILE=[_f_i_l_e]
                  Copy to log file (unconditionally overwrite).
  -p [_p_a_t_t_e_r_n]  --pattern=[_p_a_t_t_e_r_n]
                  Start at pattern (from command line).
  -P [_p_r_o_m_p_t]   --prompt=[_p_r_o_m_p_t]
                  Define new prompt.
  -q  -Q  ....  --quiet  --QUIET  --silent --SILENT
                  Quiet the terminal bell.
  -r  -R  ....  --raw-control-chars  --RAW-CONTROL-CHARS
                  Output "raw" control characters.
  -s  ........  --squeeze-blank-lines
                  Squeeze multiple blank lines.
  -S  ........  --chop-long-lines
                  Chop (truncate) long lines rather than wrapping.
  -t [_t_a_g]  ..  --tag=[_t_a_g]
                  Find a tag.
  -T [_t_a_g_s_f_i_l_e] --tag-file=[_t_a_g_s_f_i_l_e]
                  Use an alternate tags file.
  -u  -U  ....  --underline-special  --UNDERLINE-SPECIAL
                  Change handling of backspaces.
  -V  ........  --version
                  Display the version number of "less".
  -w  ........  --hilite-unread
                  Highlight first new line after forward-screen.
  -W  ........  --HILITE-UNREAD
                  Highlight first new line after any forward movement.
  -x [_N[,...]]  --tabs=[_N[,...]]
                  Set tab stops.
  -X  ........  --no-init
                  Don't use termcap init/deinit strings.
  -y [_N]  ....  --max-forw-scroll=[_N]
                  Forward scroll limit.
  -z [_N]  ....  --window=[_N]
                  Set size of window.
  -" [_c[_c]]  .  --quotes=[_c[_c]]
                  Set shell quote characters.
  -~  ........  --tilde
                  Don't display tildes after end of file.
  -# [_N]  ....  --shift=[_N]
                  Horizontal scroll amount (0 = one half screen width)
      ........  --no-keypad
                  Don't send termcap keypad init/deinit strings.
      ........  --follow-name
                  The F command changes files if the input file is renamed.
      ........  --use-backslash
                  Subsequent options use backslash as escape char.


 ---------------------------------------------------------------------------

                          LLIINNEE EEDDIITTIINNGG

        These keys can be used to edit text being entered 
        on the "command line" at the bottom of the screen.

 RightArrow ..................... ESC-l ... Move cursor right one character.
 LeftArrow ...................... ESC-h ... Move cursor left one character.
 ctrl-RightArrow  ESC-RightArrow  ESC-w ... Move cursor right one word.
 ctrl-LeftArrow   ESC-LeftArrow   ESC-b ... Move cursor left one word.
 HOME ........................... ESC-0 ... Move cursor to start of line.
 END ............................ ESC-$ ... Move cursor to end of line.
 BACKSPACE ................................ Delete char to left of cursor.
 DELETE ......................... ESC-x ... Delete char under cursor.
 ctrl-BACKSPACE   ESC-BACKSPACE ........... Delete word to left of cursor.
 ctrl-DELETE .... ESC-DELETE .... ESC-X ... Delete word under cursor.
 ctrl-U ......... ESC (MS-DOS only) ....... Delete entire line.
 UpArrow ........................ ESC-k ... Retrieve previous command line.
 DownArrow ...................... ESC-j ... Retrieve next command line.
 TAB ...................................... Complete filename & cycle.
 SHIFT-TAB ...................... ESC-TAB   Complete filename & reverse cycle.
 ctrl-L ................................... Complete filename, list all.


[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts[m
[1mindex 71ac93a..ddfdfa0 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados-anterior88/rgps-resultados-anterior88.component.ts[m
[36m@@ -17,7 +17,7 @@[m [mimport * as moment from 'moment';[m
   templateUrl: './rgps-resultados-anterior88.component.html',[m
   styleUrls: ['./rgps-resultados-anterior88.component.css'][m
 })[m
[31m-export class RgpsResultadosAnterior88Component implements OnInit {[m
[32m+[m[32mexport class RgpsResultadosAnterior88Component extends RgpsResultadosComponent implements OnInit {[m
 [m
 	@Input() calculo;[m
 	@Input() segurado;[m
[36m@@ -58,7 +58,7 @@[m [mexport class RgpsResultadosAnterior88Component implements OnInit {[m
     private Moeda: MoedaService,[m
     private IndiceInps: IndiceInpsService,[m
     private SalarioMinimoMaximo: SalarioMinimoMaximoService,[m
[31m-    ) { }[m
[32m+[m[32m    ) {super(null, null, null, null);}[m
 [m
   ngOnInit(){[m
   	this.isUpdating = true;[m
[36m@@ -397,4 +397,21 @@[m [mexport class RgpsResultadosAnterior88Component implements OnInit {[m
     }[m
     return index;[m
   }[m
[32m+[m
[32m+[m[32m  limitarTetosEMinimos(valor, data){[m
[32m+[m[32m    let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m    let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m    let tetoSalarial = moeda.teto;[m
[32m+[m[32m    let avisoString = '';[m
[32m+[m[32m    let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m    if(valor < salarioMinimo){[m
[32m+[m[32m      valorRetorno = salarioMinimo;[m
[32m+[m[32m      avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m    }else if(valor > tetoSalarial){[m
[32m+[m[32m      valorRetorno = tetoSalarial;[m
[32m+[m[32m      avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m    }[m
[32m+[m[32m    return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  }[m
 }[m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts[m
[1mindex 6b199fe..d4e7b8d 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados-apos99/rgps-resultados-apos99.component.ts[m
[36m@@ -6,8 +6,12 @@[m [mimport { ReajusteAutomaticoService } from '../ReajusteAutomatico.service';[m
 import { ValorContribuidoService } from '../../+rgps-valores-contribuidos/ValorContribuido.service'[m
 import { CarenciaProgressiva } from '../CarenciaProgressiva.model';[m
 import { CarenciaProgressivaService } from '../CarenciaProgressiva.service';[m
[32m+[m[32mimport { Router, ActivatedRoute } from '@angular/router';[m
[32m+[m[32mimport { CalculoRgpsService } from '../../+rgps-calculos/CalculoRgps.service';[m
[32m+[m[32mimport { SeguradoService } from '../../+rgps-segurados/SeguradoRgps.service';[m
 import { Moeda } from '../../../services/Moeda.model';[m
 import { MoedaService } from '../../../services/Moeda.service';[m
[32m+[m[32mimport { RgpsResultadosComponent } from '../rgps-resultados.component'[m
 import * as moment from 'moment';[m
 [m
 @Component({[m
[36m@@ -15,9 +19,10 @@[m [mimport * as moment from 'moment';[m
   templateUrl: './rgps-resultados-apos99.component.html',[m
   styleUrls: ['./rgps-resultados-apos99.component.css'][m
 })[m
[31m-export class RgpsResultadosApos99Component implements OnInit {[m
[32m+[m[32mexport class RgpsResultadosApos99Component extends RgpsResultadosComponent implements OnInit {[m
 	@Input() calculo;[m
 	@Input() segurado;[m
[32m+[m
 	public dataFiliacao;[m
 	public idadeSegurado;[m
 	public idCalculo;[m
[36m@@ -64,7 +69,8 @@[m [mexport class RgpsResultadosApos99Component implements OnInit {[m
   	private ReajusteAutomatico:ReajusteAutomaticoService,[m
     protected ValoresContribuidos: ValorContribuidoService,[m
     private CarenciaProgressiva:CarenciaProgressivaService,[m
[31m-    private Moeda: MoedaService,) { }[m
[32m+[m[32m    private Moeda: MoedaService){[m
[32m+[m[32m    super(null, null, null, null); }[m
 [m
   ngOnInit() {[m
   	this.isUpdating = true;[m
[36m@@ -940,6 +946,45 @@[m [mexport class RgpsResultadosApos99Component implements OnInit {[m
     }[m
   }[m
 [m
[32m+[m[32m  limitarTetosEMinimos(valor, data){[m
[32m+[m[32m    let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m    let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m    let tetoSalarial = moeda.teto;[m
[32m+[m[32m    let avisoString = '';[m
[32m+[m[32m    let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m    if(valor < salarioMinimo){[m
[32m+[m[32m      valorRetorno = salarioMinimo;[m
[32m+[m[32m      avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m    }else if(valor > tetoSalarial){[m
[32m+[m[32m      valorRetorno = tetoSalarial;[m
[32m+[m[32m      avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m    }[m
[32m+[m[32m    return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  }[m
[32m+[m
[32m+[m[32m  verificarCarencia(redutorIdade, redutorProfessor, redutorSexo, errorArray) {[m
[32m+[m[32m    if (this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[32m+[m[32m      let mesesCarencia = 180;[m
[32m+[m[32m      if (moment(this.segurado.data_filiacao, 'DD/MM/YYYY') < this.dataLei8213) { // Verificar se a data de filiação existe[m
[32m+[m[32m        let anoNecessario = this.getAnoNecessario(redutorIdade, redutorProfessor, redutorSexo)[m
[32m+[m[32m        let carenciaProgressiva = this.CarenciaProgressiva.getCarencia(anoNecessario);[m
[32m+[m[32m        if (carenciaProgressiva != 0) {[m
[32m+[m[32m            mesesCarencia = carenciaProgressiva;[m
[32m+[m[32m        } else if (anoNecessario < 1991) {[m
[32m+[m[32m            mesesCarencia = 60;[m
[32m+[m[32m        }[m
[32m+[m[32m      }[m
[32m+[m
[32m+[m[32m      if (this.calculo.carencia < mesesCarencia) {[m
[32m+[m[32m        let erroCarencia = "Falta(m) " + (mesesCarencia - this.calculo.carencia) + " mês(es) para a carência necessária.";[m
[32m+[m[32m        errorArray.push(erroCarencia);[m
[32m+[m[32m        return false;[m
[32m+[m[32m      }[m
[32m+[m[32m    }[m
[32m+[m[32m    return true;[m
[32m+[m[32m  }[m
[32m+[m
   getIdadeFracionada(){[m
     let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
     let idadeEmDias = this.dataInicioBeneficio.diff(dataNascimento, 'days');[m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts[m
[1mindex a182527..79502e2 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados-entre91e98/rgps-resultados-entre91e98.component.ts[m
[36m@@ -14,7 +14,7 @@[m [mimport * as moment from 'moment';[m
   templateUrl: './rgps-resultados-entre91e98.component.html',[m
   styleUrls: ['./rgps-resultados-entre91e98.component.css'][m
 })[m
[31m-export class RgpsResultadosEntre91e98Component implements OnInit {[m
[32m+[m[32mexport class RgpsResultadosEntre91e98Component extends RgpsResultadosComponent implements OnInit {[m
 	@Input() calculo;[m
 	@Input() segurado;[m
 	@Input() tipoCalculo;[m
[36m@@ -55,7 +55,7 @@[m [mexport class RgpsResultadosEntre91e98Component implements OnInit {[m
   constructor(private CarenciaProgressiva:CarenciaProgressivaService,[m
     private ReajusteAutomatico:ReajusteAutomaticoService,[m
     protected ValoresContribuidos: ValorContribuidoService,[m
[31m-    private Moeda: MoedaService,) { }[m
[32m+[m[32m    private Moeda: MoedaService,) { super(null, null, null, null);}[m
 [m
   ngOnInit() {[m
   	this.isUpdating = true;[m
[36m@@ -714,4 +714,21 @@[m [mexport class RgpsResultadosEntre91e98Component implements OnInit {[m
     return bonus;[m
   }[m
 [m
[32m+[m[32m  limitarTetosEMinimos(valor, data){[m
[32m+[m[32m    let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m    let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m    let tetoSalarial = moeda.teto;[m
[32m+[m[32m    let avisoString = '';[m
[32m+[m[32m    let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m    if(valor < salarioMinimo){[m
[32m+[m[32m      valorRetorno = salarioMinimo;[m
[32m+[m[32m      avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m    }else if(valor > tetoSalarial){[m
[32m+[m[32m      valorRetorno = tetoSalarial;[m
[32m+[m[32m      avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m    }[m
[32m+[m[32m    return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  }[m
[32m+[m
 }[m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html[m
[1mindex 0392054..4d0ee27 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.html[m
[36m@@ -123,1013 +123,23 @@[m
         </sa-widget>[m
       </article>[m
 [m
[31m-      <!-- Opções do Cálculo Anterior a 05/10/1988 -->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculoAnterior88">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 345[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <!--Não disponivel para cálculo  Anterior a 05/10/1988   [m
[31m-              <tr>[m
[31m-              <td>[m
[31m-                <p>Calcular com base na tabela do INPC vigente na data da DIB</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-calculator"></i>[m
[31m-                  </span> CÁLCULAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr> -->[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Tabela e Informações do Cálculo Anterior a 05/10/1988 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculoAnterior88">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} Anterior a 05/10/1988</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimariaAnterior88.anos}} ano(s), {{contribuicaoPrimariaAnterior88.meses}} mês(es) e {{contribuicaoPrimariaAnterior88.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundariaAnterior88.anos}} ano(s), {{contribuicaoSecundariaAnterior88.meses}} mês(es) e {{contribuicaoSecundariaAnterior88.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert" *ngIf="erro">[m
[31m-            <!--<strong>NÃO POSSUI</strong> direito ao benefício[m
[31m-                <strong>Falta(m) 20 ano(s) e 2 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>INTEGRAL</strong>. -->[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-            </div>[m
[31m-            <div>[m
[31m-              <sa-datatable [options]="calculoAnterior88TableOptions" *ngIf="!isUpdating && !erro"[m
[31m-                paginationLength="true" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>Competência</th>[m
[31m-                    <th>Contribuição Primária</th>[m
[31m-                    <th>Contribuição Secundária</th>[m
[31m-                    <th>Índice Anual INPS</th>[m
[31m-                    <th>Contribuição Primária Corrigida</th>[m
[31m-                    <th>Contribuição Secundária Corrigida</th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-              </sa-datatable>[m
[31m-          </div>[m
[31m-          <div class="widget-body" *ngIf="!isUpdating && !erro">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.total_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.media_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.divisor_calculo_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.media_contribuicoes}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Maior valor teto (MVT):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.maior_valor_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Menor valor teto (mvt):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.menor_valor_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">% de Cálculo do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.porcentagem_calculo_beneficio}}%</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Benefício mínimo com índice (Min para a RMI):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.beneficio_minimo_com_indice}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">95% do valor da média (Max para a RMI):</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.noventaecinco_porcento_valor_da_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoesAnterior88.renda_mensal_inicial}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Opções do Cálculo Entre 05/04/1991 e 15/12/1998 -->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculo91_98">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 346[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Calcular com base na tabela do INPC vigente na data da DIB</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-calculator"></i>[m
[31m-                  </span> CÁLCULAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Tabela e Informações do Cálculo Entre 05/04/1991 e 15/12/1998 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculo91_98">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} Entre 05/04/1991 e 15/12/1998</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimaria91_98.anos}} ano(s), {{contribuicaoPrimaria91_98.meses}} mês(es) e {{contribuicaoPrimaria91_98.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundaria91_98.anos}} ano(s), {{contribuicaoSecundaria91_98.meses}} mês(es) e {{contribuicaoSecundaria91_98.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-[m
[31m-              <div class="alert alert-warning margin-top-10" *ngFor="let erro of errosCalculo91_98" role="alert">[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-[m
[31m-              <!-- <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>NÃO POSSUI</strong> direito ao benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 16 ano(s)</strong> para atingir a idade mínima.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 18 ano(s) e 10 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 19 ano(s) e 11 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>PROPORCIONAL</strong>.</div> -->[m
[31m-[m
[31m-            </div>[m
[31m-            <div>[m
[31m-              <sa-datatable [options]="calculo91_98TableOptions" *ngIf="!isUpdating && errosCalculo91_98.length == 0"[m
[31m-                paginationLength="true" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>Competência</th>[m
[31m-                    <th>Fator</th>[m
[31m-                    <th>Contribuição Primaria</th>[m
[31m-                    <th>Contribuição Secundária</th>[m
[31m-                    <th>Contribuição Primária Corrigida</th>[m
[31m-                    <th>Contribuição Secundária Corrigida</th>[m
[31m-                    <th>Limite</th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-              </sa-datatable>[m
[31m-            </div>[m
[31m-            <div class="widget-body" *ngIf="!isUpdating && errosCalculo91_98.length == 0">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Índice de reajuste no teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.indice_reajuste_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.total_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.media_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.divisor_calculo_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.total_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.media_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.divisor_calculo_media_secundaria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Coeficiente:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.coeficiente}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.media_contribuicoes}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Salário Mínimo:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.salario_minimo}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.renda_mensal_inicial}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial na DIB:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes91_98.renda_mensal_inicial_data_dib}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Opções do Cálculo Entre 16/12/1998 e 28/11/1999 -->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculo91_98">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 346[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Calcular com base na tabela do INPC vigente na data da DIB</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-calculator"></i>[m
[31m-                  </span> CÁLCULAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-     <!-- Tabela e Informações do Cálculo Entre 16/12/1998 e 28/11/1999 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculo98_99">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} Entre 16/12/1998 e 28/11/1999</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimaria99.anos}} ano(s), {{contribuicaoPrimaria99.meses}} mês(es) e {{contribuicaoPrimaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundaria99.anos}} ano(s), {{contribuicaoSecundaria99.meses}} mês(es) e {{contribuicaoSecundaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-[m
[31m-              <div class="alert alert-warning margin-top-10" *ngFor="let erro of errosCalculo98_99" role="alert">[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-[m
[31m-              <!-- <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>NÃO POSSUI</strong> direito ao benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 16 ano(s)</strong> para atingir a idade mínima.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 18 ano(s) e 10 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>INTEGRAL</strong>.</div>[m
[31m-              <div class="alert alert-warning margin-top-10" role="alert">[m
[31m-                <strong>Falta(m) 19 ano(s) e 11 mes(es)</strong> para completar o tempo de serviço necessário para o benefício[m
[31m-                <strong>PROPORCIONAL</strong>.</div> -->[m
[31m-[m
[31m-            </div>[m
[31m-            <div>[m
[31m-              <sa-datatable [options]="calculo98_99TableOptions" *ngIf="!isUpdating && errosCalculo98_99.length == 0"[m
[31m-                paginationLength="true" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>Competência</th>[m
[31m-                    <th>Fator</th>[m
[31m-                    <th>Contribuição Primaria</th>[m
[31m-                    <th>Contribuição Secundária</th>[m
[31m-                    <th>Contribuição Primária Corrigida</th>[m
[31m-                    <th>Contribuição Secundária Corrigida</th>[m
[31m-                    <th>Limite</th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-              </sa-datatable>[m
[31m-            </div>[m
[31m-            <div class="widget-body" *ngIf="!isUpdating && errosCalculo98_99.length == 0">[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Índice de reajuste no teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.indice_reajuste_teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.total_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.media_contribuicoes_primarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.divisor_calculo_media}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Total das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.total_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições secundárias:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.media_contribuicoes_secundarias}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.divisor_calculo_media_secundaria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Coeficiente:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.coeficiente}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.media_contribuicoes}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Salário Mínimo:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.salario_minimo}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Teto:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.teto}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.renda_mensal_inicial}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial na DIB:</span>[m
[31m-                    </td>[m
[31m-                    <td width="50%">{{conclusoes98_99.renda_mensal_inicial_data_dib}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-              </table>[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Opções do Cálculo A partir de 29/11/1999-->[m
[31m-      <article class="container-fluid" *ngIf="mostrarCalculoApos99">[m
[31m-        <table class="table table-hover table-bordered">[m
[31m-          <thead>[m
[31m-            <tr>[m
[31m-              <th>[m
[31m-                Cálculo nº: 347[m
[31m-              </th>[m
[31m-              <th>[m
[31m-                Ação[m
[31m-              </th>[m
[31m-            </tr>[m
[31m-          </thead>[m
[31m-          <tbody>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Exportar para o cálculo de Benefícios Atrasados - Teto 12/98 e 12/2003</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-link"></i>[m
[31m-                  </span> EXPORTAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Mostrar Reajustes Administrativos</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-eye"></i>[m
[31m-                  </span> MOSTRAR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-            <tr>[m
[31m-              <td>[m
[31m-                <p>Imprimir o cálculo</p>[m
[31m-              </td>[m
[31m-              <td>[m
[31m-                <button type="submit" class="btn btn-labeled btn-primary pull-right">[m
[31m-                  <span class="btn-label">[m
[31m-                    <i class="fa fa-print"></i>[m
[31m-                  </span> IMPRIMIR[m
[31m-                </button>[m
[31m-              </td>[m
[31m-            </tr>[m
[31m-          </tbody>[m
[31m-        </table>[m
[31m-      </article>[m
[31m-[m
[31m-      <!-- Tabela e Informações do Cálculo A partir de 29/11/1999 -->[m
[31m-      <article class="col-sm-12 col-md-12 col-lg-12" *ngIf="mostrarCalculoApos99">[m
[31m-        <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-          <header>[m
[31m-            <span class="widget-icon">[m
[31m-              <i class="fa fa-edit"></i>[m
[31m-            </span>[m
[31m-            <h2>{{calculo.tipo_seguro}} A partir de 29/11/1999</h2>[m
[31m-          </header>[m
[31m-          <div>[m
[31m-            <div class="widget-body">[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr>[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">Espécie:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_seguro}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Período para o início do benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.tipo_aposentadoria}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Início do Benefício:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{calculo.data_pedido_beneficio}}</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoPrimaria99.anos}} ano(s), {{contribuicaoPrimaria99.meses}} mês(es) e {{contribuicaoPrimaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Contribuição secundária:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{contribuicaoSecundaria99.anos}} ano(s), {{contribuicaoSecundaria99.meses}} mês(es) e {{contribuicaoSecundaria99.dias}} dia(s)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Data de Criação:</span>[m
[31m-                    </td>[m
[31m-                    <td>{{formatReceivedDate(calculo.data_calculo)}}</td>[m
[31m-                  </tr>[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-              <div class="alert alert-warning margin-top-10" *ngFor="let erro of errosCalculoApos99" role="alert">[m
[31m-                <p>{{erro}}</p>[m
[31m-              </div>[m
[31m-              <sa-widget [colorbutton]="false" [editbutton]="false">[m
[31m-                <div>[m
[31m-                  <div class="widget-body no-padding">[m
[31m-                    <sa-datatable [options]="calculoApos99TableOptions"[m
[31m-                      paginationLength="true" *ngIf="!isUpdating" tableClass="table table-striped table-bordered table-hover" width="100%">[m
[31m-                      <thead>[m
[31m-                        <tr>[m
[31m-                          <th>#</th>[m
[31m-                          <th>Competência</th>[m
[31m-                          <!-- <th>Índice</th> TODO -->[m
[31m-                          <th>Índice</th>[m
[31m-                          <th>Contribuição Primária</th>[m
[31m-                          <th>Contribuição Secundária</th>[m
[31m-                          <th>Contribuição Primária Corrigida</th>[m
[31m-                          <th>Contribuição Secundária Corrigida</th>[m
[31m-                          <th>Observação</th>[m
[31m-                        </tr>[m
[31m-                      </thead>[m
[31m-                    </sa-datatable>[m
[31m-                  </div>[m
[31m-                </div>[m
[31m-              </sa-widget>[m
[31m-[m
[31m-              <table class="table table-bordered table-hover">[m
[31m-                <thead>[m
[31m-                  <tr>[m
[31m-                    <th>[m
[31m-                      Tipo[m
[31m-                    </th>[m
[31m-                    <th>[m
[31m-                      Descrição[m
[31m-                    </th>[m
[31m-                  </tr>[m
[31m-                </thead>[m
[31m-                <tbody>[m
[31m-                  <tr *ngFor="let conclusao of conclusoesApos99">[m
[31m-                    <td width="50%">[m
[31m-                      <span class="pull-right font-bold">{{conclusao.string}}</span>[m
[31m-                    </td>[m
[31m-                    <td>{{conclusao.value}}</td>[m
[31m-                  </tr>[m
[31m-                  <!-- <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Soma das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td>R$ 790.293,52</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Divisor do cálculo da média primária:</span>[m
[31m-                    </td>[m
[31m-                    <td>197</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Média das contribuições primárias:</span>[m
[31m-                    </td>[m
[31m-                    <td>R$ 4.011,64</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Idade em anos:</span>[m
[31m-                    </td>[m
[31m-                    <td>55(55,52)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Média das contribuições:</span>[m
[31m-                    </td>[m
[31m-                    <td>R$ 4.011,64</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">CT - Número de competências transcorridas desde 29/11/1999: </span>[m
[31m-                    </td>[m
[31m-                    <td>60</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Fórmula Fator:</span>[m
[31m-                    </td>[m
[31m-                    <td>((38,6493 * 0,31) / 26,2) * (1 + (55,52 + (38,6493 * 0,31)) / 100)</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Fp - Fator Previdenciario:</span>[m
[31m-                    </td>[m
[31m-                    <td>0,766 - <strong>Não tem direito a Regra 85/95</strong></td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Índice de reajuste no teto:</span>[m
[31m-                    </td>[m
[31m-                    <td>1</td>[m
[31m-                  </tr>[m
[31m-                  <tr>[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Expectativa de Sobrevida:</span>[m
[31m-                    </td>[m
[31m-                    <td>26,2</td>[m
[31m-                  </tr>[m
[31m-                  <tr class="success">[m
[31m-                    <td>[m
[31m-                      <span class="pull-right font-bold">Renda Mensal Inicial com Fator Previdenciario:</span>[m
[31m-                    </td>[m
[31m-                    <td><strong class="text-success">R$ 3.072,86</strong></td>[m
[31m-                  </tr> -->[m
[31m-                </tbody>[m
[31m-[m
[31m-              </table>[m
[31m-[m
[31m-[m
[31m-            </div>[m
[31m-          </div>[m
[31m-        </sa-widget>[m
[31m-      </article>[m
[32m+[m[32m      <app-rgps-resultados-anterior88 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      [isBlackHole]="isBlackHole" *ngIf="mostrarCalculoAnterior88"></app-rgps-resultados-anterior88>[m
[32m+[m
[32m+[m[32m      <app-rgps-resultados-entre91e98 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      [tipoCalculo]="'91_98'"[m
[32m+[m[32m      *ngIf="mostrarCalculo91_98"></app-rgps-resultados-entre91e98>[m
[32m+[m
[32m+[m[32m      <app-rgps-resultados-entre91e98 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      [tipoCalculo]="'98_99'"[m
[32m+[m[32m      *ngIf="mostrarCalculo98_99"></app-rgps-resultados-entre91e98>[m
[32m+[m
[32m+[m[32m      <app-rgps-resultados-apos99 [calculo]="calculo"[m
[32m+[m[32m      [segurado]="segurado"[m
[32m+[m[32m      *ngIf="mostrarCalculoApos99"></app-rgps-resultados-apos99>[m
 [m
     </div>[m
 [m
[1mdiff --git a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts[m
[1mindex c5a6561..9f744ca 100644[m
[1m--- a/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts[m
[1m+++ b/src/app/+rgps/+rgps-resultados/rgps-resultados.component.ts[m
[36m@@ -263,13 +263,7 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     private route: ActivatedRoute,[m
     protected Segurado: SeguradoService,    [m
     protected CalculoRgps: CalculoRgpsService,[m
[31m-    protected ValoresContribuidos: ValorContribuidoService,[m
[31m-    private Moeda: MoedaService,[m
[31m-    private IndiceInps: IndiceInpsService,[m
[31m-    private SalarioMinimoMaximo: SalarioMinimoMaximoService,[m
[31m-    private CarenciaProgressiva:CarenciaProgressivaService,[m
[31m-    private ReajusteAutomatico:ReajusteAutomaticoService,[m
[31m-    private ExpectativaVida: ExpectativaVidaService,) {}[m
[32m+[m[32m  ) {}[m
 [m
   ngOnInit() {[m
   	this.idSegurado = this.route.snapshot.params['id_segurado'];[m
[36m@@ -286,303 +280,226 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
           .then(calculo => {[m
             this.calculo = calculo;[m
 [m
[31m-            this.tipoBeneficio = this.getEspecieBeneficio();[m
[32m+[m[32m            this.tipoBeneficio = this.getEspecieBeneficio(this.calculo);[m
             this.dataInicioBeneficio = moment(this.calculo.data_pedido_beneficio, 'DD/MM/YYYY');[m
[31m-            let dataInicio = this.getDataInicio();[m
[31m-            let dataLimite = this.getDataLimite(dataInicio);[m
             this.preencheGrupoDeCalculos();[m
             this.controleExibicao()[m
[31m-            this.CarenciaProgressiva.getCarencias()[m
[31m-              .then(carencias => {[m
[31m-                this.carenciasProgressivas = carencias;[m
[31m-              [m
[31m-                this.ValoresContribuidos.getByCalculoId(this.idCalculo, dataInicio, dataLimite)[m
[31m-                  .then(valorescontribuidos => {[m
[31m-                    this.listaValoresContribuidos = valorescontribuidos;[m
[31m-                    this.primeiraDataTabela = moment(this.listaValoresContribuidos[this.listaValoresContribuidos.length - 1].data);[m
[31m-                    this.Moeda.getByDateRange(this.primeiraDataTabela, moment())[m
[31m-                      .then((moeda: Moeda[]) => {[m
[31m-                        this.moeda = moeda;[m
[31m-    [m
[31m-                        if(this.dataInicioBeneficio < moment('1991-04-04')){[m
[31m-                          this.IndiceInps.getByDate(this.dataInicioBeneficio.clone().startOf('month'))[m
[31m-                            .then(indices => {[m
[31m-                              this.inpsList = indices;[m
[31m-                              this.SalarioMinimoMaximo.getByDate((this.dataInicioBeneficio.clone()).startOf('month'))[m
[31m-                                .then(salario => {[m
[31m-                                  this.salarioMinimoMaximo = salario[0];[m
[31m-                                  this.contribuicaoPrimariaAnterior88 = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[31m-                                  this.contribuicaoSecundariaAnterior88 = this.getContribuicaoObj(this.calculo.contribuicao_secundaria_98);[m
[31m-                                  this.calculoAnterior88(this.conclusoesAnterior88);[m
[31m-                                  [m
[31m-                                  if(this.calculo.tipo_aposentadoria == 'Entre 05/10/1988 e 04/04/1991'){[m
[31m-                                    this.ReajusteAutomatico.getByDate(this.dataDib98, this.dataInicioBeneficio)[m
[31m-                                      .then(reajustes => {[m
[31m-                                        this.reajustesAutomaticos = reajustes;[m
[31m-                                        this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                        this.isUpdating = false;[m
[31m-                                    });[m
[31m-                                  }[m
[31m-                                  this.isUpdating = false;[m
[31m-                                });[m
[31m-                            });[m
[31m-                        }[m
[31m-                        let dataReajustesAutomaticos = this.dataInicioBeneficio;[m
[31m-                        if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-                          dataReajustesAutomaticos = this.dataDib98;[m
[31m-                        }else if(this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999'){[m
[31m-                          dataReajustesAutomaticos = this.dataDib99;[m
[31m-                        }[m
[31m-                        if(this.dataInicioBeneficio >= moment('1991-04-04') && this.dataInicioBeneficio < moment('1999-11-29')){[m
[31m-                          this.ReajusteAutomatico.getByDate(dataReajustesAutomaticos, this.dataInicioBeneficio)[m
[31m-                            .then(reajustes => {[m
[31m-                              this.reajustesAutomaticos = reajustes;[m
[31m-                              if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-                                this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                this.isUpdating = false;[m
[31m-                              }[m
[31m-                              if(this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999'){[m
[31m-                                //entre 98 e 99 ( = entre 91 e 98) (tempo de contribuicao até a lei 99)(cálculos realizados em box separados)[m
[31m-                                this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                this.calculo91_98(this.errosCalculo98_99, this.conclusoes98_99, this.contribuicaoPrimaria99, this.contribuicaoSecundaria99, '98_99');[m
[31m-                                this.isUpdating = false;[m
[31m-                              }[m
[31m-                          });[m
[31m-                        }[m
[31m-    [m
[31m-                        if(this.dataInicioBeneficio >= moment('1999-11-29')){[m
[31m-                          this.ReajusteAutomatico.getByDate(dataReajustesAutomaticos, this.dataInicioBeneficio)[m
[31m-                            .then(reajustes => {[m
[31m-                              this.reajustesAutomaticos = reajustes;[m
[31m-                              [m
[31m-                            this.ExpectativaVida.getByIdade(Math.floor(this.idadeFracionada))[m
[31m-                              .then(expectativas => {[m
[31m-                                this.expectativasVida = expectativas;[m
[31m-                                this.calculo91_98(this.errosCalculo91_98, this.conclusoes91_98, this.contribuicaoPrimaria91_98, this.contribuicaoSecundaria91_98, '91_98');[m
[31m-                                this.calculo91_98(this.errosCalculo98_99, this.conclusoes98_99, this.contribuicaoPrimaria99, this.contribuicaoSecundaria99, '98_99');[m
[31m-                                this.calculo_apos_99(this.errosCalculoApos99, this.conclusoesApos99, this.contribuicaoPrimaria99, this.contribuicaoSecundaria99);[m
[31m-                                this.isUpdating = false; [m
[31m-                            });[m
[31m-                          });[m
[31m-                        }[m
[31m-                      });[m
[31m-                  });[m
[31m-              });[m
[31m-          });[m
[31m-      });[m
[31m-  }[m
[31m-[m
[31m-  verificaErrosAnterior88(){[m
[31m-    let erro = "";[m
[31m-    let anoContribuicaoPrimariaAnterior88 = this.contribuicaoPrimariaAnterior88.anos;[m
[31m-    if ((this.calculo.tipo_seguro == "Aposentadoria por Idade (Rural)" ||[m
[31m-         this.calculo.tipo_seguro == "Aposentadoria por idade (Urbano)") && this.calculo.carencia < 60){[m
[31m-      erro = "Falta(m) "+ (60 - this.calculo.carencia) + " mês(es) para a carencia necessária.";[m
[31m-    }else if(this.segurado.sexo == 'h' && this.idadeSegurado < 65 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[31m-      erro = "O segurado não tem a idade mínima (65 anos) para se aposentar por idade. Falta(m) " + (65 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[31m-    }else if(this.segurado.sexo == 'm' && this.idadeSegurado < 60 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[31m-      erro = "O segurado não tem a idade mínima (60 anos) para se aposentar por idade. Falta(m) " + (60 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[31m-    }else if(this.calculo.tipo_seguro == "Aposentadoria por tempo de serviço" && [m
[31m-             anoContribuicaoPrimariaAnterior88 < 30){[m
[31m-      //TODO: Colocar mensagem completa :[m
[31m-      //Falta(m) "quantidade de anos que faltam" ano(s), "Quantidade de meses que faltam" mês(es) e quantidade de dia(s) para completar o tempo de serviço necessário.[m
[31m-      erro = "Erro no tempo de contibuição";[m
[31m-    }else if (this.listaValoresContribuidos.length == 0){[m
[31m-      erro = "Nenhuma contribuição encontrada em até 48 meses para este cálculo <a href='http://www.ieprev.com.br/legislacao/4506/decreto-no-83.080,-de-24-1-1979' target='_blank'>Art. 37 da Decreto nº 83.080, de 24/01/1979</a>"[m
[31m-    }[m
[31m-    return erro;[m
[32m+[m[32m            this.isUpdating = false;[m
[32m+[m[32m        });[m
[32m+[m[32m    });[m
   }[m
 [m
[31m-  calculoAnterior88(conclusoes){[m
[31m-    let index = 0;[m
[31m-    let mesPrimario = 0;[m
[31m-    let mesSecundario = 0;[m
[31m-    let tableData = [];[m
[31m-    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-    let totalPrimario = 0;[m
[31m-    let totalSecundario = 0;[m
[31m-    let anoPrimario = this.contribuicaoPrimariaAnterior88.anos;[m
[31m-    let anoSecundario = this.contribuicaoSecundariaAnterior88.anos;[m
[31m-[m
[31m-    for(let contribuicao of this.listaValoresContribuidos){[m
[31m-      let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[31m-      let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[31m-      let dataContribuicao = moment(contribuicao.data);[m
[31m-      let currency = this.loadCurrency(dataContribuicao);[m
[31m-[m
[31m-      if(valorSecundario){[m
[31m-        mesSecundario++;[m
[31m-      }else{[m
[31m-        valorSecundario = 0;[m
[31m-      }[m
[32m+[m[32m //  verificaErrosAnterior88(){[m
[32m+[m[32m //    let erro = "";[m
[32m+[m[32m //    let anoContribuicaoPrimariaAnterior88 = this.contribuicaoPrimariaAnterior88.anos;[m
[32m+[m[32m //    if ((this.calculo.tipo_seguro == "Aposentadoria por Idade (Rural)" ||[m
[32m+[m[32m //         this.calculo.tipo_seguro == "Aposentadoria por idade (Urbano)") && this.calculo.carencia < 60){[m
[32m+[m[32m //      erro = "Falta(m) "+ (60 - this.calculo.carencia) + " mês(es) para a carencia necessária.";[m
[32m+[m[32m //    }else if(this.segurado.sexo == 'h' && this.idadeSegurado < 65 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[32m+[m[32m //      erro = "O segurado não tem a idade mínima (65 anos) para se aposentar por idade. Falta(m) " + (65 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[32m+[m[32m //    }else if(this.segurado.sexo == 'm' && this.idadeSegurado < 60 && (this.tipoBeneficio == 3 || this.tipoBeneficio == 16)){[m
[32m+[m[32m //      erro = "O segurado não tem a idade mínima (60 anos) para se aposentar por idade. Falta(m) " + (60 - this.idadeSegurado) + " ano(s) para atingir a idade mínima."[m
[32m+[m[32m //    }else if(this.calculo.tipo_seguro == "Aposentadoria por tempo de serviço" &&[m[41m [m
[32m+[m[32m //             anoContribuicaoPrimariaAnterior88 < 30){[m
[32m+[m[32m //      //TODO: Colocar mensagem completa :[m
[32m+[m[32m //      //Falta(m) "quantidade de anos que faltam" ano(s), "Quantidade de meses que faltam" mês(es) e quantidade de dia(s) para completar o tempo de serviço necessário.[m
[32m+[m[32m //      erro = "Erro no tempo de contibuição";[m
[32m+[m[32m //    }else if (this.listaValoresContribuidos.length == 0){[m
[32m+[m[32m //      erro = "Nenhuma contribuição encontrada em até 48 meses para este cálculo <a href='http://www.ieprev.com.br/legislacao/4506/decreto-no-83.080,-de-24-1-1979' target='_blank'>Art. 37 da Decreto nº 83.080, de 24/01/1979</a>"[m
[32m+[m[32m //    }[m
[32m+[m[32m //    return erro;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  calculoAnterior88(conclusoes){[m
[32m+[m[32m //    let index = 0;[m
[32m+[m[32m //    let mesPrimario = 0;[m
[32m+[m[32m //    let mesSecundario = 0;[m
[32m+[m[32m //    let tableData = [];[m
[32m+[m[32m //    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m //    let totalPrimario = 0;[m
[32m+[m[32m //    let totalSecundario = 0;[m
[32m+[m[32m //    let anoPrimario = this.contribuicaoPrimariaAnterior88.anos;[m
[32m+[m[32m //    let anoSecundario = this.contribuicaoSecundariaAnterior88.anos;[m
[32m+[m
[32m+[m[32m //    for(let contribuicao of this.listaValoresContribuidos){[m
[32m+[m[32m //      let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[32m+[m[32m //      let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[32m+[m[32m //      let dataContribuicao = moment(contribuicao.data);[m
[32m+[m[32m //      let currency = this.loadCurrency(dataContribuicao);[m
[32m+[m
[32m+[m[32m //      if(valorSecundario){[m
[32m+[m[32m //        mesSecundario++;[m
[32m+[m[32m //      }else{[m
[32m+[m[32m //        valorSecundario = 0;[m
[32m+[m[32m //      }[m
       [m
[31m-      let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[31m-      let contribuicaoSecundariaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currency.acronimo) : "";[m
[31m-      let inps = this.getInps(dataContribuicao.year());[m
[31m-[m
[31m-      let valorAjustadoObj = this.limitarTetosEMinimos(valorPrimario, dataContribuicao);[m
[31m-      valorPrimario = valorAjustadoObj.valor;[m
[31m-      let limiteString = valorAjustadoObj.aviso;[m
[31m-[m
[31m-      if (index > 11 && inps != null) {[m
[31m-        valorPrimario *= inps;[m
[31m-      }[m
[31m-      valorPrimario = this.convertCurrency(valorPrimario, dataContribuicao, this.dataInicioBeneficio);[m
[31m-        if (valorSecundario > 0){[m
[31m-        valorSecundario = (this.limitarTetosEMinimos(valorSecundario, dataContribuicao)).valor;[m
[31m-      }[m
[31m-[m
[31m-      if (index > 11 && inps != null) {[m
[31m-        valorSecundario *= inps;[m
[31m-      }[m
[31m-      valorSecundario = this.convertCurrency(valorSecundario, dataContribuicao, this.dataInicioBeneficio);[m
[31m-      totalPrimario += valorPrimario;[m
[31m-      totalSecundario += valorSecundario;[m
[31m-      let inpsString = '';[m
[31m-      if(index > 11 && inps != null){[m
[31m-        inpsString = inps;[m
[31m-      }else{[m
[31m-        inpsString  = '1.00';[m
[31m-      }[m
[31m-      let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimario, currencyDataInicioBeneficio.acronimo);[m
[31m-      let contribuicaoSecundariaRevisadaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currencyDataInicioBeneficio.acronimo) : '';[m
[31m-      let line = {competencia: dataContribuicao.format('MM/YYYY'),[m
[31m-              contribuicao_primaria: contribuicaoPrimariaString,[m
[31m-              contribuicao_secundaria: contribuicaoSecundariaString,[m
[31m-              inps: this.formatDecimal(inpsString,2),[m
[31m-              contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[31m-              contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[31m-              limite: limiteString};[m
[31m-      tableData.push(line);[m
[31m-      index++;[m
[31m-    }[m
[31m-    let somaContribuicoes = totalPrimario + totalSecundario;[m
[31m-    let mediaContribuicoesPrimaria = totalPrimario / index;[m
[31m-    let mediaContribuicoesSecundaria = 0;[m
[31m-    if(totalSecundario > 0){[m
[31m-      if((this.tipoBeneficio == 4 || this.tipoBeneficio == 6) && anoSecundario != 0 && mesSecundario != 0){[m
[31m-        mediaContribuicoesSecundaria = totalSecundario / (mesSecundario) * (anoSecundario / 30.0);[m
[31m-      }else if(anoSecundario != 0 && mesSecundario != 0){[m
[31m-        let lackAux = 0;[m
[31m-        if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[31m-          lackAux = 12;[m
[31m-        } else {[m
[31m-          lackAux = 60;[m
[31m-        }[m
[31m-        mediaContribuicoesSecundaria = totalSecundario * (mesSecundario / lackAux); [m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    let mediaTotal = mediaContribuicoesPrimaria + mediaContribuicoesSecundaria;[m
[31m-    let rmi = this.calculateRMI(mediaTotal,somaContribuicoes, conclusoes);[m
[31m-[m
[31m-    // Exibir as conclusões:[m
[31m-    conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimario, currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimaria, currencyDataInicioBeneficio.acronimo);[m
[31m-    if(totalSecundario > 0){[m
[31m-      conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundario, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaContribuicoesSecundaria, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.divisor_calculo_media_secundaria = mesSecundario;[m
[31m-    }[m
[31m-    conclusoes.divisor_calculo_media = index;[m
[31m-    conclusoes.media_contribuicoes = this.formatMoney(mediaTotal,currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currencyDataInicioBeneficio.acronimo);[m
[31m-[m
[31m-    this.calculoAnterior88TableData = tableData;[m
[31m-    this.calculoAnterior88TableOptions = {[m
[31m-      ...this.calculoAnterior88TableOptions,[m
[31m-      data: this.calculoAnterior88TableData,[m
[31m-    }[m
[31m-  }[m
[31m-[m
[31m-  calculateRMI(mediaTotal, somaContribuicoes, conclusoes){[m
[31m-    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-    let dataSalario = (this.dataInicioBeneficio.clone()).startOf('month');[m
[31m-    //let dataSalarioMoedaIndex = this.getIndex(dataSalario);[m
[31m-    let limitesSalariais = this.getLimitesSalariais(dataSalario);[m
[31m-    let grupoDos12 = this.calculo.grupo_dos_12;[m
[31m-[m
[31m-    conclusoes.maior_valor_teto = this.formatMoney(limitesSalariais.maximo, currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.menor_valor_teto = this.formatMoney(limitesSalariais.minimo, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[32m+[m[32m //      let contribuicaoSecundariaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currency.acronimo) : "";[m
[32m+[m[32m //      let inps = this.getInps(dataContribuicao.year());[m
[32m+[m
[32m+[m[32m //      let valorAjustadoObj = this.limitarTetosEMinimos(valorPrimario, dataContribuicao);[m
[32m+[m[32m //      valorPrimario = valorAjustadoObj.valor;[m
[32m+[m[32m //      let limiteString = valorAjustadoObj.aviso;[m
[32m+[m
[32m+[m[32m //      if (index > 11 && inps != null) {[m
[32m+[m[32m //        valorPrimario *= inps;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      valorPrimario = this.convertCurrency(valorPrimario, dataContribuicao, this.dataInicioBeneficio);[m
[32m+[m[32m //        if (valorSecundario > 0){[m
[32m+[m[32m //        valorSecundario = (this.limitarTetosEMinimos(valorSecundario, dataContribuicao)).valor;[m
[32m+[m[32m //      }[m
[32m+[m
[32m+[m[32m //      if (index > 11 && inps != null) {[m
[32m+[m[32m //        valorSecundario *= inps;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      valorSecundario = this.convertCurrency(valorSecundario, dataContribuicao, this.dataInicioBeneficio);[m
[32m+[m[32m //      totalPrimario += valorPrimario;[m
[32m+[m[32m //      totalSecundario += valorSecundario;[m
[32m+[m[32m //      let inpsString = '';[m
[32m+[m[32m //      if(index > 11 && inps != null){[m
[32m+[m[32m //        inpsString = inps;[m
[32m+[m[32m //      }else{[m
[32m+[m[32m //        inpsString  = '1.00';[m
[32m+[m[32m //      }[m
[32m+[m[32m //      let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimario, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      let contribuicaoSecundariaRevisadaString = (!this.isBlackHole) ? this.formatMoney(valorSecundario, currencyDataInicioBeneficio.acronimo) : '';[m
[32m+[m[32m //      let line = {competencia: dataContribuicao.format('MM/YYYY'),[m
[32m+[m[32m //              contribuicao_primaria: contribuicaoPrimariaString,[m
[32m+[m[32m //              contribuicao_secundaria: contribuicaoSecundariaString,[m
[32m+[m[32m //              inps: this.formatDecimal(inpsString,2),[m
[32m+[m[32m //              contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[32m+[m[32m //              contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[32m+[m[32m //              limite: limiteString};[m
[32m+[m[32m //      tableData.push(line);[m
[32m+[m[32m //      index++;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    let somaContribuicoes = totalPrimario + totalSecundario;[m
[32m+[m[32m //    let mediaContribuicoesPrimaria = totalPrimario / index;[m
[32m+[m[32m //    let mediaContribuicoesSecundaria = 0;[m
[32m+[m[32m //    if(totalSecundario > 0){[m
[32m+[m[32m //      if((this.tipoBeneficio == 4 || this.tipoBeneficio == 6) && anoSecundario != 0 && mesSecundario != 0){[m
[32m+[m[32m //        mediaContribuicoesSecundaria = totalSecundario / (mesSecundario) * (anoSecundario / 30.0);[m
[32m+[m[32m //      }else if(anoSecundario != 0 && mesSecundario != 0){[m
[32m+[m[32m //        let lackAux = 0;[m
[32m+[m[32m //        if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[32m+[m[32m //          lackAux = 12;[m
[32m+[m[32m //        } else {[m
[32m+[m[32m //          lackAux = 60;[m
[32m+[m[32m //        }[m
[32m+[m[32m //        mediaContribuicoesSecundaria = totalSecundario * (mesSecundario / lackAux);[m[41m [m
[32m+[m[32m //      }[m
[32m+[m[32m //    }[m
[32m+[m
[32m+[m[32m //    let mediaTotal = mediaContribuicoesPrimaria + mediaContribuicoesSecundaria;[m
[32m+[m[32m //    let rmi = this.calculateRMI(mediaTotal,somaContribuicoes, conclusoes);[m
[32m+[m
[32m+[m[32m //    // Exibir as conclusões:[m
[32m+[m[32m //    conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimario, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimaria, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    if(totalSecundario > 0){[m
[32m+[m[32m //      conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundario, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaContribuicoesSecundaria, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.divisor_calculo_media_secundaria = mesSecundario;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    conclusoes.divisor_calculo_media = index;[m
[32m+[m[32m //    conclusoes.media_contribuicoes = this.formatMoney(mediaTotal,currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currencyDataInicioBeneficio.acronimo);[m
[32m+[m
[32m+[m[32m //    this.calculoAnterior88TableData = tableData;[m
[32m+[m[32m //    this.calculoAnterior88TableOptions = {[m
[32m+[m[32m //      ...this.calculoAnterior88TableOptions,[m
[32m+[m[32m //      data: this.calculoAnterior88TableData,[m
[32m+[m[32m //    }[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  calculateRMI(mediaTotal, somaContribuicoes, conclusoes){[m
[32m+[m[32m //    let currencyDataInicioBeneficio = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m //    let dataSalario = (this.dataInicioBeneficio.clone()).startOf('month');[m
[32m+[m[32m //    //let dataSalarioMoedaIndex = this.getIndex(dataSalario);[m
[32m+[m[32m //    let limitesSalariais = this.getLimitesSalariais(dataSalario);[m
[32m+[m[32m //    let grupoDos12 = this.calculo.grupo_dos_12;[m
[32m+[m
[32m+[m[32m //    conclusoes.maior_valor_teto = this.formatMoney(limitesSalariais.maximo, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.menor_valor_teto = this.formatMoney(limitesSalariais.minimo, currencyDataInicioBeneficio.acronimo);[m
     [m
[31m-    let anoContribuicao = this.calculo.contribuicao_primaria_98.split('-')[0];[m
[31m-[m
[31m-    let indiceEspecie = this.getIndiceEspecie(this.tipoBeneficio, this.segurado.sexo, anoContribuicao); // Seção 1.1.4[m
[31m-    let rmi = 0;[m
[31m-    if(mediaTotal >= limitesSalariais.minimo) {[m
[31m-      let primeiraParcela = indiceEspecie * limitesSalariais.minimo;[m
[31m-      if(limitesSalariais.maximo <= mediaTotal){[m
[31m-        mediaTotal = limitesSalariais.maximo;[m
[31m-      }[m
[31m-      // Calculo do valor do excedente[m
[31m-      let excedente = mediaTotal - limitesSalariais.minimo;[m
[31m-      let segundaParcela = (grupoDos12 / 30) * excedente;[m
[31m-      if(segundaParcela > (0.8 * excedente)){[m
[31m-        segundaParcela = 0.8 * excedente;[m
[31m-      }[m
[31m-      let somaParcelas = primeiraParcela + segundaParcela;[m
[31m-      if(somaParcelas > (0.9 * limitesSalariais.maximo)){[m
[31m-        rmi = (0.9 * limitesSalariais.maximo);[m
[31m-      }else{[m
[31m-        rmi = somaParcelas;[m
[31m-      }[m
[31m-      //Inserir nas conclusões[m
[31m-      conclusoes.primeira_parcela_rmi = this.formatMoney(primeiraParcela, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.grupo_dos_12 =  grupoDos12;[m
[31m-      conclusoes.valor_excedente = this.formatMoney(excedente, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.segunda_parcela_rmi = this.formatMoney(segundaParcela, currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.oitenta_porcento_valor_excedente = this.formatMoney((0.8 * excedente), currencyDataInicioBeneficio.acronimo);[m
[31m-      conclusoes.noventa_porcento_maior_valor_teto = this.formatMoney((0.9 * limitesSalariais.maximo),currencyDataInicioBeneficio.acronimo) ;[m
[31m-    } else {[m
[31m-      rmi = indiceEspecie * mediaTotal;[m
[31m-    }[m
[31m-[m
[31m-    let indiceSalarioMinimo = this.getIndiceSalarioMinimo(this.tipoBeneficio, anoContribuicao);[m
[31m-    let valorSalarioMinimo = indiceSalarioMinimo * (this.Moeda.getByDate(dataSalario)).salario_minimo;[m
[31m-    if (rmi > (0.95 * mediaTotal)) {[m
[31m-        rmi = 0.95 * mediaTotal;[m
[31m-    } else if (rmi < valorSalarioMinimo) {[m
[31m-        rmi = valorSalarioMinimo;[m
[31m-    }[m
[31m-    conclusoes.porcentagem_calculo_beneficio = indiceEspecie * 100;[m
[31m-    conclusoes.beneficio_minimo_com_indice =  this.formatMoney(valorSalarioMinimo, currencyDataInicioBeneficio.acronimo);[m
[31m-    conclusoes.noventaecinco_porcento_valor_da_media = this.formatMoney((0.95*mediaTotal), currencyDataInicioBeneficio.acronimo);[m
[31m-[m
[31m-    // TODO: Nesse momento Salvar o valor da RMI e da somaContribuições no BD do calculo.[m
[31m-    return rmi;[m
[31m-  }[m
[31m-[m
[31m-  getInps(year){[m
[31m-    if(this.inpsList){[m
[31m-      for(let inps of this.inpsList){[m
[31m-        if(inps.ano == year){[m
[31m-          return inps.valor;[m
[31m-        }[m
[31m-      }[m
[31m-      return null;[m
[31m-    }[m
[31m-    return null;[m
[31m-  }[m
[31m-[m
[31m-  getLimitesSalariais(data){[m
[31m-    let ret = {minimo: this.salarioMinimoMaximo.minimum_salary_ammount, maximo: this.salarioMinimoMaximo.maximum_salary_ammount};[m
[31m-    return ret;[m
[31m-  }[m
[31m-[m
[31m-  getIndiceSalarioMinimo(especie, anoContribuicao){[m
[31m-  	let index = 0.0;[m
[31m-  	if (especie === 1){[m
[31m-  		index = 0.75;[m
[31m-  	} else if ((especie > 1 && especie <= 5) || especie === 16){[m
[31m-  		index = 0.9;[m
[31m-  	} else if (especie === 20){[m
[31m-  		index = 0.25;[m
[31m-  		if (anoContribuicao >= 30 && anoContribuicao < 35){[m
[31m-        index = 0.2;[m
[31m-      }[m
[31m-  	}[m
[31m-    return index;[m
[31m-	}[m
[32m+[m[32m //    let anoContribuicao = this.calculo.contribuicao_primaria_98.split('-')[0];[m
[32m+[m
[32m+[m[32m //    let indiceEspecie = this.getIndiceEspecie(this.tipoBeneficio, this.segurado.sexo, anoContribuicao); // Seção 1.1.4[m
[32m+[m[32m //    let rmi = 0;[m
[32m+[m[32m //    if(mediaTotal >= limitesSalariais.minimo) {[m
[32m+[m[32m //      let primeiraParcela = indiceEspecie * limitesSalariais.minimo;[m
[32m+[m[32m //      if(limitesSalariais.maximo <= mediaTotal){[m
[32m+[m[32m //        mediaTotal = limitesSalariais.maximo;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      // Calculo do valor do excedente[m
[32m+[m[32m //      let excedente = mediaTotal - limitesSalariais.minimo;[m
[32m+[m[32m //      let segundaParcela = (grupoDos12 / 30) * excedente;[m
[32m+[m[32m //      if(segundaParcela > (0.8 * excedente)){[m
[32m+[m[32m //        segundaParcela = 0.8 * excedente;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      let somaParcelas = primeiraParcela + segundaParcela;[m
[32m+[m[32m //      if(somaParcelas > (0.9 * limitesSalariais.maximo)){[m
[32m+[m[32m //        rmi = (0.9 * limitesSalariais.maximo);[m
[32m+[m[32m //      }else{[m
[32m+[m[32m //        rmi = somaParcelas;[m
[32m+[m[32m //      }[m
[32m+[m[32m //      //Inserir nas conclusões[m
[32m+[m[32m //      conclusoes.primeira_parcela_rmi = this.formatMoney(primeiraParcela, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.grupo_dos_12 =  grupoDos12;[m
[32m+[m[32m //      conclusoes.valor_excedente = this.formatMoney(excedente, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.segunda_parcela_rmi = this.formatMoney(segundaParcela, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.oitenta_porcento_valor_excedente = this.formatMoney((0.8 * excedente), currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //      conclusoes.noventa_porcento_maior_valor_teto = this.formatMoney((0.9 * limitesSalariais.maximo),currencyDataInicioBeneficio.acronimo) ;[m
[32m+[m[32m //    } else {[m
[32m+[m[32m //      rmi = indiceEspecie * mediaTotal;[m
[32m+[m[32m //    }[m
[32m+[m
[32m+[m[32m //    let indiceSalarioMinimo = this.getIndiceSalarioMinimo(this.tipoBeneficio, anoContribuicao);[m
[32m+[m[32m //    let valorSalarioMinimo = indiceSalarioMinimo * (this.Moeda.getByDate(dataSalario)).salario_minimo;[m
[32m+[m[32m //    if (rmi > (0.95 * mediaTotal)) {[m
[32m+[m[32m //        rmi = 0.95 * mediaTotal;[m
[32m+[m[32m //    } else if (rmi < valorSalarioMinimo) {[m
[32m+[m[32m //        rmi = valorSalarioMinimo;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    conclusoes.porcentagem_calculo_beneficio = indiceEspecie * 100;[m
[32m+[m[32m //    conclusoes.beneficio_minimo_com_indice =  this.formatMoney(valorSalarioMinimo, currencyDataInicioBeneficio.acronimo);[m
[32m+[m[32m //    conclusoes.noventaecinco_porcento_valor_da_media = this.formatMoney((0.95*mediaTotal), currencyDataInicioBeneficio.acronimo);[m
[32m+[m
[32m+[m[32m //    // TODO: Nesse momento Salvar o valor da RMI e da somaContribuições no BD do calculo.[m
[32m+[m[32m //    return rmi;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  getInps(year){[m
[32m+[m[32m //    if(this.inpsList){[m
[32m+[m[32m //      for(let inps of this.inpsList){[m
[32m+[m[32m //        if(inps.ano == year){[m
[32m+[m[32m //          return inps.valor;[m
[32m+[m[32m //        }[m
[32m+[m[32m //      }[m
[32m+[m[32m //      return null;[m
[32m+[m[32m //    }[m
[32m+[m[32m //    return null;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  getLimitesSalariais(data){[m
[32m+[m[32m //    let ret = {minimo: this.salarioMinimoMaximo.minimum_salary_ammount, maximo: this.salarioMinimoMaximo.maximum_salary_ammount};[m
[32m+[m[32m //    return ret;[m
[32m+[m[32m //  }[m
[32m+[m
[32m+[m[32m //  getIndiceSalarioMinimo(especie, anoContribuicao){[m
[32m+[m[32m //  	let index = 0.0;[m
[32m+[m[32m //  	if (especie === 1){[m
[32m+[m[32m //  		index = 0.75;[m
[32m+[m[32m //  	} else if ((especie > 1 && especie <= 5) || especie === 16){[m
[32m+[m[32m //  		index = 0.9;[m
[32m+[m[32m //  	} else if (especie === 20){[m
[32m+[m[32m //  		index = 0.25;[m
[32m+[m[32m //  		if (anoContribuicao >= 30 && anoContribuicao < 35){[m
[32m+[m[32m //        index = 0.2;[m
[32m+[m[32m //      }[m
[32m+[m[32m //  	}[m
[32m+[m[32m //    return index;[m
[32m+[m	[32m// }[m
 [m
   loadCurrency(data){[m
     for(let currency of this.currencyList){[m
[36m@@ -594,345 +511,345 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     }[m
   }[m
 [m
[31m-  calculo91_98(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria, periodo){[m
[31m-    let dib = this.dataInicioBeneficio;[m
[31m-    let dibCurrency = this.loadCurrency(dib);[m
[31m-[m
[31m-    if (this.calculo.tipoAposentadoria == 'Entre 16/12/1998 e 28/11/1999' && [m
[31m-        this.dataInicioBeneficio > this.dataDib99) {[m
[31m-        dib = this.dataDib99;[m
[31m-    }[m
[31m-    if (this.calculo.tipoAposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[31m-        this.dataInicioBeneficio > this.dataDib98) {[m
[31m-        dib = this.dataDib98;[m
[31m-    }[m
[31m-[m
[31m-    let dataComparacao = (dib.clone()).startOf('month');[m
[31m-    let reajustesAdministrativos = true;[m
[31m-    if (reajustesAdministrativos) { // Definir tal booleano, a principio sempre true[m
[31m-      dataComparacao = (this.dataInicioBeneficio.clone()).startOf('month');[m
[31m-    }[m
[31m-[m
[31m-    let dibPrimeiro = (dib.clone()).startOf('month');[m
[31m-[m
[31m-    let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[31m-    let moedaDIB = this.Moeda.getByDate(dib);[m
[31m-[m
[31m-    if(this.listaValoresContribuidos.length == 0) {[m
[31m-      // Exibir MSG de erro e encerrar Cálculo.[m
[31m-      errorArray.push("Nenhuma contribuição encontrada em 48 meses anteriores a DIB conforme" + "http://www.ieprev.com.br/legislacao/10634/lei-no-8.213,-de-24-7-1991---atualizada-ate-dezembro-2008#art29' target='_blank'>Art. 29 da Lei nº 8.213, de 24/7/1991");[m
[31m-      return;[m
[31m-    }[m
[31m-[m
[31m-    if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[31m-      return;[m
[31m-    }[m
[31m-    let totalPrimaria = 0;[m
[31m-    let totalSecundaria = 0;[m
[31m-[m
[31m-    let contagemSecundaria = 0;[m
[31m-    let contagemPrimaria = 0;[m
[31m-    let tableData = [];[m
[31m-[m
[31m-    for(let contribuicao of this.listaValoresContribuidos) {[m
[31m-      contagemPrimaria++;[m
[32m+[m[32m  // calculo91_98(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria, periodo){[m
[32m+[m[32m  //   let dib = this.dataInicioBeneficio;[m
[32m+[m[32m  //   let dibCurrency = this.loadCurrency(dib);[m
[32m+[m
[32m+[m[32m  //   if (this.calculo.tipoAposentadoria == 'Entre 16/12/1998 e 28/11/1999' &&[m[41m [m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib99) {[m
[32m+[m[32m  //       dib = this.dataDib99;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   if (this.calculo.tipoAposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib98) {[m
[32m+[m[32m  //       dib = this.dataDib98;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let dataComparacao = (dib.clone()).startOf('month');[m
[32m+[m[32m  //   let reajustesAdministrativos = true;[m
[32m+[m[32m  //   if (reajustesAdministrativos) { // Definir tal booleano, a principio sempre true[m
[32m+[m[32m  //     dataComparacao = (this.dataInicioBeneficio.clone()).startOf('month');[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let dibPrimeiro = (dib.clone()).startOf('month');[m
[32m+[m
[32m+[m[32m  //   let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[32m+[m[32m  //   let moedaDIB = this.Moeda.getByDate(dib);[m
[32m+[m
[32m+[m[32m  //   if(this.listaValoresContribuidos.length == 0) {[m
[32m+[m[32m  //     // Exibir MSG de erro e encerrar Cálculo.[m
[32m+[m[32m  //     errorArray.push("Nenhuma contribuição encontrada em 48 meses anteriores a DIB conforme" + "http://www.ieprev.com.br/legislacao/10634/lei-no-8.213,-de-24-7-1991---atualizada-ate-dezembro-2008#art29' target='_blank'>Art. 29 da Lei nº 8.213, de 24/7/1991");[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   let totalPrimaria = 0;[m
[32m+[m[32m  //   let totalSecundaria = 0;[m
[32m+[m
[32m+[m[32m  //   let contagemSecundaria = 0;[m
[32m+[m[32m  //   let contagemPrimaria = 0;[m
[32m+[m[32m  //   let tableData = [];[m
[32m+[m
[32m+[m[32m  //   for(let contribuicao of this.listaValoresContribuidos) {[m
[32m+[m[32m  //     contagemPrimaria++;[m
       [m
[31m-      let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[31m-      let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[31m-      let dataContribuicao = moment(contribuicao.data);[m
[32m+[m[32m  //     let valorPrimario = parseFloat(contribuicao.valor_primaria);[m
[32m+[m[32m  //     let valorSecundario = parseFloat(contribuicao.valor_secundaria);[m
[32m+[m[32m  //     let dataContribuicao = moment(contribuicao.data);[m
         [m
[31m-      let contribuicaoPrimaria = 0;[m
[32m+[m[32m  //     let contribuicaoPrimaria = 0;[m
         [m
[31m-      if (valorPrimario != null){[m
[31m-        contribuicaoPrimaria = valorPrimario;[m
[31m-      }[m
[32m+[m[32m  //     if (valorPrimario != null){[m
[32m+[m[32m  //       contribuicaoPrimaria = valorPrimario;[m
[32m+[m[32m  //     }[m
 [m
[31m-      let contribuicaoSecundaria = 0;[m
[31m-      if (valorSecundario != null){[m
[31m-        contribuicaoSecundaria = valorSecundario;[m
[31m-      }[m
[32m+[m[32m  //     let contribuicaoSecundaria = 0;[m
[32m+[m[32m  //     if (valorSecundario != null){[m
[32m+[m[32m  //       contribuicaoSecundaria = valorSecundario;[m
[32m+[m[32m  //     }[m
 [m
[31m-      let currency = this.loadCurrency(dataContribuicao); //Definido na seção de algortimos uteis[m
[32m+[m[32m  //     let currency = this.loadCurrency(dataContribuicao); //Definido na seção de algortimos uteis[m
       [m
[31m-      let dataContribuicaoString = dataContribuicao.format('MM/YYYY');[m
[31m-      let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[31m-      let contribuicaoSecundariaString = '';[m
[31m-[m
[31m-      if (!this.isBlackHole){[m
[31m-        contribuicaoSecundariaString = this.formatMoney(valorSecundario, currency.acronimo);[m
[31m-      }[m
[31m-[m
[31m-      let moeda = this.Moeda.getByDate(dataContribuicao);[m
[31m-      let fator = moeda.fator;[m
[31m-      let fatorLimite = moedaComparacao.fator;[m
[31m-      let fatorCorrigido = fator / fatorLimite;[m
[31m-      let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4);[m
[31m-[m
[31m-      let valorPrimarioCorrigido = 0;[m
[31m-      let valorSecundarioCorrigido = 0;[m
[31m-[m
[31m-      let limiteString = '';[m
[31m-      if (contribuicaoPrimaria != 0) {[m
[31m-[m
[31m-        let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[31m-        contribuicaoPrimaria =  valorAjustadoObj.valor;[m
[31m-        limiteString = valorAjustadoObj.aviso;[m
[31m-      }[m
[31m-[m
[31m-      if (contribuicaoSecundaria != 0) {[m
[31m-        contribuicaoSecundaria = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor;[m
[31m-        contagemSecundaria ++;[m
[31m-      }[m
[31m-[m
[31m-      valorPrimarioCorrigido = contribuicaoPrimaria * fatorCorrigido;[m
[31m-      valorSecundarioCorrigido = contribuicaoSecundaria * fatorCorrigido;[m
[31m-[m
[31m-      let valorPrimarioRevisado   = this.convertCurrency(valorPrimarioCorrigido  , dataContribuicao, dib);[m
[31m-      let valorSecundarioRevisado = this.convertCurrency(valorSecundarioCorrigido, dataContribuicao, dib);[m
[31m-[m
[31m-      totalPrimaria += valorPrimarioRevisado;[m
[31m-      totalSecundaria += valorSecundarioRevisado;[m
[31m-[m
[31m-      let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimarioRevisado, dibCurrency.acronimo);[m
[31m-      let contribuicaoSecundariaRevisadaString = "";[m
[31m-      if (!this.isBlackHole){[m
[31m-        contribuicaoSecundariaRevisadaString = this.formatMoney(valorSecundarioRevisado, dibCurrency.acronimo); // Acronimo da moeda após a conversão.[m
[31m-      }[m
[31m-      let line = {competencia: dataContribuicaoString,[m
[31m-                  contribuicao_primaria: contribuicaoPrimariaString,[m
[31m-                  contribuicao_secundaria: contribuicaoSecundariaString,[m
[31m-                  fator: fatorCorrigidoString,[m
[31m-                  contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[31m-                  contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[31m-                  limite: limiteString};[m
[31m-      tableData.push(line);[m
[31m-[m
[31m-    }[m
[31m-[m
[31m-[m
[31m-    if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 5 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16){[m
[31m-      if(contagemPrimaria < 24){[m
[31m-        contagemPrimaria = 24;[m
[31m-      }[m
[31m-      if(contagemSecundaria < 24){[m
[31m-        contagemSecundaria = 24;[m
[31m-      }[m
[31m-    }[m
[32m+[m[32m  //     let dataContribuicaoString = dataContribuicao.format('MM/YYYY');[m
[32m+[m[32m  //     let contribuicaoPrimariaString = this.formatMoney(valorPrimario, currency.acronimo);[m
[32m+[m[32m  //     let contribuicaoSecundariaString = '';[m
[32m+[m
[32m+[m[32m  //     if (!this.isBlackHole){[m
[32m+[m[32m  //       contribuicaoSecundariaString = this.formatMoney(valorSecundario, currency.acronimo);[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     let moeda = this.Moeda.getByDate(dataContribuicao);[m
[32m+[m[32m  //     let fator = moeda.fator;[m
[32m+[m[32m  //     let fatorLimite = moedaComparacao.fator;[m
[32m+[m[32m  //     let fatorCorrigido = fator / fatorLimite;[m
[32m+[m[32m  //     let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4);[m
[32m+[m
[32m+[m[32m  //     let valorPrimarioCorrigido = 0;[m
[32m+[m[32m  //     let valorSecundarioCorrigido = 0;[m
[32m+[m
[32m+[m[32m  //     let limiteString = '';[m
[32m+[m[32m  //     if (contribuicaoPrimaria != 0) {[m
[32m+[m
[32m+[m[32m  //       let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[32m+[m[32m  //       contribuicaoPrimaria =  valorAjustadoObj.valor;[m
[32m+[m[32m  //       limiteString = valorAjustadoObj.aviso;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     if (contribuicaoSecundaria != 0) {[m
[32m+[m[32m  //       contribuicaoSecundaria = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor;[m
[32m+[m[32m  //       contagemSecundaria ++;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     valorPrimarioCorrigido = contribuicaoPrimaria * fatorCorrigido;[m
[32m+[m[32m  //     valorSecundarioCorrigido = contribuicaoSecundaria * fatorCorrigido;[m
[32m+[m
[32m+[m[32m  //     let valorPrimarioRevisado   = this.convertCurrency(valorPrimarioCorrigido  , dataContribuicao, dib);[m
[32m+[m[32m  //     let valorSecundarioRevisado = this.convertCurrency(valorSecundarioCorrigido, dataContribuicao, dib);[m
[32m+[m
[32m+[m[32m  //     totalPrimaria += valorPrimarioRevisado;[m
[32m+[m[32m  //     totalSecundaria += valorSecundarioRevisado;[m
[32m+[m
[32m+[m[32m  //     let contribuicaoPrimariaRevisadaString = this.formatMoney(valorPrimarioRevisado, dibCurrency.acronimo);[m
[32m+[m[32m  //     let contribuicaoSecundariaRevisadaString = "";[m
[32m+[m[32m  //     if (!this.isBlackHole){[m
[32m+[m[32m  //       contribuicaoSecundariaRevisadaString = this.formatMoney(valorSecundarioRevisado, dibCurrency.acronimo); // Acronimo da moeda após a conversão.[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     let line = {competencia: dataContribuicaoString,[m
[32m+[m[32m  //                 contribuicao_primaria: contribuicaoPrimariaString,[m
[32m+[m[32m  //                 contribuicao_secundaria: contribuicaoSecundariaString,[m
[32m+[m[32m  //                 fator: fatorCorrigidoString,[m
[32m+[m[32m  //                 contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[32m+[m[32m  //                 contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[32m+[m[32m  //                 limite: limiteString};[m
[32m+[m[32m  //     tableData.push(line);[m
[32m+[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 5 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16){[m
[32m+[m[32m  //     if(contagemPrimaria < 24){[m
[32m+[m[32m  //       contagemPrimaria = 24;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(contagemSecundaria < 24){[m
[32m+[m[32m  //       contagemSecundaria = 24;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
     [m
 [m
[31m-    let mediaPrimaria = totalPrimaria / contagemPrimaria;[m
[31m-    let mediaSecundaria = 0;[m
[31m-    if(totalSecundaria > 0) {[m
[31m-      mediaSecundaria = totalSecundaria / contagemSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    let contribuicaoMedia = mediaPrimaria + mediaSecundaria;[m
[31m-[m
[31m-    let rmi = (this.limitarTetosEMinimos(contribuicaoMedia, dataComparacao)).valor;[m
[31m-[m
[31m-    let indiceReajuste = contribuicaoMedia / rmi;[m
[31m-[m
[31m-    // Coeficiente Calculado na função direitoAposentadoria[m
[31m-    rmi = rmi * (this.coeficiente / 100);[m
[31m-[m
[31m-    rmi = (this.limitarTetosEMinimos(rmi, dataComparacao)).valor;[m
[31m-[m
[31m-    let rmiValoresAdministrativos = rmi;[m
[31m-[m
[31m-    if(reajustesAdministrativos && [m
[31m-      ((this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' && this.dataInicioBeneficio >= this.dataDib99) ||[m
[31m-       (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' && this.dataInicioBeneficio >= this.dataDib98))){[m
[31m-           rmiValoresAdministrativos = this.getValoresAdministrativos(rmiValoresAdministrativos);[m
[31m-    }[m
[31m-[m
[31m-    if (this.tipoBeneficio == 17 || //AuxilioAcidente30[m
[31m-        this.tipoBeneficio == 18 || //AuxilioAcidente40[m
[31m-        this.tipoBeneficio == 7  || //AuxilioAcidente50[m
[31m-        this.tipoBeneficio == 19){  //AuxilioAcidente60[m
[31m-        let fatorAuxilio;[m
[31m-        switch(this.tipoBeneficio){[m
[31m-          case 17:[m
[31m-            fatorAuxilio = 0.3;[m
[31m-            break;[m
[31m-          case 18:[m
[31m-            fatorAuxilio = 0.4;[m
[31m-            break;[m
[31m-          case 7:[m
[31m-            fatorAuxilio = 0.5;[m
[31m-            break;[m
[31m-          case 19:[m
[31m-            fatorAuxilio = 0.6;[m
[31m-            break;[m
[31m-        }[m
[31m-        let moedaAuxilio = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[31m-        let salMinimo = moedaAuxilio.salario_minimo;[m
[31m-[m
[31m-        if(contribuicaoMedia > rmiValoresAdministrativos){[m
[31m-          rmiValoresAdministrativos = contribuicaoMedia * fatorAuxilio;[m
[31m-        }else{[m
[31m-          rmiValoresAdministrativos = salMinimo * fatorAuxilio;[m
[31m-        }[m
[31m-[m
[31m-        if (contribuicaoMedia > rmi){[m
[31m-          rmi = contribuicaoMedia * fatorAuxilio;[m
[31m-        }else{[m
[31m-          rmi = rmi * fatorAuxilio;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    let somaContribuicoes = totalPrimaria + totalSecundaria;[m
[31m-[m
[31m-    if (reajustesAdministrativos) {[m
[31m-       //TODO: salvarBeneficiosNoBD;[m
[31m-    }[m
[31m-[m
[31m-    let currency = this.loadCurrency(dib);[m
[31m-[m
[31m-    //Conclusões abaixo da tabela:[m
[31m-    conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimaria, currency.acronimo);[m
[31m-    conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaPrimaria, currency.acronimo);[m
[31m-    conclusoes.divisor_calculo_media = contagemPrimaria;[m
[31m-[m
[31m-    if (totalSecundaria > 0)[m
[31m-      conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundaria, currency.acronimo);;[m
[31m-    if (mediaSecundaria > 0) {[m
[31m-      conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaSecundaria, currency.acronimo); [m
[31m-      conclusoes.divisor_calculo_media_secundaria = contagemSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    conclusoes.media_contribuicoes = this.formatMoney(contribuicaoMedia, currency.acronimo);[m
[31m-    conclusoes.coeficiente = this.coeficiente;[m
[31m-    conclusoes.indice_reajuste_teto = indiceReajuste;[m
[31m-    conclusoes.salario_minimo = this.formatMoney(moedaComparacao.salario_minimo, currency.acronimo);[m
[31m-    conclusoes.teto = this.formatMoney(moedaComparacao.teto, currency.acronimo);[m
[31m-    conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currency.acronimo);[m
[31m-    conclusoes.renda_mensal_inicial_data_dib = this.formatMoney(rmiValoresAdministrativos, currency.acronimo);[m
[32m+[m[32m  //   let mediaPrimaria = totalPrimaria / contagemPrimaria;[m
[32m+[m[32m  //   let mediaSecundaria = 0;[m
[32m+[m[32m  //   if(totalSecundaria > 0) {[m
[32m+[m[32m  //     mediaSecundaria = totalSecundaria / contagemSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let contribuicaoMedia = mediaPrimaria + mediaSecundaria;[m
[32m+[m
[32m+[m[32m  //   let rmi = (this.limitarTetosEMinimos(contribuicaoMedia, dataComparacao)).valor;[m
[32m+[m
[32m+[m[32m  //   let indiceReajuste = contribuicaoMedia / rmi;[m
[32m+[m
[32m+[m[32m  //   // Coeficiente Calculado na função direitoAposentadoria[m
[32m+[m[32m  //   rmi = rmi * (this.coeficiente / 100);[m
[32m+[m
[32m+[m[32m  //   rmi = (this.limitarTetosEMinimos(rmi, dataComparacao)).valor;[m
[32m+[m
[32m+[m[32m  //   let rmiValoresAdministrativos = rmi;[m
[32m+[m
[32m+[m[32m  //   if(reajustesAdministrativos &&[m[41m [m
[32m+[m[32m  //     ((this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' && this.dataInicioBeneficio >= this.dataDib99) ||[m
[32m+[m[32m  //      (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' && this.dataInicioBeneficio >= this.dataDib98))){[m
[32m+[m[32m  //          rmiValoresAdministrativos = this.getValoresAdministrativos(rmiValoresAdministrativos);[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 17 || //AuxilioAcidente30[m
[32m+[m[32m  //       this.tipoBeneficio == 18 || //AuxilioAcidente40[m
[32m+[m[32m  //       this.tipoBeneficio == 7  || //AuxilioAcidente50[m
[32m+[m[32m  //       this.tipoBeneficio == 19){  //AuxilioAcidente60[m
[32m+[m[32m  //       let fatorAuxilio;[m
[32m+[m[32m  //       switch(this.tipoBeneficio){[m
[32m+[m[32m  //         case 17:[m
[32m+[m[32m  //           fatorAuxilio = 0.3;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //         case 18:[m
[32m+[m[32m  //           fatorAuxilio = 0.4;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //         case 7:[m
[32m+[m[32m  //           fatorAuxilio = 0.5;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //         case 19:[m
[32m+[m[32m  //           fatorAuxilio = 0.6;[m
[32m+[m[32m  //           break;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       let moedaAuxilio = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[32m+[m[32m  //       let salMinimo = moedaAuxilio.salario_minimo;[m
[32m+[m
[32m+[m[32m  //       if(contribuicaoMedia > rmiValoresAdministrativos){[m
[32m+[m[32m  //         rmiValoresAdministrativos = contribuicaoMedia * fatorAuxilio;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         rmiValoresAdministrativos = salMinimo * fatorAuxilio;[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       if (contribuicaoMedia > rmi){[m
[32m+[m[32m  //         rmi = contribuicaoMedia * fatorAuxilio;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         rmi = rmi * fatorAuxilio;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let somaContribuicoes = totalPrimaria + totalSecundaria;[m
[32m+[m
[32m+[m[32m  //   if (reajustesAdministrativos) {[m
[32m+[m[32m  //      //TODO: salvarBeneficiosNoBD;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let currency = this.loadCurrency(dib);[m
[32m+[m
[32m+[m[32m  //   //Conclusões abaixo da tabela:[m
[32m+[m[32m  //   conclusoes.total_contribuicoes_primarias = this.formatMoney(totalPrimaria, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaPrimaria, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.divisor_calculo_media = contagemPrimaria;[m
[32m+[m
[32m+[m[32m  //   if (totalSecundaria > 0)[m
[32m+[m[32m  //     conclusoes.total_contribuicoes_secundarias = this.formatMoney(totalSecundaria, currency.acronimo);;[m
[32m+[m[32m  //   if (mediaSecundaria > 0) {[m
[32m+[m[32m  //     conclusoes.media_contribuicoes_secundarias = this.formatMoney(mediaSecundaria, currency.acronimo);[m[41m [m
[32m+[m[32m  //     conclusoes.divisor_calculo_media_secundaria = contagemSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   conclusoes.media_contribuicoes = this.formatMoney(contribuicaoMedia, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.coeficiente = this.coeficiente;[m
[32m+[m[32m  //   conclusoes.indice_reajuste_teto = indiceReajuste;[m
[32m+[m[32m  //   conclusoes.salario_minimo = this.formatMoney(moedaComparacao.salario_minimo, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.teto = this.formatMoney(moedaComparacao.teto, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.renda_mensal_inicial = this.formatMoney(rmi, currency.acronimo);[m
[32m+[m[32m  //   conclusoes.renda_mensal_inicial_data_dib = this.formatMoney(rmiValoresAdministrativos, currency.acronimo);[m
     [m
[31m-    if(periodo == '91_98'){[m
[31m-      this.calculo91_98TableData = tableData;[m
[31m-      this.calculo91_98TableOptions = {[m
[31m-        ...this.calculo91_98TableOptions,[m
[31m-        data: this.calculo91_98TableData,[m
[31m-      }[m
[31m-    }else if(periodo == '98_99'){[m
[31m-      this.calculo98_99TableData = tableData;[m
[31m-      this.calculo98_99TableOptions = {[m
[31m-        ...this.calculo98_99TableOptions,[m
[31m-        data: this.calculo98_99TableData,[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-  }[m
[31m-[m
[31m-  direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[31m-    let idadeDoSegurado = this.idadeSegurado;[m
[31m-    //let tempoContribuicaoPrimaria = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[31m-    let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[31m-    let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
[31m-    //let anosSecundaria = (this.getContribuicaoObj(this.calculo.contribuicao_secundaria_98)).anos;[m
[31m-    let anosSecundaria = tempoContribuicaoSecundaria.anos;[m
[31m-    let anosPrimaria = ((tempoContribuicaoPrimaria.anos * 365) + (tempoContribuicaoPrimaria.meses * 30) + tempoContribuicaoPrimaria.dias)/365;[m
[31m-[m
[31m-    let anosContribuicao = anosPrimaria;[m
[31m-    this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, false, dib); [m
[31m-[m
[31m-    let totalContribuicao98 = 0;[m
[31m-    let tempoContribuicaoPrimaria98 = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[31m-    if(tempoContribuicaoPrimaria98 != {anos:0, meses:0, dias:0}) {[m
[31m-      totalContribuicao98 = ((tempoContribuicaoPrimaria98.anos * 365) + (tempoContribuicaoPrimaria98.meses * 30) + tempoContribuicaoPrimaria98.dias) /365;[m
[31m-    }[m
[31m-[m
[31m-    let direito = true;[m
[31m-    let idadeMinima = true;[m
[31m-    let extra;[m
[31m-    let toll;[m
[31m-[m
[31m-    let erroString = '';[m
[31m-    if(this.tipoBeneficio == 4 || this.tipoBeneficio == 6){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 0);[m
[31m-      if (!direito){[m
[31m-        if (dib <= this.dataDib98) {[m
[31m-          direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 5);[m
[31m-          this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, true, dib); [m
[31m-        }else{[m
[31m-          extra = this.calcularExtra(totalContribuicao98, redutorSexo);[m
[31m-          toll = this.calcularToll(totalContribuicao98, 0.4, 5, redutorSexo);[m
[31m-          this.coeficiente = this.calcularCoeficiente(anosContribuicao, toll, redutorProfessor, redutorSexo, true, dib); [m
[31m-          direito = this.verificarIdadeNecessaria(idadeDoSegurado, 7, 0, redutorSexo, errorArray);[m
[31m-          direito = direito && this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, extra + 5);[m
[31m-        }[m
[31m-        let contribuicao = 35 - redutorProfessor - redutorSexo - anosContribuicao;[m
[31m-        let tempoFracionado = this.tratarTempoFracionado(contribuicao); //Separar o tempo de contribuicao em anos, meses e dias[m
[31m-        if (direito) {[m
[31m-          // Exibir Mensagem de beneficio Proporcional, com o tempo faltante;[m
[31m-          //"POSSUI direito ao benefício proporcional."[m
[31m-          //"Falta(m) 'tempoFracionado' para possuir o direito ao benefício INTEGRAL."[m
[31m-          errorArray.push("POSSUI direito ao benefício proporcional. Falta(m) " + tempoFracionado + " para possuir o direito ao benefício INTEGRAL."); [m
[31m-        }else{[m
[31m-          // Exibir Mensagem de beneficio nao concedido.[m
[31m-          // Falta(m) 'tempoFracionado' para completar o tempo de serviço necessário para o benefício INTEGRAL.[m
[31m-          errorArray.push("Falta(m) "+ tempoFracionado + " para completar o tempo de serviço necessário para o benefício INTEGRAL.");[m
[31m-          if (totalContribuicao98 > 0) {[m
[31m-            let tempo = 35 - redutorProfessor - (extra + 5) - anosContribuicao;[m
[31m-            let tempoProporcional = this.tratarTempoFracionado(tempo);[m
[31m-            // Exibir Mensagem com o tempo faltante para o beneficio proporcioanl;[m
[31m-            // Falta(m) 'tempoProporcional' para completar o tempo de serviço necessário para o benefício PROPORCIONAL.[m
[31m-             errorArray.push("Falta(m) "+ tempoProporcional + " para completar o tempo de serviço necessário para o benefício PROPORCIONAL.");[m
[31m-          }[m
[31m-        }    [m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 3){[m
[31m-      idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[31m-      if (!idadeMinima){ [m
[31m-        return false;[m
[31m-      }[m
[31m-      if(!this.verificarCarencia(-5, redutorProfessor, redutorSexo, errorArray)){[m
[31m-        return false;[m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 5){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, 0, 20);[m
[31m-      if(!direito) {[m
[31m-        errorArray.push("Não possui direito ao benefício de aposentadoria especial.");[m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 16){[m
[31m-      idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[31m-      if (!idadeMinima){[m
[31m-        return false;[m
[31m-      }[m
[31m-      if (!this.verificarCarencia(0, redutorProfessor, redutorSexo, errorArray)){[m
[31m-        return false;[m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 25){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 10);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.    [m
[31m-      }[m
[31m-    }else if (this.tipoBeneficio == 26){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 6);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.    [m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 27){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 2);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.   [m
[31m-      }[m
[31m-    }else if(this.tipoBeneficio == 28){[m
[31m-      direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 20);[m
[31m-      if (!direito){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m
[31m-      }[m
[31m-      if (!this.verificarIdadeMinima(idadeDoSegurado, errorArray)){[m
[31m-        errorArray.push("");[m
[31m-        return false; // Exibir Mensagem de erro com a idade faltando;[m
[31m-      }[m
[31m-    }[m
[31m-    return direito;[m
[31m-  }[m
[32m+[m[32m  //   if(periodo == '91_98'){[m
[32m+[m[32m  //     this.calculo91_98TableData = tableData;[m
[32m+[m[32m  //     this.calculo91_98TableOptions = {[m
[32m+[m[32m  //       ...this.calculo91_98TableOptions,[m
[32m+[m[32m  //       data: this.calculo91_98TableData,[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(periodo == '98_99'){[m
[32m+[m[32m  //     this.calculo98_99TableData = tableData;[m
[32m+[m[32m  //     this.calculo98_99TableOptions = {[m
[32m+[m[32m  //       ...this.calculo98_99TableOptions,[m
[32m+[m[32m  //       data: this.calculo98_99TableData,[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[32m+[m[32m  //   let idadeDoSegurado = this.idadeSegurado;[m
[32m+[m[32m  //   //let tempoContribuicaoPrimaria = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[32m+[m[32m  //   let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[32m+[m[32m  //   let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
[32m+[m[32m  //   //let anosSecundaria = (this.getContribuicaoObj(this.calculo.contribuicao_secundaria_98)).anos;[m
[32m+[m[32m  //   let anosSecundaria = tempoContribuicaoSecundaria.anos;[m
[32m+[m[32m  //   let anosPrimaria = ((tempoContribuicaoPrimaria.anos * 365) + (tempoContribuicaoPrimaria.meses * 30) + tempoContribuicaoPrimaria.dias)/365;[m
[32m+[m
[32m+[m[32m  //   let anosContribuicao = anosPrimaria;[m
[32m+[m[32m  //   this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, false, dib);[m[41m [m
[32m+[m
[32m+[m[32m  //   let totalContribuicao98 = 0;[m
[32m+[m[32m  //   let tempoContribuicaoPrimaria98 = this.getContribuicaoObj(this.calculo.contribuicao_primaria_98);[m
[32m+[m[32m  //   if(tempoContribuicaoPrimaria98 != {anos:0, meses:0, dias:0}) {[m
[32m+[m[32m  //     totalContribuicao98 = ((tempoContribuicaoPrimaria98.anos * 365) + (tempoContribuicaoPrimaria98.meses * 30) + tempoContribuicaoPrimaria98.dias) /365;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let direito = true;[m
[32m+[m[32m  //   let idadeMinima = true;[m
[32m+[m[32m  //   let extra;[m
[32m+[m[32m  //   let toll;[m
[32m+[m
[32m+[m[32m  //   let erroString = '';[m
[32m+[m[32m  //   if(this.tipoBeneficio == 4 || this.tipoBeneficio == 6){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 0);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       if (dib <= this.dataDib98) {[m
[32m+[m[32m  //         direito = this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, 5);[m
[32m+[m[32m  //         this.coeficiente = this.calcularCoeficiente(anosContribuicao, 0, redutorProfessor, redutorSexo, true, dib);[m[41m [m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         extra = this.calcularExtra(totalContribuicao98, redutorSexo);[m
[32m+[m[32m  //         toll = this.calcularToll(totalContribuicao98, 0.4, 5, redutorSexo);[m
[32m+[m[32m  //         this.coeficiente = this.calcularCoeficiente(anosContribuicao, toll, redutorProfessor, redutorSexo, true, dib);[m[41m [m
[32m+[m[32m  //         direito = this.verificarIdadeNecessaria(idadeDoSegurado, 7, 0, redutorSexo, errorArray);[m
[32m+[m[32m  //         direito = direito && this.verificarTempoDeServico(anosContribuicao, redutorProfessor, redutorSexo, extra + 5);[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       let contribuicao = 35 - redutorProfessor - redutorSexo - anosContribuicao;[m
[32m+[m[32m  //       let tempoFracionado = this.tratarTempoFracionado(contribuicao); //Separar o tempo de contribuicao em anos, meses e dias[m
[32m+[m[32m  //       if (direito) {[m
[32m+[m[32m  //         // Exibir Mensagem de beneficio Proporcional, com o tempo faltante;[m
[32m+[m[32m  //         //"POSSUI direito ao benefício proporcional."[m
[32m+[m[32m  //         //"Falta(m) 'tempoFracionado' para possuir o direito ao benefício INTEGRAL."[m
[32m+[m[32m  //         errorArray.push("POSSUI direito ao benefício proporcional. Falta(m) " + tempoFracionado + " para possuir o direito ao benefício INTEGRAL.");[m[41m [m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         // Exibir Mensagem de beneficio nao concedido.[m
[32m+[m[32m  //         // Falta(m) 'tempoFracionado' para completar o tempo de serviço necessário para o benefício INTEGRAL.[m
[32m+[m[32m  //         errorArray.push("Falta(m) "+ tempoFracionado + " para completar o tempo de serviço necessário para o benefício INTEGRAL.");[m
[32m+[m[32m  //         if (totalContribuicao98 > 0) {[m
[32m+[m[32m  //           let tempo = 35 - redutorProfessor - (extra + 5) - anosContribuicao;[m
[32m+[m[32m  //           let tempoProporcional = this.tratarTempoFracionado(tempo);[m
[32m+[m[32m  //           // Exibir Mensagem com o tempo faltante para o beneficio proporcioanl;[m
[32m+[m[32m  //           // Falta(m) 'tempoProporcional' para completar o tempo de serviço necessário para o benefício PROPORCIONAL.[m
[32m+[m[32m  //            errorArray.push("Falta(m) "+ tempoProporcional + " para completar o tempo de serviço necessário para o benefício PROPORCIONAL.");[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m[41m    [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 3){[m
[32m+[m[32m  //     idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[32m+[m[32m  //     if (!idadeMinima){[m[41m [m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(!this.verificarCarencia(-5, redutorProfessor, redutorSexo, errorArray)){[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 5){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, 0, 20);[m
[32m+[m[32m  //     if(!direito) {[m
[32m+[m[32m  //       errorArray.push("Não possui direito ao benefício de aposentadoria especial.");[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 16){[m
[32m+[m[32m  //     idadeMinima = this.verificarIdadeMinima(idadeDoSegurado, errorArray);[m
[32m+[m[32m  //     if (!idadeMinima){[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (!this.verificarCarencia(0, redutorProfessor, redutorSexo, errorArray)){[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 25){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 10);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m[41m    [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if (this.tipoBeneficio == 26){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 6);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m[41m    [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 27){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 2);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m[41m   [m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 28){[m
[32m+[m[32m  //     direito = this.verificarTempoDeServico(anosContribuicao, 0, redutorSexo, 20);[m
[32m+[m[32m  //     if (!direito){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a quantidade de tempo faltando.[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (!this.verificarIdadeMinima(idadeDoSegurado, errorArray)){[m
[32m+[m[32m  //       errorArray.push("");[m
[32m+[m[32m  //       return false; // Exibir Mensagem de erro com a idade faltando;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return direito;[m
[32m+[m[32m  // }[m
 [m
   calcularCoeficiente(anosContribuicao, toll, redutorProfessor, redutorSexo, proporcional, dib) {[m
     let coeficienteAux = 0;[m
[36m@@ -1104,27 +1021,27 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     return valorBeneficio;[m
   }[m
 [m
[31m-  verificarCarencia(redutorIdade, redutorProfessor, redutorSexo, errorArray) {[m
[31m-    if (this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[31m-      let mesesCarencia = 180;[m
[31m-      if (moment(this.segurado.data_filiacao, 'DD/MM/YYYY') < this.dataLei8213) { // Verificar se a data de filiação existe[m
[31m-        let anoNecessario = this.getAnoNecessario(redutorIdade, redutorProfessor, redutorSexo)[m
[31m-        let carenciaProgressiva = this.CarenciaProgressiva.getCarencia(anoNecessario);[m
[31m-        if (carenciaProgressiva != 0) {[m
[31m-            mesesCarencia = carenciaProgressiva;[m
[31m-        } else if (anoNecessario < 1991) {[m
[31m-            mesesCarencia = 60;[m
[31m-        }[m
[31m-      }[m
[31m-[m
[31m-      if (this.calculo.carencia < mesesCarencia) {[m
[31m-        let erroCarencia = "Falta(m) " + (mesesCarencia - this.calculo.carencia) + " mês(es) para a carência necessária.";[m
[31m-        errorArray.push(erroCarencia);[m
[31m-        return false;[m
[31m-      }[m
[31m-    }[m
[31m-    return true;[m
[31m-  }[m
[32m+[m[32m  // verificarCarencia(redutorIdade, redutorProfessor, redutorSexo, errorArray) {[m
[32m+[m[32m  //   if (this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[32m+[m[32m  //     let mesesCarencia = 180;[m
[32m+[m[32m  //     if (moment(this.segurado.data_filiacao, 'DD/MM/YYYY') < this.dataLei8213) { // Verificar se a data de filiação existe[m
[32m+[m[32m  //       let anoNecessario = this.getAnoNecessario(redutorIdade, redutorProfessor, redutorSexo)[m
[32m+[m[32m  //       let carenciaProgressiva = this.CarenciaProgressiva.getCarencia(anoNecessario);[m
[32m+[m[32m  //       if (carenciaProgressiva != 0) {[m
[32m+[m[32m  //           mesesCarencia = carenciaProgressiva;[m
[32m+[m[32m  //       } else if (anoNecessario < 1991) {[m
[32m+[m[32m  //           mesesCarencia = 60;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     if (this.calculo.carencia < mesesCarencia) {[m
[32m+[m[32m  //       let erroCarencia = "Falta(m) " + (mesesCarencia - this.calculo.carencia) + " mês(es) para a carência necessária.";[m
[32m+[m[32m  //       errorArray.push(erroCarencia);[m
[32m+[m[32m  //       return false;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return true;[m
[32m+[m[32m  // }[m
 [m
   calcularExtra(tempoServico, redutorSexo) {[m
     let extra;[m
[36m@@ -1189,803 +1106,803 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
 [m
   //INICIO Cálculo após 99[m
 [m
[31m-  calculo_apos_99(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[31m-    let dib = this.dataInicioBeneficio;[m
[31m-    let dibCurrency = this.loadCurrency(dib);[m
[31m-    let moedaDib = this.Moeda.getByDate(dib);[m
[31m-    let dataComparacao = (dib.clone()).startOf('month');[m
[31m-    let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[31m-[m
[31m-    if(this.listaValoresContribuidos.length == 0) {[m
[31m-      // Exibir MSG de erro e encerrar Cálculo.[m
[31m-      errorArray.push("Nenhuma contribuição encontrada posterior a 07/1994 conforme " + "http://www.ieprev.com.br//legislacao/2754/lei-no-9.876,-de-26-11-1999' target='_blank'>Art. 02 da Lei nº 9.876, de 29/11/1999");[m
[31m-      return;[m
[31m-    }[m
[31m-[m
[31m-    if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[31m-      return;[m
[31m-    }[m
[31m-[m
[31m-    let totalContribuicaoPrimaria = 0;[m
[31m-    let totalContribuicaoSecundaria = 0;[m
[31m-    let totalContribuicaoPrimaria12 = 0;[m
[31m-    let totalContribuicaoSecundaria12 = 0;[m
[31m-[m
[31m-    let contadorSecundario = 0;[m
[31m-    let contadorPrimario = 0;[m
[31m-[m
[31m-    let primeirasContribuicoes = [];[m
[31m-    let tabelaIndex = 0;[m
[31m-    let tableData = [][m
[31m-    for(let contribuicao of this.listaValoresContribuidos) {[m
[31m-      let contribuicaoPrimaria = parseFloat(contribuicao.valor_primaria);[m
[31m-      let contribuicaoSecundaria = parseFloat(contribuicao.valor_secundaria);[m
[31m-      let dataContribuicao = moment(contribuicao.data);[m
[31m-      let currency = this.loadCurrency(dataContribuicao);[m
[31m-[m
[31m-      let idString = contadorPrimario + 1; //tabela['id'] = contadorPrimario;[m
[31m-      contadorPrimario++;[m
[31m-      let dataContribuicaoString = dataContribuicao.format('MM/YYYY');//tabela['dataContribuicao'] = contribuicao.dataContribuicao;[m
[31m-      let contribuicaoPrimariaString = this.formatMoney(contribuicaoPrimaria, currency.acronimo); //tabela['Contribuicao Primaria'] = currency.acronimo + contribuicaoPrimaria;[m
[31m-      let contribuicaoSecundariaString = this.formatMoney(contribuicaoSecundaria, currency.acronimo); //tabela['Contribuicao Secundaria'] = currency.acronimo + contribuicaoSecundaria;[m
[32m+[m[32m  // calculo_apos_99(errorArray, conclusoes, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria){[m
[32m+[m[32m  //   let dib = this.dataInicioBeneficio;[m
[32m+[m[32m  //   let dibCurrency = this.loadCurrency(dib);[m
[32m+[m[32m  //   let moedaDib = this.Moeda.getByDate(dib);[m
[32m+[m[32m  //   let dataComparacao = (dib.clone()).startOf('month');[m
[32m+[m[32m  //   let moedaComparacao = this.Moeda.getByDate(dataComparacao);[m
[32m+[m
[32m+[m[32m  //   if(this.listaValoresContribuidos.length == 0) {[m
[32m+[m[32m  //     // Exibir MSG de erro e encerrar Cálculo.[m
[32m+[m[32m  //     errorArray.push("Nenhuma contribuição encontrada posterior a 07/1994 conforme " + "http://www.ieprev.com.br//legislacao/2754/lei-no-9.876,-de-26-11-1999' target='_blank'>Art. 02 da Lei nº 9.876, de 29/11/1999");[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (!this.direitoAposentadoria(dib, errorArray, tempoContribuicaoPrimaria, tempoContribuicaoSecundaria)){[m
[32m+[m[32m  //     return;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let totalContribuicaoPrimaria = 0;[m
[32m+[m[32m  //   let totalContribuicaoSecundaria = 0;[m
[32m+[m[32m  //   let totalContribuicaoPrimaria12 = 0;[m
[32m+[m[32m  //   let totalContribuicaoSecundaria12 = 0;[m
[32m+[m
[32m+[m[32m  //   let contadorSecundario = 0;[m
[32m+[m[32m  //   let contadorPrimario = 0;[m
[32m+[m
[32m+[m[32m  //   let primeirasContribuicoes = [];[m
[32m+[m[32m  //   let tabelaIndex = 0;[m
[32m+[m[32m  //   let tableData = [][m
[32m+[m[32m  //   for(let contribuicao of this.listaValoresContribuidos) {[m
[32m+[m[32m  //     let contribuicaoPrimaria = parseFloat(contribuicao.valor_primaria);[m
[32m+[m[32m  //     let contribuicaoSecundaria = parseFloat(contribuicao.valor_secundaria);[m
[32m+[m[32m  //     let dataContribuicao = moment(contribuicao.data);[m
[32m+[m[32m  //     let currency = this.loadCurrency(dataContribuicao);[m
[32m+[m
[32m+[m[32m  //     let idString = contadorPrimario + 1; //tabela['id'] = contadorPrimario;[m
[32m+[m[32m  //     contadorPrimario++;[m
[32m+[m[32m  //     let dataContribuicaoString = dataContribuicao.format('MM/YYYY');//tabela['dataContribuicao'] = contribuicao.dataContribuicao;[m
[32m+[m[32m  //     let contribuicaoPrimariaString = this.formatMoney(contribuicaoPrimaria, currency.acronimo); //tabela['Contribuicao Primaria'] = currency.acronimo + contribuicaoPrimaria;[m
[32m+[m[32m  //     let contribuicaoSecundariaString = this.formatMoney(contribuicaoSecundaria, currency.acronimo); //tabela['Contribuicao Secundaria'] = currency.acronimo + contribuicaoSecundaria;[m
       [m
[31m-      let moeda = this.Moeda.getByDate(dataContribuicao);[m
[31m-      let fator = moeda.fator;[m
[31m-      let fatorLimite = moedaComparacao.fator;[m
[31m-      let fatorCorrigido = fator / fatorLimite;[m
[31m-      let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4); // tabela['fatorCorrigido'] = fator/fatorLimite;[m
[32m+[m[32m  //     let moeda = this.Moeda.getByDate(dataContribuicao);[m
[32m+[m[32m  //     let fator = moeda.fator;[m
[32m+[m[32m  //     let fatorLimite = moedaComparacao.fator;[m
[32m+[m[32m  //     let fatorCorrigido = fator / fatorLimite;[m
[32m+[m[32m  //     let fatorCorrigidoString = this.formatDecimal(fatorCorrigido, 4); // tabela['fatorCorrigido'] = fator/fatorLimite;[m
        [m
[31m-      let contribuicaoPrimariaRevisada = 0;[m
[31m-      let contribuicaoSecundariaRevisada = 0;[m
[31m-[m
[31m-      let limiteString = '';[m
[31m-      if(contribuicaoPrimaria != 0){[m
[31m-        let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[31m-        contribuicaoPrimariaRevisada = valorAjustadoObj.valor;[m
[31m-        limiteString = valorAjustadoObj.aviso;[m
[31m-      }[m
[31m-      if (contribuicaoSecundaria != 0) {[m
[31m-        contribuicaoSecundariaRevisada = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor; //Inserir texto 'Limitado ao teto' e 'limitado ao minimo' quando cabivel.[m
[31m-        contadorSecundario++;[m
[31m-      }[m
[31m-[m
[31m-      contribuicaoPrimariaRevisada = contribuicaoPrimariaRevisada * fatorCorrigido;[m
[31m-      contribuicaoSecundariaRevisada = contribuicaoSecundariaRevisada * fatorCorrigido;[m
[31m-[m
[31m-      contribuicaoPrimariaRevisada   = this.convertCurrency(contribuicaoPrimariaRevisada  , dataContribuicao, dib);[m
[31m-      contribuicaoSecundariaRevisada   = this.convertCurrency(contribuicaoSecundariaRevisada  , dataContribuicao, dib);[m
[31m-[m
[31m-      totalContribuicaoPrimaria += contribuicaoPrimariaRevisada;[m
[31m-      totalContribuicaoSecundaria += contribuicaoSecundariaRevisada;[m
[31m-[m
[31m-[m
[31m-      let contribuicaoPrimariaRevisadaString = this.formatMoney(contribuicaoPrimariaRevisada, dibCurrency.acronimo);[m
[31m-      let contribuicaoSecundariaRevisadaString = this.formatMoney(contribuicaoSecundariaRevisada, dibCurrency.acronimo);[m
[31m-      //tabela['Contribuicao Primaria Corrigida'] = currency.Acronimo + contribuicaoPrimariaRevisada[m
[31m-      //tabela['Contribuicao Secundaria Corrigida'] = currency.Acronimo + contribuicaoSecundariaRevisada[m
[31m-[m
[31m-      let line = {id:idString,[m
[31m-                  competencia: dataContribuicaoString,[m
[31m-                  contribuicao_primaria: contribuicaoPrimariaString,[m
[31m-                  contribuicao_secundaria: contribuicaoSecundariaString,[m
[31m-                  indice_corrigido: fatorCorrigidoString,[m
[31m-                  contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[31m-                  contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[31m-                  limite: limiteString,[m
[31m-                  valor_primario:contribuicaoPrimariaRevisada,[m
[31m-                  valor_secundario:contribuicaoSecundariaRevisada};[m
[31m-      tableData.push(line);[m
[31m-      if(tabelaIndex < 12){[m
[31m-        primeirasContribuicoes.push(line);[m
[31m-      }[m
[31m-      tabelaIndex++;[m
[31m-    }[m
[31m-[m
[31m-    if (contadorSecundario < 24){[m
[31m-      contadorSecundario = 24;[m
[31m-    }[m
[31m-[m
[31m-    let mesesContribuicao = this.getDifferenceInMonths(moment('1994-07-01'), this.dataInicioBeneficio);[m
[31m-    let mesesContribuicao80 = Math.trunc((mesesContribuicao * 0.8) - 0.5);[m
[31m-    let mesesContribuicao60 = Math.trunc((mesesContribuicao * 0.6) - 0.5);[m
[31m-    let divisorMinimo = Math.trunc(mesesContribuicao * 0.6);[m
[31m-[m
[31m-    if (contadorSecundario < mesesContribuicao * 0.6) {[m
[31m-      contadorSecundario = Math.trunc(mesesContribuicao * 0.6);[m
[31m-    }else if(contadorSecundario < mesesContribuicao * 0.6){[m
[31m-      contadorSecundario = Math.trunc(mesesContribuicao * 0.8);[m
[31m-    }[m
[31m-[m
[31m-    let numeroContribuicoes = tableData.length;//Numero de contribuicoes carregadas para o periodo;[m
[31m-    let divisorMediaPrimaria = numeroContribuicoes;[m
[31m-    let divisorSecundario = contadorSecundario;[m
[31m-    if(divisorSecundario < mesesContribuicao * 0.6){[m
[31m-      divisorSecundario = Math.round(mesesContribuicao * 0.6);[m
[31m-    }else if(divisorSecundario < mesesContribuicao * 0.8){[m
[31m-      divisorSecundario = Math.round(mesesContribuicao * 0.8);[m
[31m-    }[m
[31m-    let label;[m
[31m-    switch(this.tipoBeneficio) {[m
[31m-      case 1: // Auxilio Doença Previdenciario[m
[31m-        divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.6)-0.5);[m
[31m-        divisorSecundario = Math.trunc((contadorSecundario * 0.8) - 0.5);[m
[31m-        if (this.withMemo) {[m
[31m-          // Exibir Label contendo o texto[m
[31m-          label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários .";[m
[31m-        }[m
[31m-        break;[m
[31m-      case 2: // Aposentadoria Por Invalidez previdenciaria[m
[31m-        if (divisorMediaPrimaria >= divisorMinimo || this.withMemo) {[m
[31m-          divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          if (this.withMemo) {[m
[31m-            // Exibir Label contendo o texto[m
[31m-            label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários.";[m
[31m-          }[m
[31m-        }[m
[31m-        break;[m
[31m-      case 7: // Auxilio Doença Previdenciario 50%[m
[31m-        divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-        break;[m
[31m-    }[m
[31m-[m
[31m-    if (this.dataFiliacao >= this.dataDib99){[m
[31m-      switch(this.tipoBeneficio){[m
[31m-        case 1: //Auxilio Doença Previdenciario[m
[31m-        case 2: //Aposentadoria por invalidez previdenciaria[m
[31m-          if (numeroContribuicoes >= 144 || this.withMemo) {[m
[31m-            divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          }else{[m
[31m-            divisorMediaPrimaria = numeroContribuicoes;[m
[31m-          }[m
[31m-          break;[m
[31m-        case 5: // Aposentadoria Especial[m
[31m-        case 7: // Auxilio Acidente Previdenciario 50%[m
[31m-          if (numeroContribuicoes < 144 || this.withMemo) {[m
[31m-            divisorMediaPrimaria = numeroContribuicoes;[m
[31m-          }else{                [m
[31m-            divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          }[m
[31m-          break;[m
[31m-        case 3 ://Aposentadoria Idade Trabalhador Urbano[m
[31m-        case 4 ://Aposentadoria Tempo de Contribuicao[m
[31m-        case 16://Aposentadoria Idade Trabalhafor Rural[m
[31m-        case 25://Deficiencia Grave[m
[31m-        case 27://Deficiencia Leva[m
[31m-        case 26://Deficiencia Moderado[m
[31m-        case 28://Deficiencia PorSalvar Idade[m
[31m-          divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          break;[m
[31m-      }[m
[31m-    }else if(this.dataFiliacao < this.dataDib99){[m
[31m-      if(this.tipoBeneficio == 3 || this.tipoBeneficio == 4 || this.tipoBeneficio == 5 || this.tipoBeneficio == 6 ||    [m
[31m-      this.tipoBeneficio == 16 || this.tipoBeneficio == 25 || this.tipoBeneficio == 27 || this.tipoBeneficio == 26 ||              [m
[31m-      this.tipoBeneficio == 28){[m
[31m-           // Deficiencia Por Idade, Deficiencia Grave, Deficiencia Leve, Deficiencia Moderada, Aposentadoria Idade trabalhador Rural,[m
[31m-           // Aposentadoria Idade Urbano, Aposentadoria Tempo Contribuicao, Aposentadoria Especial, Aposentadoria Tempo Servico Professor[m
[31m-        divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-        if (numeroContribuicoes < mesesContribuicao60) {[m
[31m-          divisorMediaPrimaria = mesesContribuicao60[m
[31m-        }[m
[31m-        if (numeroContribuicoes >= mesesContribuicao60 && numeroContribuicoes <= mesesContribuicao80) {[m
[31m-          if (this.withIN45) {[m
[31m-            divisorMediaPrimaria = numeroContribuicoes;[m
[31m-          }else{[m
[31m-            divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[31m-          }[m
[31m-        }[m
[31m-        if(divisorMediaPrimaria < divisorMinimo){[m
[31m-          divisorMediaPrimaria = divisorMinimo;[m
[31m-        }[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    let totalMediaDozeContribuicoes = 0;[m
[31m-    switch(this.tipoBeneficio){[m
[31m-      case 1: // Auxilio Doenca Previdenciario[m
[31m-        if (this.dataInicioBeneficio >= this.dataMP664) {[m
[31m-          let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-          if (numeroContribuicoes >= 12) {[m
[31m-            let contribuicoesPrimarias12 = 0;[m
[31m-            let contribuicoesSecundarias12 = 0;[m
[31m-            for (let contribuicao of primeirasContribuicoes) {[m
[31m-              contribuicoesPrimarias12 += contribuicao.valor_primario;[m
[31m-              contribuicoesSecundarias12 += contribuicao.valor_secundario;[m
[31m-            }[m
[31m-            let moeda = this.Moeda.getByDate(this.dataInicioBeneficio);// Carregar 1 linha da tabela moeda onde a data é menor ou igual que data_pedido_beneficio;[m
[31m-            let salarioMinimoRMI = moeda.salario_minimo;[m
[31m-            let divisorContribuicoes = this.formatDecimal((contribuicoesPrimarias12 + contribuicoesSecundarias12) /12 , 1);[m
[31m-            if (divisorContribuicoes < salarioMinimoRMI) {[m
[31m-              divisorContribuicoes = salarioMinimoRMI;[m
[31m-            }[m
[31m-            totalMediaDozeContribuicoes = divisorContribuicoes;[m
[31m-            // Inserir nas conclusoes:[m
[31m-            //conclusoes.soma_doze_ultimas_contribuicoes = this.formatMoney(contribuicoesPrimarias12, currency.acronimo);[m
[31m-            conclusoes.push({string:"Soma das 12 últimas contribuções", value:this.formatMoney(contribuicoesPrimarias12, currency.acronimo)});  [m
[31m-            //conclusoes.media_doze_ultimas_contribuicoes = this.formatMoney(divisorContribuicoes, currency.acronimo);[m
[31m-            conclusoes.push({string:"Média das 12 últimas contribuções", value:this.formatMoney(divisorContribuicoes, currency.acronimo)}); [m
[31m-          }[m
[31m-        }[m
[31m-        break;[m
[31m-      case 2: //Aposentadoria por invalidez previdenciaria[m
[31m-        if (this.dataInicioBeneficio >= this.dataDecreto6939_2009 && divisorMediaPrimaria > 1) {[m
[31m-          divisorMediaPrimaria = this.formatDecimal((numeroContribuicoes * 0.8)-0.5, 1);[m
[31m-        }[m
[31m-        break;[m
[31m-    }[m
[31m-[m
[31m-[m
[31m-    tableData.sort((entry1, entry2) => {[m
[31m-      if(entry1.valor_primario > entry2.valor_primario){[m
[31m-        return 1;[m
[31m-      }[m
[31m-      if(entry1.valor_primario < entry2.valor_primario){[m
[31m-        return -1;[m
[31m-      }[m
[31m-      return 0;[m
[31m-    });[m
[31m-    if (numeroContribuicoes > divisorMediaPrimaria){[m
[31m-      totalContribuicaoPrimaria = 0[m
[31m-      for(let i=0; i < tableData.length; i++){[m
[31m-        if (i >= tableData.length-divisorMediaPrimaria) {[m
[31m-          totalContribuicaoPrimaria += tableData[i].valor_primario;[m
[31m-        }else{[m
[31m-          tableData[i].limite = "DESCONSIDERADO";[m
[31m-        }[m
[31m-      }[m
[31m-    }[m
[31m-    tableData.sort((entry1, entry2) => {[m
[31m-      if(entry1.id > entry2.id){[m
[31m-        return 1;[m
[31m-      }[m
[31m-      if(entry1.id < entry2.id){[m
[31m-        return -1;[m
[31m-      }[m
[31m-      return 0;[m
[31m-    });[m
[31m-    let numeroCompetencias = this.getDifferenceInMonths(this.dataDib99, this.dataInicioBeneficio); // Calcular a quantidade de meses contida entre as duas datas.[m
[31m-[m
[31m-    if (numeroCompetencias > 60) {[m
[31m-        numeroCompetencias = 60;[m
[31m-    }[m
[31m-[m
[31m-    let expectativa = this.projetarExpectativa(this.idadeFracionada, this.dataInicioBeneficio,conclusoes);[m
[31m-[m
[31m-    let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[31m-    let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
[32m+[m[32m  //     let contribuicaoPrimariaRevisada = 0;[m
[32m+[m[32m  //     let contribuicaoSecundariaRevisada = 0;[m
[32m+[m
[32m+[m[32m  //     let limiteString = '';[m
[32m+[m[32m  //     if(contribuicaoPrimaria != 0){[m
[32m+[m[32m  //       let valorAjustadoObj = this.limitarTetosEMinimos(contribuicaoPrimaria, dataContribuicao);[m
[32m+[m[32m  //       contribuicaoPrimariaRevisada = valorAjustadoObj.valor;[m
[32m+[m[32m  //       limiteString = valorAjustadoObj.aviso;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (contribuicaoSecundaria != 0) {[m
[32m+[m[32m  //       contribuicaoSecundariaRevisada = (this.limitarTetosEMinimos(contribuicaoSecundaria, dataContribuicao)).valor; //Inserir texto 'Limitado ao teto' e 'limitado ao minimo' quando cabivel.[m
[32m+[m[32m  //       contadorSecundario++;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     contribuicaoPrimariaRevisada = contribuicaoPrimariaRevisada * fatorCorrigido;[m
[32m+[m[32m  //     contribuicaoSecundariaRevisada = contribuicaoSecundariaRevisada * fatorCorrigido;[m
[32m+[m
[32m+[m[32m  //     contribuicaoPrimariaRevisada   = this.convertCurrency(contribuicaoPrimariaRevisada  , dataContribuicao, dib);[m
[32m+[m[32m  //     contribuicaoSecundariaRevisada   = this.convertCurrency(contribuicaoSecundariaRevisada  , dataContribuicao, dib);[m
[32m+[m
[32m+[m[32m  //     totalContribuicaoPrimaria += contribuicaoPrimariaRevisada;[m
[32m+[m[32m  //     totalContribuicaoSecundaria += contribuicaoSecundariaRevisada;[m
[32m+[m
[32m+[m
[32m+[m[32m  //     let contribuicaoPrimariaRevisadaString = this.formatMoney(contribuicaoPrimariaRevisada, dibCurrency.acronimo);[m
[32m+[m[32m  //     let contribuicaoSecundariaRevisadaString = this.formatMoney(contribuicaoSecundariaRevisada, dibCurrency.acronimo);[m
[32m+[m[32m  //     //tabela['Contribuicao Primaria Corrigida'] = currency.Acronimo + contribuicaoPrimariaRevisada[m
[32m+[m[32m  //     //tabela['Contribuicao Secundaria Corrigida'] = currency.Acronimo + contribuicaoSecundariaRevisada[m
[32m+[m
[32m+[m[32m  //     let line = {id:idString,[m
[32m+[m[32m  //                 competencia: dataContribuicaoString,[m
[32m+[m[32m  //                 contribuicao_primaria: contribuicaoPrimariaString,[m
[32m+[m[32m  //                 contribuicao_secundaria: contribuicaoSecundariaString,[m
[32m+[m[32m  //                 indice_corrigido: fatorCorrigidoString,[m
[32m+[m[32m  //                 contribuicao_primaria_revisada: contribuicaoPrimariaRevisadaString,[m
[32m+[m[32m  //                 contribuicao_secundaria_revisada: contribuicaoSecundariaRevisadaString,[m
[32m+[m[32m  //                 limite: limiteString,[m
[32m+[m[32m  //                 valor_primario:contribuicaoPrimariaRevisada,[m
[32m+[m[32m  //                 valor_secundario:contribuicaoSecundariaRevisada};[m
[32m+[m[32m  //     tableData.push(line);[m
[32m+[m[32m  //     if(tabelaIndex < 12){[m
[32m+[m[32m  //       primeirasContribuicoes.push(line);[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     tabelaIndex++;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (contadorSecundario < 24){[m
[32m+[m[32m  //     contadorSecundario = 24;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let mesesContribuicao = this.getDifferenceInMonths(moment('1994-07-01'), this.dataInicioBeneficio);[m
[32m+[m[32m  //   let mesesContribuicao80 = Math.trunc((mesesContribuicao * 0.8) - 0.5);[m
[32m+[m[32m  //   let mesesContribuicao60 = Math.trunc((mesesContribuicao * 0.6) - 0.5);[m
[32m+[m[32m  //   let divisorMinimo = Math.trunc(mesesContribuicao * 0.6);[m
[32m+[m
[32m+[m[32m  //   if (contadorSecundario < mesesContribuicao * 0.6) {[m
[32m+[m[32m  //     contadorSecundario = Math.trunc(mesesContribuicao * 0.6);[m
[32m+[m[32m  //   }else if(contadorSecundario < mesesContribuicao * 0.6){[m
[32m+[m[32m  //     contadorSecundario = Math.trunc(mesesContribuicao * 0.8);[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let numeroContribuicoes = tableData.length;//Numero de contribuicoes carregadas para o periodo;[m
[32m+[m[32m  //   let divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //   let divisorSecundario = contadorSecundario;[m
[32m+[m[32m  //   if(divisorSecundario < mesesContribuicao * 0.6){[m
[32m+[m[32m  //     divisorSecundario = Math.round(mesesContribuicao * 0.6);[m
[32m+[m[32m  //   }else if(divisorSecundario < mesesContribuicao * 0.8){[m
[32m+[m[32m  //     divisorSecundario = Math.round(mesesContribuicao * 0.8);[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   let label;[m
[32m+[m[32m  //   switch(this.tipoBeneficio) {[m
[32m+[m[32m  //     case 1: // Auxilio Doença Previdenciario[m
[32m+[m[32m  //       divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.6)-0.5);[m
[32m+[m[32m  //       divisorSecundario = Math.trunc((contadorSecundario * 0.8) - 0.5);[m
[32m+[m[32m  //       if (this.withMemo) {[m
[32m+[m[32m  //         // Exibir Label contendo o texto[m
[32m+[m[32m  //         label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários .";[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 2: // Aposentadoria Por Invalidez previdenciaria[m
[32m+[m[32m  //       if (divisorMediaPrimaria >= divisorMinimo || this.withMemo) {[m
[32m+[m[32m  //         divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         if (this.withMemo) {[m
[32m+[m[32m  //           // Exibir Label contendo o texto[m
[32m+[m[32m  //           label = "Este calculo foi realizado com base no <a href='#' onclick='javascript:alert(\"Em breve a descrição do Memorando.\");'>Memorando n.º21,28/10</a> descarte dos 20% menores salários.";[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 7: // Auxilio Doença Previdenciario 50%[m
[32m+[m[32m  //       divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (this.dataFiliacao >= this.dataDib99){[m
[32m+[m[32m  //     switch(this.tipoBeneficio){[m
[32m+[m[32m  //       case 1: //Auxilio Doença Previdenciario[m
[32m+[m[32m  //       case 2: //Aposentadoria por invalidez previdenciaria[m
[32m+[m[32m  //         if (numeroContribuicoes >= 144 || this.withMemo) {[m
[32m+[m[32m  //           divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         }else{[m
[32m+[m[32m  //           divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 5: // Aposentadoria Especial[m
[32m+[m[32m  //       case 7: // Auxilio Acidente Previdenciario 50%[m
[32m+[m[32m  //         if (numeroContribuicoes < 144 || this.withMemo) {[m
[32m+[m[32m  //           divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //         }else{[m[41m                [m
[32m+[m[32m  //           divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 3 ://Aposentadoria Idade Trabalhador Urbano[m
[32m+[m[32m  //       case 4 ://Aposentadoria Tempo de Contribuicao[m
[32m+[m[32m  //       case 16://Aposentadoria Idade Trabalhafor Rural[m
[32m+[m[32m  //       case 25://Deficiencia Grave[m
[32m+[m[32m  //       case 27://Deficiencia Leva[m
[32m+[m[32m  //       case 26://Deficiencia Moderado[m
[32m+[m[32m  //       case 28://Deficiencia PorSalvar Idade[m
[32m+[m[32m  //         divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(this.dataFiliacao < this.dataDib99){[m
[32m+[m[32m  //     if(this.tipoBeneficio == 3 || this.tipoBeneficio == 4 || this.tipoBeneficio == 5 || this.tipoBeneficio == 6 ||[m[41m    [m
[32m+[m[32m  //     this.tipoBeneficio == 16 || this.tipoBeneficio == 25 || this.tipoBeneficio == 27 || this.tipoBeneficio == 26 ||[m[41m              [m
[32m+[m[32m  //     this.tipoBeneficio == 28){[m
[32m+[m[32m  //          // Deficiencia Por Idade, Deficiencia Grave, Deficiencia Leve, Deficiencia Moderada, Aposentadoria Idade trabalhador Rural,[m
[32m+[m[32m  //          // Aposentadoria Idade Urbano, Aposentadoria Tempo Contribuicao, Aposentadoria Especial, Aposentadoria Tempo Servico Professor[m
[32m+[m[32m  //       divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //       if (numeroContribuicoes < mesesContribuicao60) {[m
[32m+[m[32m  //         divisorMediaPrimaria = mesesContribuicao60[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       if (numeroContribuicoes >= mesesContribuicao60 && numeroContribuicoes <= mesesContribuicao80) {[m
[32m+[m[32m  //         if (this.withIN45) {[m
[32m+[m[32m  //           divisorMediaPrimaria = numeroContribuicoes;[m
[32m+[m[32m  //         }else{[m
[32m+[m[32m  //           divisorMediaPrimaria = Math.trunc((divisorMediaPrimaria * 0.8)-0.5);[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       if(divisorMediaPrimaria < divisorMinimo){[m
[32m+[m[32m  //         divisorMediaPrimaria = divisorMinimo;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let totalMediaDozeContribuicoes = 0;[m
[32m+[m[32m  //   switch(this.tipoBeneficio){[m
[32m+[m[32m  //     case 1: // Auxilio Doenca Previdenciario[m
[32m+[m[32m  //       if (this.dataInicioBeneficio >= this.dataMP664) {[m
[32m+[m[32m  //         let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m  //         if (numeroContribuicoes >= 12) {[m
[32m+[m[32m  //           let contribuicoesPrimarias12 = 0;[m
[32m+[m[32m  //           let contribuicoesSecundarias12 = 0;[m
[32m+[m[32m  //           for (let contribuicao of primeirasContribuicoes) {[m
[32m+[m[32m  //             contribuicoesPrimarias12 += contribuicao.valor_primario;[m
[32m+[m[32m  //             contribuicoesSecundarias12 += contribuicao.valor_secundario;[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //           let moeda = this.Moeda.getByDate(this.dataInicioBeneficio);// Carregar 1 linha da tabela moeda onde a data é menor ou igual que data_pedido_beneficio;[m
[32m+[m[32m  //           let salarioMinimoRMI = moeda.salario_minimo;[m
[32m+[m[32m  //           let divisorContribuicoes = this.formatDecimal((contribuicoesPrimarias12 + contribuicoesSecundarias12) /12 , 1);[m
[32m+[m[32m  //           if (divisorContribuicoes < salarioMinimoRMI) {[m
[32m+[m[32m  //             divisorContribuicoes = salarioMinimoRMI;[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //           totalMediaDozeContribuicoes = divisorContribuicoes;[m
[32m+[m[32m  //           // Inserir nas conclusoes:[m
[32m+[m[32m  //           //conclusoes.soma_doze_ultimas_contribuicoes = this.formatMoney(contribuicoesPrimarias12, currency.acronimo);[m
[32m+[m[32m  //           conclusoes.push({string:"Soma das 12 últimas contribuções", value:this.formatMoney(contribuicoesPrimarias12, currency.acronimo)});[m[41m  [m
[32m+[m[32m  //           //conclusoes.media_doze_ultimas_contribuicoes = this.formatMoney(divisorContribuicoes, currency.acronimo);[m
[32m+[m[32m  //           conclusoes.push({string:"Média das 12 últimas contribuções", value:this.formatMoney(divisorContribuicoes, currency.acronimo)});[m[41m [m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 2: //Aposentadoria por invalidez previdenciaria[m
[32m+[m[32m  //       if (this.dataInicioBeneficio >= this.dataDecreto6939_2009 && divisorMediaPrimaria > 1) {[m
[32m+[m[32m  //         divisorMediaPrimaria = this.formatDecimal((numeroContribuicoes * 0.8)-0.5, 1);[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m
[32m+[m[32m  //   tableData.sort((entry1, entry2) => {[m
[32m+[m[32m  //     if(entry1.valor_primario > entry2.valor_primario){[m
[32m+[m[32m  //       return 1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(entry1.valor_primario < entry2.valor_primario){[m
[32m+[m[32m  //       return -1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     return 0;[m
[32m+[m[32m  //   });[m
[32m+[m[32m  //   if (numeroContribuicoes > divisorMediaPrimaria){[m
[32m+[m[32m  //     totalContribuicaoPrimaria = 0[m
[32m+[m[32m  //     for(let i=0; i < tableData.length; i++){[m
[32m+[m[32m  //       if (i >= tableData.length-divisorMediaPrimaria) {[m
[32m+[m[32m  //         totalContribuicaoPrimaria += tableData[i].valor_primario;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         tableData[i].limite = "DESCONSIDERADO";[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   tableData.sort((entry1, entry2) => {[m
[32m+[m[32m  //     if(entry1.id > entry2.id){[m
[32m+[m[32m  //       return 1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if(entry1.id < entry2.id){[m
[32m+[m[32m  //       return -1;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     return 0;[m
[32m+[m[32m  //   });[m
[32m+[m[32m  //   let numeroCompetencias = this.getDifferenceInMonths(this.dataDib99, this.dataInicioBeneficio); // Calcular a quantidade de meses contida entre as duas datas.[m
[32m+[m
[32m+[m[32m  //   if (numeroCompetencias > 60) {[m
[32m+[m[32m  //       numeroCompetencias = 60;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let expectativa = this.projetarExpectativa(this.idadeFracionada, this.dataInicioBeneficio,conclusoes);[m
[32m+[m
[32m+[m[32m  //   let redutorProfessor = (this.tipoBeneficio == 6) ? 5 : 0;[m
[32m+[m[32m  //   let redutorSexo = (this.segurado.sexo == 'm') ? 0 : 5;[m
  [m
[31m-    let tempoTotalContribuicao = this.getTempoServico(redutorProfessor, redutorSexo, false);[m
[31m-[m
[31m-    let fatorSeguranca = 1;[m
[31m-    let aliquota = 0.31;[m
[31m-    let naoFocado = false;[m
[31m-[m
[31m-    switch(this.tipoBeneficio) {[m
[31m-      case 1: // Auxilio Doenca Previdenciario[m
[31m-      case 2:         // Aposentadoria Invalidez Previdenciaria;[m
[31m-      case 5:         // Aposentadoria Especial[m
[31m-      case 7:         // Auxiolio Acidente 50[m
[31m-        naoFocado = true;[m
[31m-        break;[m
[31m-      default:[m
[31m-        fatorSeguranca = ((tempoTotalContribuicao * aliquota) / expectativa) * (1 + this.idadeFracionada + (tempoTotalContribuicao * aliquota) / 100);[m
[31m-        // Adicionar nas conclusões a fórmula com os valores, não os resutlados:[m
[31m-       //conclusoes.formula_fator = "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)";[m
[31m-        conclusoes.push({string:"Fórmula Fator:",value: "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+this.idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)"});[m
[31m-        break;[m
[31m-    }[m
[31m-[m
[31m-    if (this.tipoBeneficio == 16|| // Aposentadoria Travalhador Rural[m
[31m-        this.tipoBeneficio ==  3|| // Aposentadoria Trabalhador Urbano[m
[31m-        this.tipoBeneficio == 25|| // Deficiencia Grave[m
[31m-        this.tipoBeneficio == 26|| // Deficiencia Leve[m
[31m-        this.tipoBeneficio == 27|| // Deficiencia Moderada[m
[31m-        this.tipoBeneficio == 28){  // Deficiencia Por Idade[m
[31m-        if (fatorSeguranca < 1) {[m
[31m-          fatorSeguranca = 1;[m
[31m-          naoFocado = true;[m
[31m-        }else if(fatorSeguranca > 1) {[m
[31m-          naoFocado = true;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    //Índice de Reajuste no Teto.[m
[31m-    let irt = 1;[m
[31m-[m
[31m-    let mediaContribuicoesPrimarias = totalContribuicaoPrimaria;[m
[31m-    if (divisorMediaPrimaria > 1) {[m
[31m-        mediaContribuicoesPrimarias /= divisorMediaPrimaria;[m
[31m-    }[m
[31m-[m
[31m-    let mediaContribuicoesSecundarias = totalContribuicaoSecundaria;[m
[31m-    if (divisorSecundario > 1) {[m
[31m-        mediaContribuicoesSecundarias /= divisorSecundario;    [m
[31m-    }[m
[31m-[m
[31m-    if (mediaContribuicoesSecundarias > moedaDib.teto) {[m
[31m-        mediaContribuicoesSecundarias = moedaDib.teto;[m
[31m-    }[m
[31m-[m
[31m-    this.limited = false;[m
[31m-[m
[31m-    let rmi = fatorSeguranca * numeroCompetencias * mediaContribuicoesPrimarias / 60;[m
[31m-[m
[31m-    rmi += mediaContribuicoesPrimarias * ((60 - numeroCompetencias) / 60);[m
[31m-[m
[31m-    let taxaSecundaria = 0;[m
[31m-    let taxaMediaSecundaria = 0;[m
[31m-[m
[31m-    if (mediaContribuicoesSecundarias != 0) {[m
[31m-      taxaSecundaria = this.getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario);[m
[31m-      taxaMediaSecundaria = mediaContribuicoesSecundarias * taxaSecundaria;[m
[31m-      if (taxaMediaSecundaria > mediaContribuicoesSecundarias) {[m
[31m-        taxaMediaSecundaria = mediaContribuicoesSecundarias;[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    let coeficiente = this.coeficiente;[m
[31m-[m
[31m-    let somaMedias = mediaContribuicoesPrimarias + taxaMediaSecundaria;[m
[31m-    let somaMediasAux = this.corrigirBeneficio(somaMedias, coeficiente, moedaDib);[m
[31m-[m
[31m-    if (this.limited){[m
[31m-      irt = (somaMedias * (coeficiente / 100))/somaMediasAux;[m
[31m-    }[m
[31m-[m
[31m-    rmi += (fatorSeguranca * numeroCompetencias) / 60;[m
[31m-    rmi += taxaMediaSecundaria * ((60 - numeroCompetencias) / 60)[m
[31m-    rmi *= (coeficiente / 100);[m
[31m-[m
[31m-    this.limited = false;[m
[31m-[m
[31m-    let rmiAux = this.corrigirBeneficio(rmi, coeficiente, moedaDib);[m
[31m-    rmi = rmiAux;[m
[31m-[m
[31m-    //let objMoeda = this.moeda[this.getIndex(this.dataInicioBeneficio)];//carregar apenas uma TMoeda onde currency Date é menor ou igual a Calculo.data_pedido_beneficio[m
[31m-    let objMoeda = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[31m-    let salarioAcidente = objMoeda.salario_minimo;[m
[31m-    if (mediaContribuicoesPrimarias > salarioAcidente) {[m
[31m-      switch(this.tipoBeneficio){[m
[31m-        case 17:// Auxilio Acidente 30[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.3;[m
[31m-          break;[m
[31m-        case 18: // Auxilio Acidente 40[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.4;[m
[31m-          break;[m
[31m-        case 7: // Auxilio Acidente 50[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.5;[m
[31m-          break;[m
[31m-        case 19: // Auxilio Acidente 60[m
[31m-          rmi = mediaContribuicoesPrimarias * 0.6;[m
[31m-          break;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    let somaContribuicoes = totalContribuicaoPrimaria + totalContribuicaoSecundaria;[m
[31m-[m
[31m-    let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-[m
[31m-    //conclusoes.coeficiente_calculo = coeficiente;//resultados['Coeficiente do Cálculo'] = coeficiente //Arrendodar para duas casas decimais;[m
[31m-    //conclusoes.soma_contribuicoes_primarias = this.formatMoney(totalContribuicoesPrimarias, currency.acronimo);//resultados['Soma das Contribuições Primarias'] = currency.acrônimo + totalContribuicoesPrimarias;[m
[31m-    //conclusoes.divisor_calculo_media_primaria = divisorMediaPrimaria;//resultados['Divisor do Cálculo da média primária: '] = divisorMediaPrimaria;[m
[31m-    //conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo);//resultados['Média das contribuições primárias'] = currency.acrônimo + mediaContribuicoesPrimarias;[m
[31m-    conclusoes.push({string:"Coeficiente do Cálculo:",value:coeficiente+'%'});[m
[31m-    conclusoes.push({string:"Soma das Contribuições Primarias:",value:this.formatMoney(totalContribuicaoPrimaria, currency.acronimo)});[m
[31m-    conclusoes.push({string:"Divisor do Cálculo da média primária:",value:divisorMediaPrimaria});[m
[31m-    conclusoes.push({string:"Média das contribuições primárias",value:this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo)});[m
[31m-[m
[31m-    if (totalContribuicaoSecundaria > 0) {[m
[31m-      conclusoes.push({string:"Soma das contribuições secundárias:",value:this.formatMoney(totalContribuicaoSecundaria, currency.acronimo)});//resultados['Soma das contribuições secundárias'] = currency.acrônumo + totalContribuicoesSecundarias;[m
[31m-      conclusoes.push({string:"Divisor do Cálculo da média secundária:",value:divisorSecundario});//resultados['Divisor do Cálculo da média secundária: '] = divisorMediaPrimaria;[m
[31m-      conclusoes.push({string:"Média das contribuições Secundárias:",value:this.formatMoney(mediaContribuicoesSecundarias, currency.acronimo)});//resultados['Média das contribuições Secundárias: '] =  currency.acrônumo + mediaContribuicoesSecundarias;[m
[31m-      conclusoes.push({string:"Taxa:",value:taxaSecundaria});//resultados['Taxa: '] =  taxaSecundaria;[m
[31m-      conclusoes.push({string:"Média Secundárias - Pós Taxa:",value:this.formatMoney(taxaSecundaria, currency.acronimo)});//resultados['Média Secundárias - Pós Taxa: '] =  currency.acrônimo + taxaSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    conclusoes.push({string:"Idade em anos:",value:Math.trunc(this.idadeFracionada)});//resultados['Idade em anos'] = truncate(idadeFracionada) (idadeFracionada);[m
[31m-    conclusoes.push({string:"Média das contribuições:",value:this.formatMoney(somaMedias, currency.acronimo)});//resultados['Média das contribuições'] = currency.acrônimo + somaMedias;[m
[31m-    conclusoes.push({string:"CT - Número de competências transcorridas desde 29/11/1999:",value:numeroCompetencias});//resultados['CT - Número de competências transcorridas desde 29/11/1999:'] = numeroCompetencias;[m
[31m-[m
[31m-    if (this.tipoBeneficio == 6 && redutorSexo == 5){[m
[31m-      this.contribuicaoTotal -= this.contribuicaoTotal - 5;[m
[31m-    }[m
[31m-[m
[31m-    let contribuicao85_95 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao86_96 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao87_97 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao88_98 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao89_99 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-    let contribuicao90_100 = this.contribuicaoTotal + this.idadeFracionada;[m
[31m-[m
[31m-    let dateFormat = "DD/MM/YYYY";[m
[31m-    let dataRegra85_95 = moment('17/06/2016', dateFormat);[m
[31m-    let dataRegra86_96 = moment('31/12/2018', dateFormat);[m
[31m-    let dataRegra87_97 = moment('31/12/2020', dateFormat);[m
[31m-    let dataRegra88_98 = moment('31/12/2022', dateFormat);[m
[31m-    let dataRegra89_99 = moment('31/12/2024', dateFormat);[m
[31m-    let dataRegra90_100 = moment('31/12/2026', dateFormat);[m
[31m-[m
[31m-    let dataFimRegra85_95 = moment('30/12/2018', dateFormat);[m
[31m-    let dataFimRegra86_96 = moment('30/12/2020', dateFormat);[m
[31m-    let dataFimRegra87_97 = moment('30/12/2022', dateFormat);[m
[31m-    let dataFimRegra88_98 = moment('30/12/2024', dateFormat);[m
[31m-    let dataFimRegra89_99 = moment('30/12/2026', dateFormat);[m
[31m-    let dataFimRegra90_100 = moment('30/12/2052', dateFormat);[m
[31m-[m
[31m-    let dataBeneficio = this.dataInicioBeneficio;[m
[31m-    let teto = moedaDib.teto;[m
[31m-    let minimo = moedaDib.salario_minimo;[m
[31m-[m
[31m-    let comparacaoContribuicao = 35 - redutorSexo;[m
[31m-    if(naoFocado){[m
[31m-      if(fatorSeguranca <= 1){[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator previdenciário'] = fatorSeguranca;[m
[31m-      }else{[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '(Incide fator previdenciario)'});//resultados['Fp - fator previdenciário'] = fatorSeguranca + '(Incide fator previdenciario)';[m
[31m-      }[m
[31m-    }else{[m
[31m-      if (dataBeneficio >= dataRegra85_95) {[m
[31m-        if (dataBeneficio <= dataFimRegra85_95) {[m
[31m-          if (fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao - redutorSexo && this.tipoBeneficio == 4) {[m
[31m-            somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-            conclusoes.push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias[m
[31m-          }else if(fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 6) {     [m
[31m-            somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-            conclusoes.push({string:"Renda Mensal Inicial com Regra 80/90:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 80/90: '] = currency.acronimo + somaMedias[m
[31m-          }else if(fatorSeguranca < 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 4) {[m
[31m-            somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)';[m
[31m-            conclusoes.contribuicao89_99push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias;[m
[31m-          }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[31m-            if (this.tipoBeneficio == 6) {[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[31m-            }else{[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[31m-            }[m
[31m-          }else if(fatorSeguranca > 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[31m-            if (this.tipoBeneficio == 6) {[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[31m-            }else{[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[31m-            }[m
[31m-          }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao >= comparacaoContribuicao) {[m
[31m-            if (this.tipoBeneficio == 6) {[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[31m-            }else{[m
[31m-              conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[31m-            }[m
[31m-          }else if(dataBeneficio < dataRegra85_95 || dataBeneficio > dataFimRegra85_95){[m
[31m-            conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator Previdenciario: '] = fatorSeguranca;[m
[31m-          }[m
[31m-        }else if(dataBeneficio >= dataRegra86_96 && dataBeneficio <= dataFimRegra86_96){[m
[31m-          this.tratamentoDeRegras(dataRegra86_96, dataFimRegra86_96, contribuicao86_96, 96, tempoTotalContribuicao, fatorSeguranca, '86/96', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra87_97  && dataBeneficio <= dataFimRegra87_97) {[m
[31m-          this.tratamentoDeRegras(dataRegra87_97, dataFimRegra87_97, contribuicao87_97, 97, tempoTotalContribuicao, fatorSeguranca, '87/97', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra88_98  && dataBeneficio <= dataFimRegra88_98) {[m
[31m-          this.tratamentoDeRegras(dataRegra88_98, dataFimRegra88_98, contribuicao88_98, 98, tempoTotalContribuicao, fatorSeguranca, '88/98', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra89_99  && dataBeneficio <= dataFimRegra89_99) {[m
[31m-          this.tratamentoDeRegras(dataRegra89_99, dataFimRegra89_99, contribuicao89_99, 99, tempoTotalContribuicao, fatorSeguranca, '89/99', comparacaoContribuicao, conclusoes);[m
[31m-        }else if(dataBeneficio >= dataRegra90_100  && dataBeneficio <= dataFimRegra90_100) {[m
[31m-          this.tratamentoDeRegras(dataRegra90_100, dataFimRegra90_100, contribuicao90_100, 100, tempoTotalContribuicao, fatorSeguranca, '90/100', comparacaoContribuicao, conclusoes);[m
[31m-        }[m
[31m-        }else{[m
[31m-          conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca;[m
[31m-        }[m
[31m-      }[m
[31m-        if (irt >= 1) {[m
[31m-          conclusoes.push({string:"Índice de reajuste no teto:",value:this.formatDecimal(irt, 4)});//resultados['Índice de reajuste no teto: '] = irt; // Arredondar para 4 casas decimais;[m
[31m-        }[m
[31m-[m
[31m-        conclusoes.push({string:"Expectativa de Sobrevida:",value:this.formatDecimal(expectativa, 4)});//resultados['Expectativa de Sobrevida: '] = expectativa; // Arredondar para 4 casas decimais;[m
[31m-[m
[31m-        if (this.tipoBeneficio == 29) {[m
[31m-          rmi = somaMedias * (coeficiente / 100);[m
[31m-          if (rmi <= moedaDib.salario_minimo) {[m
[31m-            rmi = moedaDib.salario_minimo;[m
[31m-          }[m
[31m-        }[m
[31m-[m
[31m-        if (dataBeneficio >= this.dataMP664) {[m
[31m-          if (this.tipoBeneficio == 1 && rmi > totalMediaDozeContribuicoes) {[m
[31m-            if (totalMediaDozeContribuicoes > 0) [m
[31m-              rmi = totalMediaDozeContribuicoes;[m
[31m-          }[m
[31m-          if (this.tipoBeneficio == 1) {[m
[31m-            let rmi2 = 0;[m
[31m-            rmi2 = somaMedias * (coeficiente / 100);[m
[31m-            conclusoes.push({string:"Média das contribuições x Coeficiente do Cálculo:",value:this.formatMoney(rmi2, currency.acronimo)});//resultados['Média das contribuições x Coeficiente do Cálculo: '] = currency.acronimo + rmi2;[m
[31m-          }[m
[31m-        }[m
[31m-[m
[31m-        if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[31m-          conclusoes.push({string:"Renda Mensal Inicial com Fator Previdenciario:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial com Fator Previdenciario: '] = currency.acronimo + rmi;[m
[31m-        }else{[m
[31m-          conclusoes.push({string:"Renda Mensal Inicial:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial: '] = currency.acronimo + rmi;[m
[31m-        }[m
[31m-        this.calculoApos99TableData = tableData;[m
[31m-        this.calculoApos99TableOptions = {[m
[31m-            ...this.calculoApos99TableOptions,[m
[31m-            data: this.calculoApos99TableData,[m
[31m-        }[m
[31m-        // TODO: Salvar Valor do Beneficio no Banco de Dados (rmi, somaContribuicoes);[m
[31m-  }[m
[31m-[m
[31m-  corrigirBeneficio(beneficio, coeficiente, moeda) {[m
[31m-    let beneficioCorrigido = beneficio;[m
[31m-    if (beneficio > moeda.teto){[m
[31m-      beneficioCorrigido = moeda.teto * coeficiente /100;[m
[31m-      this.limited = true;[m
[31m-    }[m
[31m-    if (beneficio < moeda.salario_minimo && this.tipoBeneficio != 7) {[m
[31m-      beneficioCorrigido = moeda.salario_minimo[m
[31m-    }[m
[31m-    return beneficioCorrigido;[m
[31m-  }[m
[31m-[m
[31m-  projetarExpectativa(idadeFracionada, dib, conclusoes) {[m
[31m-    let expectativa = 0;[m
[31m-[m
[31m-    let dataInicio = moment('2000-11-30');[m
[31m-    let dataFim = moment('2016-12-01');[m
[31m-    let dataHoje = moment();[m
[31m-[m
[31m-    if (dib > dataHoje) {[m
[31m-      let anos = dataHoje.diff(dib, 'years');[m
[31m-[m
[31m-      let tempo1 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-2, 'years')).year(), null, null);[m
[31m-      let tempo2 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-3, 'years')).year(), null, null);[m
[31m-      let tempo3 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-4, 'years')).year(), null, null);[m
[31m-      expectativa = (anos * Math.abs((tempo1 + tempo2 + tempo3) / 3) - tempo1) + tempo1;[m
[31m-      conclusoes.push({string:'Fórmula Expectativa de Sobrevida:' ,value: "("+anos+ " * (((" + tempo1 + " + " + tempo2 + "+" + tempo3 + ") / 3) -" + tempo1 + "))" + "+" + tempo1});//formula_expectativa_sobrevida = "(anos * (((tempo1 + tempo2 + tempo3) / 3) - tempo1)) + tempo1";[m
[31m-    } else if (dib <= dataInicio) {[m
[31m-      expectativa = this.procurarExpectativa(idadeFracionada, null, null, dataInicio);[m
[31m-    } else if (dib >= dataFim) {[m
[31m-      expectativa = this.procurarExpectativa(idadeFracionada, null, dib, null);[m
[31m-    } else {[m
[31m-      expectativa = this.procurarExpectativa(idadeFracionada, null, dib, dib);[m
[31m-    }[m
[31m-[m
[31m-    if (expectativa <= 0) {[m
[31m-      expectativa = 6;[m
[31m-    }[m
[31m-[m
[31m-    return expectativa;[m
[31m-  }[m
[31m-[m
[31m-  procurarExpectativa(idadeFracionada, ano, dataInicio, dataFim) {[m
[31m-    let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[31m-    let dataAgora = moment();[m
[31m-    let expectativaVida;[m
[31m-    if (idadeFracionada > 80){[m
[31m-      idadeFracionada = 80;[m
[31m-    }    [m
[31m-    if (ano != null) {[m
[31m-      expectativaVida = this.ExpectativaVida.getByAno(ano);//Carregar do BD na tabela ExpectativaVida onde age == idadeFracionada e year == ano[m
[31m-    }else{[m
[31m-      expectativaVida = this.ExpectativaVida.getByDates(dataInicio, dataFim);[m
[31m-    }[m
[31m-    return expectativaVida;[m
[31m-  }[m
[31m-[m
[31m-  tratamentoDeRegras(dataRegra, dataFimRegra, valorRegra, valorComparacao, tempoTotalContribuicao, fatorSeguranca, resultString, comparacaoTempoContribuicao, conclusoes) {[m
[31m-    let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[31m-    let somaMedias;[m
[31m-    if (fatorSeguranca >= 1 && valorRegra >=  valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao && this.tipoBeneficio == 4) {[m
[31m-      somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-      conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[31m-      //resultados['Renda Mensal Inicial com Regra ' + resultString + ': '] = currency.acronimo + somaMedias;[m
[31m-    }else if(fatorSeguranca >= 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao){[m
[31m-      if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[31m-        somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[31m-        conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[31m-        //resultados['Renda Mensal Inicial com Regra'+ resultString + ' : '] = currency.acronimo + somaMedias[m
[31m-      }[m
[31m-    }else if(fatorSeguranca < 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[31m-      if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[31m-        somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString + ')'});//conclusoes.fator_previdenciario = fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString+ ')';[m
[31m-        conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[31m-        //resultados['specieKind = 4Renda Mensal Inicial com Regra'+ resultString + ': '] = currency.acronimo + somaMedias;[m
[31m-      }[m
[31m-    }else if(fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao){[m
[31m-      if (this.tipoBeneficio == 6 || this.tipoBeneficio == 4) {[m
[31m-        conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra' + resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra' + resultString;[m
[31m-      }[m
[31m-    }else if (fatorSeguranca > 1 && valorRegra >= valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao) {[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)'});//conclusoes.fator_previdenciario =  fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)';[m
[31m-    }else if (fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra '+ resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra'+ resultString;[m
[31m-    }else if (this.dataInicioBeneficio < dataRegra || this.dataInicioBeneficio > dataFimRegra){[m
[31m-      conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//conclusoes.fator_previdenciario = fatorSeguranca;[m
[31m-    }[m
[31m-  }[m
[31m-[m
[31m-  getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario) {[m
[31m-    let taxaSecundaria = 0;[m
[31m-    let tempoServicoSecundario = this.getTempoServico(0,0,true);[m
[31m-    let quantidadePBCSecudaria = contadorSecundario;[m
[31m-[m
[31m-    let specieKind;[m
[31m-    if(this.tipoBeneficio == 4 || this.tipoBeneficio ==  5 || this.tipoBeneficio ==  6 ||[m
[31m-      this.tipoBeneficio == 8 || this.tipoBeneficio ==  9 || this.tipoBeneficio ==  10 ||[m
[31m-      this.tipoBeneficio == 14 || this.tipoBeneficio ==  15){[m
[31m-      specieKind = 1;[m
[31m-    }else if(this.tipoBeneficio == 3 || this.tipoBeneficio == 16|| this.tipoBeneficio == 13){[m
[31m-      specieKind = 2;[m
[31m-    }else if(this.tipoBeneficio == 1 || this.tipoBeneficio == 2 || this.tipoBeneficio == 11[m
[31m-             || this.tipoBeneficio == 29){[m
[31m-      specieKind = 3;[m
[31m-    }else if(this.tipoBeneficio == 25){[m
[31m-      specieKind = 4;[m
[31m-    }else{[m
[31m-      specieKind = null;[m
[31m-    }[m
[31m-[m
[31m-    let tempoServico = 0;[m
[31m-    switch(specieKind){[m
[31m-      case 1:[m
[31m-        tempoServico = tempoServicoSecundario / 365;   [m
[31m-        let redutorProporcional = 0;[m
[31m-        if(this.isProportional){[m
[31m-            redutorProporcional = 5;[m
[31m-        }[m
[31m-        taxaSecundaria = tempoServico / (35 - redutorProfessor - redutorSexo - redutorProporcional);[m
[31m-        break;[m
[31m-      case 2:[m
[31m-        tempoServico = tempoServicoSecundario / 30;[m
[31m-        let carenciaMeses = this.getMesesCarencia();[m
[31m-        taxaSecundaria = tempoServico / carenciaMeses;[m
[31m-        break;[m
[31m-      case 3:[m
[31m-          taxaSecundaria = quantidadePBCSecudaria / 12;[m
[31m-          break;[m
[31m-      case 4:[m
[31m-        tempoServico = tempoServicoSecundario / 365;[m
[31m-        if(redutorSexo == 5){[m
[31m-          taxaSecundaria = tempoServico / 20;[m
[31m-        }else{[m
[31m-          taxaSecundaria = tempoServico / 25;[m
[31m-        }[m
[31m-        break;[m
[31m-      case 5:[m
[31m-        tempoServico = tempoServicoSecundario / 365;[m
[31m-        if(redutorSexo == 5){[m
[31m-          taxaSecundaria = tempoServico / 23;[m
[31m-        }else{[m
[31m-          taxaSecundaria = tempoServico / 28;[m
[31m-        }[m
[31m-        break;[m
[31m-      case 6:[m
[31m-        tempoServico = tempoServicoSecundario / 365;[m
[31m-        if(redutorSexo == 5){[m
[31m-          taxaSecundaria = tempoServico / 28;[m
[31m-        }else{[m
[31m-          taxaSecundaria = tempoServico / 33;[m
[31m-        }[m
[31m-        break;[m
[31m-    }[m
[31m-    return taxaSecundaria;[m
[31m-  }[m
[31m-[m
[31m-  getMesesCarencia(){[m
[31m-    let mesesCarencia = 180;[m
[31m-    if (this.dataFiliacao <= this.dataLei8213) {[m
[31m-      let progressiveLack = this.CarenciaProgressiva.getCarencia(this.dataInicioBeneficio.year());[m
[31m-      if(progressiveLack != 0){[m
[31m-        mesesCarencia = progressiveLack;[m
[31m-      }[m
[31m-    }[m
[31m-    return mesesCarencia;[m
[31m-  }[m
[31m-  [m
[31m-  getTempoServico(redutorProfessor, redutorSexo, secundario) {[m
[31m-    let tempo;[m
[31m-[m
[31m-    if(secundario){[m
[31m-      tempo = this.contribuicaoSecundaria99;[m
[31m-      let contagemSecundaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[31m-      return contagemSecundaria;[m
[31m-    }[m
[31m-[m
[31m-    tempo = this.contribuicaoPrimaria99;[m
[31m-    let contagemPrimaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[31m-    let contagemPrimariaAnos = contagemPrimaria / 365;[m
[31m-    if (this.tipoBeneficio == 6) { // Tempo de Serviço Professor[m
[31m-      contagemPrimariaAnos += redutorProfessor + redutorSexo;[m
[31m-    }[m
[31m-[m
[31m-    this.contribuicaoTotal = contagemPrimariaAnos; [m
[31m-[m
[31m-    if (redutorSexo > 0) {[m
[31m-      if (this.tipoBeneficio == 16 || this.tipoBeneficio == 3 || this.tipoBeneficio == 4) {[m
[31m-        contagemPrimariaAnos += redutorSexo;[m
[31m-      }[m
[31m-    }[m
[31m-    return contagemPrimariaAnos;[m
[31m-  }[m
[31m-[m
[31m-  getIndiceEspecie(especie, sexo, anoContribuicao){[m
[31m-		let indiceAno = 0.0[m
[31m-    if (anoContribuicao != 0 ) {[m
[31m-        indiceAno = anoContribuicao / 100;[m
[31m-    }[m
[31m-[m
[31m-    let index = 0.0;[m
[31m-    switch (especie){[m
[31m-      case 1: {// Auxílio Doença[m
[31m-      	index = 0.7;[m
[31m-        if (indiceAno > 0.2){[m
[31m-        	indiceAno = 0.2;[m
[31m-        }[m
[31m-        index += indiceAno;[m
[31m-        break;[m
[31m-      }[m
[31m-      case 2: {// Aposentadoria por invalidez[m
[31m-      	index = 0.7;[m
[31m-      	if (indiceAno > 0.3){[m
[31m-      	    indiceAno = 0.3;[m
[31m-      	}[m
[31m-      	index += indiceAno;[m
[31m-      	break;[m
[31m-      }[m
[31m-      case 3: { // Idade - trabalhador Rural[m
[31m-        index = 0.7;[m
[31m-        if (indiceAno > 0.25) {[m
[31m-        	indiceAno = 0.25;[m
[31m-        }[m
[31m-        index += indiceAno;[m
[31m-        break;[m
[31m-      }[m
[31m-      case 5: { // Idade - trabalhador Urbano[m
[31m-        index = 0.7;[m
[31m-        if (indiceAno > 0.25){[m
[31m-					indiceAno = 0.25;[m
[31m-				}[m
[31m-        index += indiceAno;[m
[31m-      	break;[m
[31m-      }[m
[31m-      case 16: {//Aposentadoria Especial.[m
[31m-      	index = 0.7;[m
[31m-        if (indiceAno > 0.25){[m
[31m-        	indiceAno = 0.25;[m
[31m-        }[m
[31m-        index += indiceAno;[m
[31m-        break;[m
[31m-      }[m
[31m-      case 4: {  // Aposentadoria por tempo de contribuição[m
[31m-      	if(sexo === 'm'){[m
[31m-      	  index = 0.8;[m
[31m-      	  let indiceAnoAux = anoContribuicao - 30;[m
[31m-      	  if(indiceAnoAux > 5){[m
[31m-      	  	indiceAnoAux = 5;[m
[31m-      	  }[m
[31m-      	  if(indiceAnoAux < 0){[m
[31m-      	  	indiceAnoAux = 0;[m
[31m-      	  }[m
[31m-      	  index += (0.03 * indiceAnoAux);[m
[31m-      	}else{[m
[31m-      	    index = 0.95;[m
[31m-      	}[m
[31m-      	break;[m
[31m-      }[m
[31m-      case 20: { [m
[31m-        index = 0.2;[m
[31m-        break;[m
[31m-      }[m
[31m-      default:{[m
[31m-      	index = 0;[m
[31m-      	break;[m
[31m-      }[m
[31m-    }[m
[31m-    return index;[m
[31m-  }[m
[31m-[m
[31m-  getEspecieBeneficio(){[m
[32m+[m[32m  //   let tempoTotalContribuicao = this.getTempoServico(redutorProfessor, redutorSexo, false);[m
[32m+[m
[32m+[m[32m  //   let fatorSeguranca = 1;[m
[32m+[m[32m  //   let aliquota = 0.31;[m
[32m+[m[32m  //   let naoFocado = false;[m
[32m+[m
[32m+[m[32m  //   switch(this.tipoBeneficio) {[m
[32m+[m[32m  //     case 1: // Auxilio Doenca Previdenciario[m
[32m+[m[32m  //     case 2:         // Aposentadoria Invalidez Previdenciaria;[m
[32m+[m[32m  //     case 5:         // Aposentadoria Especial[m
[32m+[m[32m  //     case 7:         // Auxiolio Acidente 50[m
[32m+[m[32m  //       naoFocado = true;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     default:[m
[32m+[m[32m  //       fatorSeguranca = ((tempoTotalContribuicao * aliquota) / expectativa) * (1 + this.idadeFracionada + (tempoTotalContribuicao * aliquota) / 100);[m
[32m+[m[32m  //       // Adicionar nas conclusões a fórmula com os valores, não os resutlados:[m
[32m+[m[32m  //      //conclusoes.formula_fator = "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)";[m
[32m+[m[32m  //       conclusoes.push({string:"Fórmula Fator:",value: "(("+tempoTotalContribuicao +'*'+ aliquota+") / "+expectativa+") * (1 + ("+this.idadeFracionada+" + ("+tempoTotalContribuicao+" * "+aliquota+")) / "+"100)"});[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 16|| // Aposentadoria Travalhador Rural[m
[32m+[m[32m  //       this.tipoBeneficio ==  3|| // Aposentadoria Trabalhador Urbano[m
[32m+[m[32m  //       this.tipoBeneficio == 25|| // Deficiencia Grave[m
[32m+[m[32m  //       this.tipoBeneficio == 26|| // Deficiencia Leve[m
[32m+[m[32m  //       this.tipoBeneficio == 27|| // Deficiencia Moderada[m
[32m+[m[32m  //       this.tipoBeneficio == 28){  // Deficiencia Por Idade[m
[32m+[m[32m  //       if (fatorSeguranca < 1) {[m
[32m+[m[32m  //         fatorSeguranca = 1;[m
[32m+[m[32m  //         naoFocado = true;[m
[32m+[m[32m  //       }else if(fatorSeguranca > 1) {[m
[32m+[m[32m  //         naoFocado = true;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   //Índice de Reajuste no Teto.[m
[32m+[m[32m  //   let irt = 1;[m
[32m+[m
[32m+[m[32m  //   let mediaContribuicoesPrimarias = totalContribuicaoPrimaria;[m
[32m+[m[32m  //   if (divisorMediaPrimaria > 1) {[m
[32m+[m[32m  //       mediaContribuicoesPrimarias /= divisorMediaPrimaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let mediaContribuicoesSecundarias = totalContribuicaoSecundaria;[m
[32m+[m[32m  //   if (divisorSecundario > 1) {[m
[32m+[m[32m  //       mediaContribuicoesSecundarias /= divisorSecundario;[m[41m    [m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (mediaContribuicoesSecundarias > moedaDib.teto) {[m
[32m+[m[32m  //       mediaContribuicoesSecundarias = moedaDib.teto;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   this.limited = false;[m
[32m+[m
[32m+[m[32m  //   let rmi = fatorSeguranca * numeroCompetencias * mediaContribuicoesPrimarias / 60;[m
[32m+[m
[32m+[m[32m  //   rmi += mediaContribuicoesPrimarias * ((60 - numeroCompetencias) / 60);[m
[32m+[m
[32m+[m[32m  //   let taxaSecundaria = 0;[m
[32m+[m[32m  //   let taxaMediaSecundaria = 0;[m
[32m+[m
[32m+[m[32m  //   if (mediaContribuicoesSecundarias != 0) {[m
[32m+[m[32m  //     taxaSecundaria = this.getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario);[m
[32m+[m[32m  //     taxaMediaSecundaria = mediaContribuicoesSecundarias * taxaSecundaria;[m
[32m+[m[32m  //     if (taxaMediaSecundaria > mediaContribuicoesSecundarias) {[m
[32m+[m[32m  //       taxaMediaSecundaria = mediaContribuicoesSecundarias;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let coeficiente = this.coeficiente;[m
[32m+[m
[32m+[m[32m  //   let somaMedias = mediaContribuicoesPrimarias + taxaMediaSecundaria;[m
[32m+[m[32m  //   let somaMediasAux = this.corrigirBeneficio(somaMedias, coeficiente, moedaDib);[m
[32m+[m
[32m+[m[32m  //   if (this.limited){[m
[32m+[m[32m  //     irt = (somaMedias * (coeficiente / 100))/somaMediasAux;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   rmi += (fatorSeguranca * numeroCompetencias) / 60;[m
[32m+[m[32m  //   rmi += taxaMediaSecundaria * ((60 - numeroCompetencias) / 60)[m
[32m+[m[32m  //   rmi *= (coeficiente / 100);[m
[32m+[m
[32m+[m[32m  //   this.limited = false;[m
[32m+[m
[32m+[m[32m  //   let rmiAux = this.corrigirBeneficio(rmi, coeficiente, moedaDib);[m
[32m+[m[32m  //   rmi = rmiAux;[m
[32m+[m
[32m+[m[32m  //   //let objMoeda = this.moeda[this.getIndex(this.dataInicioBeneficio)];//carregar apenas uma TMoeda onde currency Date é menor ou igual a Calculo.data_pedido_beneficio[m
[32m+[m[32m  //   let objMoeda = this.Moeda.getByDate(this.dataInicioBeneficio);[m
[32m+[m[32m  //   let salarioAcidente = objMoeda.salario_minimo;[m
[32m+[m[32m  //   if (mediaContribuicoesPrimarias > salarioAcidente) {[m
[32m+[m[32m  //     switch(this.tipoBeneficio){[m
[32m+[m[32m  //       case 17:// Auxilio Acidente 30[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.3;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 18: // Auxilio Acidente 40[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.4;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 7: // Auxilio Acidente 50[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.5;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       case 19: // Auxilio Acidente 60[m
[32m+[m[32m  //         rmi = mediaContribuicoesPrimarias * 0.6;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let somaContribuicoes = totalContribuicaoPrimaria + totalContribuicaoSecundaria;[m
[32m+[m
[32m+[m[32m  //   let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m
[32m+[m[32m  //   //conclusoes.coeficiente_calculo = coeficiente;//resultados['Coeficiente do Cálculo'] = coeficiente //Arrendodar para duas casas decimais;[m
[32m+[m[32m  //   //conclusoes.soma_contribuicoes_primarias = this.formatMoney(totalContribuicoesPrimarias, currency.acronimo);//resultados['Soma das Contribuições Primarias'] = currency.acrônimo + totalContribuicoesPrimarias;[m
[32m+[m[32m  //   //conclusoes.divisor_calculo_media_primaria = divisorMediaPrimaria;//resultados['Divisor do Cálculo da média primária: '] = divisorMediaPrimaria;[m
[32m+[m[32m  //   //conclusoes.media_contribuicoes_primarias = this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo);//resultados['Média das contribuições primárias'] = currency.acrônimo + mediaContribuicoesPrimarias;[m
[32m+[m[32m  //   conclusoes.push({string:"Coeficiente do Cálculo:",value:coeficiente+'%'});[m
[32m+[m[32m  //   conclusoes.push({string:"Soma das Contribuições Primarias:",value:this.formatMoney(totalContribuicaoPrimaria, currency.acronimo)});[m
[32m+[m[32m  //   conclusoes.push({string:"Divisor do Cálculo da média primária:",value:divisorMediaPrimaria});[m
[32m+[m[32m  //   conclusoes.push({string:"Média das contribuições primárias",value:this.formatMoney(mediaContribuicoesPrimarias, currency.acronimo)});[m
[32m+[m
[32m+[m[32m  //   if (totalContribuicaoSecundaria > 0) {[m
[32m+[m[32m  //     conclusoes.push({string:"Soma das contribuições secundárias:",value:this.formatMoney(totalContribuicaoSecundaria, currency.acronimo)});//resultados['Soma das contribuições secundárias'] = currency.acrônumo + totalContribuicoesSecundarias;[m
[32m+[m[32m  //     conclusoes.push({string:"Divisor do Cálculo da média secundária:",value:divisorSecundario});//resultados['Divisor do Cálculo da média secundária: '] = divisorMediaPrimaria;[m
[32m+[m[32m  //     conclusoes.push({string:"Média das contribuições Secundárias:",value:this.formatMoney(mediaContribuicoesSecundarias, currency.acronimo)});//resultados['Média das contribuições Secundárias: '] =  currency.acrônumo + mediaContribuicoesSecundarias;[m
[32m+[m[32m  //     conclusoes.push({string:"Taxa:",value:taxaSecundaria});//resultados['Taxa: '] =  taxaSecundaria;[m
[32m+[m[32m  //     conclusoes.push({string:"Média Secundárias - Pós Taxa:",value:this.formatMoney(taxaSecundaria, currency.acronimo)});//resultados['Média Secundárias - Pós Taxa: '] =  currency.acrônimo + taxaSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   conclusoes.push({string:"Idade em anos:",value:Math.trunc(this.idadeFracionada)});//resultados['Idade em anos'] = truncate(idadeFracionada) (idadeFracionada);[m
[32m+[m[32m  //   conclusoes.push({string:"Média das contribuições:",value:this.formatMoney(somaMedias, currency.acronimo)});//resultados['Média das contribuições'] = currency.acrônimo + somaMedias;[m
[32m+[m[32m  //   conclusoes.push({string:"CT - Número de competências transcorridas desde 29/11/1999:",value:numeroCompetencias});//resultados['CT - Número de competências transcorridas desde 29/11/1999:'] = numeroCompetencias;[m
[32m+[m
[32m+[m[32m  //   if (this.tipoBeneficio == 6 && redutorSexo == 5){[m
[32m+[m[32m  //     this.contribuicaoTotal -= this.contribuicaoTotal - 5;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let contribuicao85_95 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao86_96 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao87_97 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao88_98 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao89_99 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m[32m  //   let contribuicao90_100 = this.contribuicaoTotal + this.idadeFracionada;[m
[32m+[m
[32m+[m[32m  //   let dateFormat = "DD/MM/YYYY";[m
[32m+[m[32m  //   let dataRegra85_95 = moment('17/06/2016', dateFormat);[m
[32m+[m[32m  //   let dataRegra86_96 = moment('31/12/2018', dateFormat);[m
[32m+[m[32m  //   let dataRegra87_97 = moment('31/12/2020', dateFormat);[m
[32m+[m[32m  //   let dataRegra88_98 = moment('31/12/2022', dateFormat);[m
[32m+[m[32m  //   let dataRegra89_99 = moment('31/12/2024', dateFormat);[m
[32m+[m[32m  //   let dataRegra90_100 = moment('31/12/2026', dateFormat);[m
[32m+[m
[32m+[m[32m  //   let dataFimRegra85_95 = moment('30/12/2018', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra86_96 = moment('30/12/2020', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra87_97 = moment('30/12/2022', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra88_98 = moment('30/12/2024', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra89_99 = moment('30/12/2026', dateFormat);[m
[32m+[m[32m  //   let dataFimRegra90_100 = moment('30/12/2052', dateFormat);[m
[32m+[m
[32m+[m[32m  //   let dataBeneficio = this.dataInicioBeneficio;[m
[32m+[m[32m  //   let teto = moedaDib.teto;[m
[32m+[m[32m  //   let minimo = moedaDib.salario_minimo;[m
[32m+[m
[32m+[m[32m  //   let comparacaoContribuicao = 35 - redutorSexo;[m
[32m+[m[32m  //   if(naoFocado){[m
[32m+[m[32m  //     if(fatorSeguranca <= 1){[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator previdenciário'] = fatorSeguranca;[m
[32m+[m[32m  //     }else{[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '(Incide fator previdenciario)'});//resultados['Fp - fator previdenciário'] = fatorSeguranca + '(Incide fator previdenciario)';[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     if (dataBeneficio >= dataRegra85_95) {[m
[32m+[m[32m  //       if (dataBeneficio <= dataFimRegra85_95) {[m
[32m+[m[32m  //         if (fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao - redutorSexo && this.tipoBeneficio == 4) {[m
[32m+[m[32m  //           somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //           conclusoes.push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias[m
[32m+[m[32m  //         }else if(fatorSeguranca >= 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 6) {[m[41m     [m
[32m+[m[32m  //           somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //           conclusoes.push({string:"Renda Mensal Inicial com Regra 80/90:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 80/90: '] = currency.acronimo + somaMedias[m
[32m+[m[32m  //         }else if(fatorSeguranca < 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao >= comparacaoContribuicao && this.tipoBeneficio == 4) {[m
[32m+[m[32m  //           somaMedias = (this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio)).valor;[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)'});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca + '- FP desfavorável (Aplica-se a regra 85/95)';[m
[32m+[m[32m  //           conclusoes.contribuicao89_99push({string:"Renda Mensal Inicial com Regra 85/95:",value:currency.acronimo + somaMedias});//resultados['Renda Mensal Inicial com Regra 85/95: '] = currency.acronimo + somaMedias;[m
[32m+[m[32m  //         }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[32m+[m[32m  //           if (this.tipoBeneficio == 6) {[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[32m+[m[32m  //           }else{[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //         }else if(fatorSeguranca > 1 && contribuicao85_95 >= 95 && tempoTotalContribuicao < comparacaoContribuicao) {[m
[32m+[m[32m  //           if (this.tipoBeneficio == 6) {[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[32m+[m[32m  //           }else{[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //         }else if(fatorSeguranca < 1 && contribuicao85_95 < 95 && tempoTotalContribuicao >= comparacaoContribuicao) {[m
[32m+[m[32m  //           if (this.tipoBeneficio == 6) {[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 80/90'});//resultados['Fp - Fator Previdenciario: '] =  fatorSeguranca + '- Não tem direito a Regra 80/90';[m
[32m+[m[32m  //           }else{[m
[32m+[m[32m  //             conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra 85/95'});//resultados['Fp - Fator Previdenciario: '] =   fatorSeguranca + '- Não tem direito a Regra 85/95';[m
[32m+[m[32m  //           }[m
[32m+[m[32m  //         }else if(dataBeneficio < dataRegra85_95 || dataBeneficio > dataFimRegra85_95){[m
[32m+[m[32m  //           conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - fator Previdenciario: '] = fatorSeguranca;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra86_96 && dataBeneficio <= dataFimRegra86_96){[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra86_96, dataFimRegra86_96, contribuicao86_96, 96, tempoTotalContribuicao, fatorSeguranca, '86/96', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra87_97  && dataBeneficio <= dataFimRegra87_97) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra87_97, dataFimRegra87_97, contribuicao87_97, 97, tempoTotalContribuicao, fatorSeguranca, '87/97', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra88_98  && dataBeneficio <= dataFimRegra88_98) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra88_98, dataFimRegra88_98, contribuicao88_98, 98, tempoTotalContribuicao, fatorSeguranca, '88/98', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra89_99  && dataBeneficio <= dataFimRegra89_99) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra89_99, dataFimRegra89_99, contribuicao89_99, 99, tempoTotalContribuicao, fatorSeguranca, '89/99', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }else if(dataBeneficio >= dataRegra90_100  && dataBeneficio <= dataFimRegra90_100) {[m
[32m+[m[32m  //         this.tratamentoDeRegras(dataRegra90_100, dataFimRegra90_100, contribuicao90_100, 100, tempoTotalContribuicao, fatorSeguranca, '90/100', comparacaoContribuicao, conclusoes);[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//resultados['Fp - Fator Previdenciário: '] = fatorSeguranca;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //       if (irt >= 1) {[m
[32m+[m[32m  //         conclusoes.push({string:"Índice de reajuste no teto:",value:this.formatDecimal(irt, 4)});//resultados['Índice de reajuste no teto: '] = irt; // Arredondar para 4 casas decimais;[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       conclusoes.push({string:"Expectativa de Sobrevida:",value:this.formatDecimal(expectativa, 4)});//resultados['Expectativa de Sobrevida: '] = expectativa; // Arredondar para 4 casas decimais;[m
[32m+[m
[32m+[m[32m  //       if (this.tipoBeneficio == 29) {[m
[32m+[m[32m  //         rmi = somaMedias * (coeficiente / 100);[m
[32m+[m[32m  //         if (rmi <= moedaDib.salario_minimo) {[m
[32m+[m[32m  //           rmi = moedaDib.salario_minimo;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       if (dataBeneficio >= this.dataMP664) {[m
[32m+[m[32m  //         if (this.tipoBeneficio == 1 && rmi > totalMediaDozeContribuicoes) {[m
[32m+[m[32m  //           if (totalMediaDozeContribuicoes > 0)[m[41m [m
[32m+[m[32m  //             rmi = totalMediaDozeContribuicoes;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //         if (this.tipoBeneficio == 1) {[m
[32m+[m[32m  //           let rmi2 = 0;[m
[32m+[m[32m  //           rmi2 = somaMedias * (coeficiente / 100);[m
[32m+[m[32m  //           conclusoes.push({string:"Média das contribuições x Coeficiente do Cálculo:",value:this.formatMoney(rmi2, currency.acronimo)});//resultados['Média das contribuições x Coeficiente do Cálculo: '] = currency.acronimo + rmi2;[m
[32m+[m[32m  //         }[m
[32m+[m[32m  //       }[m
[32m+[m
[32m+[m[32m  //       if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6 || this.tipoBeneficio == 3 || this.tipoBeneficio == 16) {[m
[32m+[m[32m  //         conclusoes.push({string:"Renda Mensal Inicial com Fator Previdenciario:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial com Fator Previdenciario: '] = currency.acronimo + rmi;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         conclusoes.push({string:"Renda Mensal Inicial:",value:this.formatMoney(rmi, currency.acronimo)});//resultados['Renda Mensal Inicial: '] = currency.acronimo + rmi;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       this.calculoApos99TableData = tableData;[m
[32m+[m[32m  //       this.calculoApos99TableOptions = {[m
[32m+[m[32m  //           ...this.calculoApos99TableOptions,[m
[32m+[m[32m  //           data: this.calculoApos99TableData,[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       // TODO: Salvar Valor do Beneficio no Banco de Dados (rmi, somaContribuicoes);[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // corrigirBeneficio(beneficio, coeficiente, moeda) {[m
[32m+[m[32m  //   let beneficioCorrigido = beneficio;[m
[32m+[m[32m  //   if (beneficio > moeda.teto){[m
[32m+[m[32m  //     beneficioCorrigido = moeda.teto * coeficiente /100;[m
[32m+[m[32m  //     this.limited = true;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   if (beneficio < moeda.salario_minimo && this.tipoBeneficio != 7) {[m
[32m+[m[32m  //     beneficioCorrigido = moeda.salario_minimo[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return beneficioCorrigido;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // projetarExpectativa(idadeFracionada, dib, conclusoes) {[m
[32m+[m[32m  //   let expectativa = 0;[m
[32m+[m
[32m+[m[32m  //   let dataInicio = moment('2000-11-30');[m
[32m+[m[32m  //   let dataFim = moment('2016-12-01');[m
[32m+[m[32m  //   let dataHoje = moment();[m
[32m+[m
[32m+[m[32m  //   if (dib > dataHoje) {[m
[32m+[m[32m  //     let anos = dataHoje.diff(dib, 'years');[m
[32m+[m
[32m+[m[32m  //     let tempo1 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-2, 'years')).year(), null, null);[m
[32m+[m[32m  //     let tempo2 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-3, 'years')).year(), null, null);[m
[32m+[m[32m  //     let tempo3 = this.procurarExpectativa(idadeFracionada, ((dataHoje.clone()).add(-4, 'years')).year(), null, null);[m
[32m+[m[32m  //     expectativa = (anos * Math.abs((tempo1 + tempo2 + tempo3) / 3) - tempo1) + tempo1;[m
[32m+[m[32m  //     conclusoes.push({string:'Fórmula Expectativa de Sobrevida:' ,value: "("+anos+ " * (((" + tempo1 + " + " + tempo2 + "+" + tempo3 + ") / 3) -" + tempo1 + "))" + "+" + tempo1});//formula_expectativa_sobrevida = "(anos * (((tempo1 + tempo2 + tempo3) / 3) - tempo1)) + tempo1";[m
[32m+[m[32m  //   } else if (dib <= dataInicio) {[m
[32m+[m[32m  //     expectativa = this.procurarExpectativa(idadeFracionada, null, null, dataInicio);[m
[32m+[m[32m  //   } else if (dib >= dataFim) {[m
[32m+[m[32m  //     expectativa = this.procurarExpectativa(idadeFracionada, null, dib, null);[m
[32m+[m[32m  //   } else {[m
[32m+[m[32m  //     expectativa = this.procurarExpectativa(idadeFracionada, null, dib, dib);[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if (expectativa <= 0) {[m
[32m+[m[32m  //     expectativa = 6;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   return expectativa;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // procurarExpectativa(idadeFracionada, ano, dataInicio, dataFim) {[m
[32m+[m[32m  //   let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[32m+[m[32m  //   let dataAgora = moment();[m
[32m+[m[32m  //   let expectativaVida;[m
[32m+[m[32m  //   if (idadeFracionada > 80){[m
[32m+[m[32m  //     idadeFracionada = 80;[m
[32m+[m[32m  //   }[m[41m    [m
[32m+[m[32m  //   if (ano != null) {[m
[32m+[m[32m  //     expectativaVida = this.ExpectativaVida.getByAno(ano);//Carregar do BD na tabela ExpectativaVida onde age == idadeFracionada e year == ano[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     expectativaVida = this.ExpectativaVida.getByDates(dataInicio, dataFim);[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return expectativaVida;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // tratamentoDeRegras(dataRegra, dataFimRegra, valorRegra, valorComparacao, tempoTotalContribuicao, fatorSeguranca, resultString, comparacaoTempoContribuicao, conclusoes) {[m
[32m+[m[32m  //   let currency = this.loadCurrency(this.dataInicioBeneficio);[m
[32m+[m[32m  //   let somaMedias;[m
[32m+[m[32m  //   if (fatorSeguranca >= 1 && valorRegra >=  valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao && this.tipoBeneficio == 4) {[m
[32m+[m[32m  //     somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //     conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[32m+[m[32m  //     //resultados['Renda Mensal Inicial com Regra ' + resultString + ': '] = currency.acronimo + somaMedias;[m
[32m+[m[32m  //   }else if(fatorSeguranca >= 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao){[m
[32m+[m[32m  //     if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[32m+[m[32m  //       somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Fator Previdenciário favorável'});//conclusoes.fator_previdenciario = fatorSeguranca + '- Fator Previdenciário favorável';[m
[32m+[m[32m  //       conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[32m+[m[32m  //       //resultados['Renda Mensal Inicial com Regra'+ resultString + ' : '] = currency.acronimo + somaMedias[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(fatorSeguranca < 1 && valorRegra >= valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[32m+[m[32m  //     if (this.tipoBeneficio == 4 || this.tipoBeneficio == 6) {[m
[32m+[m[32m  //       somaMedias = this.limitarTetosEMinimos(somaMedias, this.dataInicioBeneficio);[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString + ')'});//conclusoes.fator_previdenciario = fatorSeguranca + '- FP desfavorável (Aplica-se a regra ' + resultString+ ')';[m
[32m+[m[32m  //       conclusoes.push({string:'Renda Mensal Inicial com Regra ' + resultString + ':',value:currency.acronimo + somaMedias});//conclusoes.renda_mensal_inicial_com_regra = currency.acronimo + somaMedias;[m
[32m+[m[32m  //       //resultados['specieKind = 4Renda Mensal Inicial com Regra'+ resultString + ': '] = currency.acronimo + somaMedias;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if(fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao){[m
[32m+[m[32m  //     if (this.tipoBeneficio == 6 || this.tipoBeneficio == 4) {[m
[32m+[m[32m  //       conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra' + resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra' + resultString;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }else if (fatorSeguranca > 1 && valorRegra >= valorComparacao && tempoTotalContribuicao < comparacaoTempoContribuicao) {[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)'});//conclusoes.fator_previdenciario =  fatorSeguranca + '- Tem direito a regra ' + resultString +' (Não possui 35 anos de contribuicao)';[m
[32m+[m[32m  //   }else if (fatorSeguranca < 1 && valorRegra < valorComparacao && tempoTotalContribuicao >= comparacaoTempoContribuicao) {[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca + '- Não tem direito a Regra '+ resultString});//conclusoes.fator_previdenciario = fatorSeguranca + '- Não tem direito a Regra'+ resultString;[m
[32m+[m[32m  //   }else if (this.dataInicioBeneficio < dataRegra || this.dataInicioBeneficio > dataFimRegra){[m
[32m+[m[32m  //     conclusoes.push({string:"Fp - Fator Previdenciário:",value:fatorSeguranca});//conclusoes.fator_previdenciario = fatorSeguranca;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getTaxaSecundaria(redutorProfessor, redutorSexo, contadorSecundario) {[m
[32m+[m[32m  //   let taxaSecundaria = 0;[m
[32m+[m[32m  //   let tempoServicoSecundario = this.getTempoServico(0,0,true);[m
[32m+[m[32m  //   let quantidadePBCSecudaria = contadorSecundario;[m
[32m+[m
[32m+[m[32m  //   let specieKind;[m
[32m+[m[32m  //   if(this.tipoBeneficio == 4 || this.tipoBeneficio ==  5 || this.tipoBeneficio ==  6 ||[m
[32m+[m[32m  //     this.tipoBeneficio == 8 || this.tipoBeneficio ==  9 || this.tipoBeneficio ==  10 ||[m
[32m+[m[32m  //     this.tipoBeneficio == 14 || this.tipoBeneficio ==  15){[m
[32m+[m[32m  //     specieKind = 1;[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 3 || this.tipoBeneficio == 16|| this.tipoBeneficio == 13){[m
[32m+[m[32m  //     specieKind = 2;[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 1 || this.tipoBeneficio == 2 || this.tipoBeneficio == 11[m
[32m+[m[32m  //            || this.tipoBeneficio == 29){[m
[32m+[m[32m  //     specieKind = 3;[m
[32m+[m[32m  //   }else if(this.tipoBeneficio == 25){[m
[32m+[m[32m  //     specieKind = 4;[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     specieKind = null;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let tempoServico = 0;[m
[32m+[m[32m  //   switch(specieKind){[m
[32m+[m[32m  //     case 1:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m[41m   [m
[32m+[m[32m  //       let redutorProporcional = 0;[m
[32m+[m[32m  //       if(this.isProportional){[m
[32m+[m[32m  //           redutorProporcional = 5;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       taxaSecundaria = tempoServico / (35 - redutorProfessor - redutorSexo - redutorProporcional);[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 2:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 30;[m
[32m+[m[32m  //       let carenciaMeses = this.getMesesCarencia();[m
[32m+[m[32m  //       taxaSecundaria = tempoServico / carenciaMeses;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 3:[m
[32m+[m[32m  //         taxaSecundaria = quantidadePBCSecudaria / 12;[m
[32m+[m[32m  //         break;[m
[32m+[m[32m  //     case 4:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m
[32m+[m[32m  //       if(redutorSexo == 5){[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 20;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 25;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 5:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m
[32m+[m[32m  //       if(redutorSexo == 5){[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 23;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 28;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     case 6:[m
[32m+[m[32m  //       tempoServico = tempoServicoSecundario / 365;[m
[32m+[m[32m  //       if(redutorSexo == 5){[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 28;[m
[32m+[m[32m  //       }else{[m
[32m+[m[32m  //         taxaSecundaria = tempoServico / 33;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return taxaSecundaria;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getMesesCarencia(){[m
[32m+[m[32m  //   let mesesCarencia = 180;[m
[32m+[m[32m  //   if (this.dataFiliacao <= this.dataLei8213) {[m
[32m+[m[32m  //     let progressiveLack = this.CarenciaProgressiva.getCarencia(this.dataInicioBeneficio.year());[m
[32m+[m[32m  //     if(progressiveLack != 0){[m
[32m+[m[32m  //       mesesCarencia = progressiveLack;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return mesesCarencia;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getTempoServico(redutorProfessor, redutorSexo, secundario) {[m
[32m+[m[32m  //   let tempo;[m
[32m+[m
[32m+[m[32m  //   if(secundario){[m
[32m+[m[32m  //     tempo = this.contribuicaoSecundaria99;[m
[32m+[m[32m  //     let contagemSecundaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[32m+[m[32m  //     return contagemSecundaria;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   tempo = this.contribuicaoPrimaria99;[m
[32m+[m[32m  //   let contagemPrimaria = (tempo.anos * 365.25) + (tempo.meses * 30) + (tempo.dias);[m
[32m+[m[32m  //   let contagemPrimariaAnos = contagemPrimaria / 365;[m
[32m+[m[32m  //   if (this.tipoBeneficio == 6) { // Tempo de Serviço Professor[m
[32m+[m[32m  //     contagemPrimariaAnos += redutorProfessor + redutorSexo;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   this.contribuicaoTotal = contagemPrimariaAnos;[m[41m [m
[32m+[m
[32m+[m[32m  //   if (redutorSexo > 0) {[m
[32m+[m[32m  //     if (this.tipoBeneficio == 16 || this.tipoBeneficio == 3 || this.tipoBeneficio == 4) {[m
[32m+[m[32m  //       contagemPrimariaAnos += redutorSexo;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return contagemPrimariaAnos;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getIndiceEspecie(especie, sexo, anoContribuicao){[m
[32m+[m		[32m// let indiceAno = 0.0[m
[32m+[m[32m  //   if (anoContribuicao != 0 ) {[m
[32m+[m[32m  //       indiceAno = anoContribuicao / 100;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let index = 0.0;[m
[32m+[m[32m  //   switch (especie){[m
[32m+[m[32m  //     case 1: {// Auxílio Doença[m
[32m+[m[32m  //     	index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.2){[m
[32m+[m[32m  //       	indiceAno = 0.2;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 2: {// Aposentadoria por invalidez[m
[32m+[m[32m  //     	index = 0.7;[m
[32m+[m[32m  //     	if (indiceAno > 0.3){[m
[32m+[m[32m  //     	    indiceAno = 0.3;[m
[32m+[m[32m  //     	}[m
[32m+[m[32m  //     	index += indiceAno;[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 3: { // Idade - trabalhador Rural[m
[32m+[m[32m  //       index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.25) {[m
[32m+[m[32m  //       	indiceAno = 0.25;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 5: { // Idade - trabalhador Urbano[m
[32m+[m[32m  //       index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.25){[m
[32m+[m		[32m// 			indiceAno = 0.25;[m
[32m+[m		[32m// 		}[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 16: {//Aposentadoria Especial.[m
[32m+[m[32m  //     	index = 0.7;[m
[32m+[m[32m  //       if (indiceAno > 0.25){[m
[32m+[m[32m  //       	indiceAno = 0.25;[m
[32m+[m[32m  //       }[m
[32m+[m[32m  //       index += indiceAno;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 4: {  // Aposentadoria por tempo de contribuição[m
[32m+[m[32m  //     	if(sexo === 'm'){[m
[32m+[m[32m  //     	  index = 0.8;[m
[32m+[m[32m  //     	  let indiceAnoAux = anoContribuicao - 30;[m
[32m+[m[32m  //     	  if(indiceAnoAux > 5){[m
[32m+[m[32m  //     	  	indiceAnoAux = 5;[m
[32m+[m[32m  //     	  }[m
[32m+[m[32m  //     	  if(indiceAnoAux < 0){[m
[32m+[m[32m  //     	  	indiceAnoAux = 0;[m
[32m+[m[32m  //     	  }[m
[32m+[m[32m  //     	  index += (0.03 * indiceAnoAux);[m
[32m+[m[32m  //     	}else{[m
[32m+[m[32m  //     	    index = 0.95;[m
[32m+[m[32m  //     	}[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     case 20: {[m[41m [m
[32m+[m[32m  //       index = 0.2;[m
[32m+[m[32m  //       break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     default:{[m
[32m+[m[32m  //     	index = 0;[m
[32m+[m[32m  //     	break;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return index;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  getEspecieBeneficio(calculo){[m
     let numeroEspecie = 0;[m
[31m-    switch (this.calculo.tipo_seguro) {[m
[32m+[m[32m    switch (calculo.tipo_seguro) {[m
       case "Auxílio Doença":[m
         numeroEspecie = 1;[m
         break;[m
[36m@@ -2058,22 +1975,22 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
       return '';[m
   }[m
 [m
[31m-  limitarTetosEMinimos(valor, data){[m
[31m-    let moeda = this.Moeda.getByDate(data);[m
[31m-    let salarioMinimo = moeda.salario_minimo;[m
[31m-    let tetoSalarial = moeda.teto;[m
[31m-    let avisoString = '';[m
[31m-    let valorRetorno = valor;[m
[31m-[m
[31m-    if(valor < salarioMinimo){[m
[31m-      valorRetorno = salarioMinimo;[m
[31m-      avisoString = 'LIMITADO AO MÍNIMO'[m
[31m-    }else if(valor > tetoSalarial){[m
[31m-      valorRetorno = tetoSalarial;[m
[31m-      avisoString = 'LIMITADO AO TETO'[m
[31m-    }[m
[31m-    return {valor:valorRetorno, aviso:avisoString};[m
[31m-  }[m
[32m+[m[32m  // limitarTetosEMinimos(valor, data){[m
[32m+[m[32m  //   let moeda = this.Moeda.getByDate(data);[m
[32m+[m[32m  //   let salarioMinimo = moeda.salario_minimo;[m
[32m+[m[32m  //   let tetoSalarial = moeda.teto;[m
[32m+[m[32m  //   let avisoString = '';[m
[32m+[m[32m  //   let valorRetorno = valor;[m
[32m+[m
[32m+[m[32m  //   if(valor < salarioMinimo){[m
[32m+[m[32m  //     valorRetorno = salarioMinimo;[m
[32m+[m[32m  //     avisoString = 'LIMITADO AO MÍNIMO'[m
[32m+[m[32m  //   }else if(valor > tetoSalarial){[m
[32m+[m[32m  //     valorRetorno = tetoSalarial;[m
[32m+[m[32m  //     avisoString = 'LIMITADO AO TETO'[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return {valor:valorRetorno, aviso:avisoString};[m
[32m+[m[32m  // }[m
 [m
   getIndex(data){[m
     return this.getDifferenceInMonths(this.primeiraDataTabela,data);[m
[36m@@ -2148,25 +2065,25 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     return returnObj;[m
   }[m
 [m
[31m-  getDataInicio(){[m
[31m-    let dataInicio;[m
[31m-    if(this.calculo.tipo_aposentadoria == 'Anterior a 05/10/1988'){[m
[31m-      dataInicio = this.dataInicioBeneficio;[m
[31m-    }else{[m
[31m-      let dib = this.dataInicioBeneficio;[m
[31m-      if (this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' && [m
[31m-        this.dataInicioBeneficio > this.dataDib99) {[m
[31m-        dib = this.dataDib99;[m
[31m-      }[m
[31m-      if (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[31m-        this.dataInicioBeneficio > this.dataDib98) {[m
[31m-        dib = this.dataDib98;[m
[31m-      }[m
[31m-[m
[31m-      dataInicio = (dib.clone()).startOf('month');[m
[31m-    }[m
[31m-    return dataInicio;[m
[31m-  }[m
[32m+[m[32m  // getDataInicio(){[m
[32m+[m[32m  //   let dataInicio;[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'Anterior a 05/10/1988'){[m
[32m+[m[32m  //     dataInicio = this.dataInicioBeneficio;[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     let dib = this.dataInicioBeneficio;[m
[32m+[m[32m  //     if (this.calculo.tipo_aposentadoria == 'Entre 16/12/1998 e 28/11/1999' &&[m[41m [m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib99) {[m
[32m+[m[32m  //       dib = this.dataDib99;[m
[32m+[m[32m  //     }[m
[32m+[m[32m  //     if (this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998' &&[m
[32m+[m[32m  //       this.dataInicioBeneficio > this.dataDib98) {[m
[32m+[m[32m  //       dib = this.dataDib98;[m
[32m+[m[32m  //     }[m
[32m+[m
[32m+[m[32m  //     dataInicio = (dib.clone()).startOf('month');[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return dataInicio;[m
[32m+[m[32m  // }[m
 [m
   controleExibicao(){[m
     let data88 = moment('1988-10-05');[m
[36m@@ -2224,53 +2141,53 @@[m [mexport class RgpsResultadosComponent implements OnInit {[m
     }[m
   }[m
 [m
[31m-  getDataLimite(dataInicio){[m
[31m-    let mesesLimite = 0;[m
[31m-    let mesesLimiteTotal = 0;[m
[31m-    if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[31m-      mesesLimite = 18;[m
[31m-      mesesLimiteTotal = 12;[m
[31m-    } else {[m
[31m-      mesesLimite = 48;[m
[31m-      mesesLimiteTotal = 36;[m
[31m-    }[m
[31m-[m
[31m-    if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-      mesesLimite = 36;[m
[31m-      mesesLimiteTotal = 48;[m
[31m-    }[m
[31m-[m
[31m-    if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[31m-      mesesLimite = 36;[m
[31m-      mesesLimiteTotal = 48;[m
[31m-    }[m
[31m-[m
[31m-    if(this.calculo.tipo_aposentadoria == 'A partir de 29/11/1999'){[m
[31m-      mesesLimite = 0;[m
[31m-      mesesLimiteTotal = 0;[m
[31m-    }[m
[31m-[m
[31m-    let dataLimite;[m
[31m-    if(mesesLimite > 0){[m
[31m-      dataLimite = (dataInicio.clone()).add(-mesesLimite,'months');[m
[31m-    }else{[m
[31m-      dataLimite = moment('1994-07-01');[m
[31m-    }[m
[31m-    return dataLimite;[m
[31m-  }[m
[31m-[m
[31m-  getIdadeFracionada(){[m
[31m-    let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[31m-    let idadeEmDias = this.dataInicioBeneficio.diff(dataNascimento, 'days');[m
[31m-    return idadeEmDias/365.25;[m
[31m-  }[m
[31m-[m
[31m-  getIN45(){[m
[31m-    this.withIN45 = true;[m
[31m-    if(this.tipoBeneficio == 25 || this.tipoBeneficio == 26 || this.tipoBeneficio == 27 || this.tipoBeneficio == 28){[m
[31m-      this.withIN45 = false;[m
[31m-    }[m
[31m-  }[m
[32m+[m[32m  // getDataLimite(dataInicio){[m
[32m+[m[32m  //   let mesesLimite = 0;[m
[32m+[m[32m  //   let mesesLimiteTotal = 0;[m
[32m+[m[32m  //   if (this.tipoBeneficio == 1 || this.tipoBeneficio == 2) {[m
[32m+[m[32m  //     mesesLimite = 18;[m
[32m+[m[32m  //     mesesLimiteTotal = 12;[m
[32m+[m[32m  //   } else {[m
[32m+[m[32m  //     mesesLimite = 48;[m
[32m+[m[32m  //     mesesLimiteTotal = 36;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[32m+[m[32m  //     mesesLimite = 36;[m
[32m+[m[32m  //     mesesLimiteTotal = 48;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'Entre 05/04/1991 e 15/12/1998'){[m
[32m+[m[32m  //     mesesLimite = 36;[m
[32m+[m[32m  //     mesesLimiteTotal = 48;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   if(this.calculo.tipo_aposentadoria == 'A partir de 29/11/1999'){[m
[32m+[m[32m  //     mesesLimite = 0;[m
[32m+[m[32m  //     mesesLimiteTotal = 0;[m
[32m+[m[32m  //   }[m
[32m+[m
[32m+[m[32m  //   let dataLimite;[m
[32m+[m[32m  //   if(mesesLimite > 0){[m
[32m+[m[32m  //     dataLimite = (dataInicio.clone()).add(-mesesLimite,'months');[m
[32m+[m[32m  //   }else{[m
[32m+[m[32m  //     dataLimite = moment('1994-07-01');[m
[32m+[m[32m  //   }[m
[32m+[m[32m  //   return dataLimite;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getIdadeFracionada(){[m
[32m+[m[32m  //   let dataNascimento = moment(this.segurado.data_nascimento, 'DD/MM/YYYY');[m
[32m+[m[32m  //   let idadeEmDias = this.dataInicioBeneficio.diff(dataNascimento, 'days');[m
[32m+[m[32m  //   return idadeEmDias/365.25;[m
[32m+[m[32m  // }[m
[32m+[m
[32m+[m[32m  // getIN45(){[m
[32m+[m[32m  //   this.withIN45 = true;[m
[32m+[m[32m  //   if(this.tipoBeneficio == 25 || this.tipoBeneficio == 26 || this.tipoBeneficio == 27 || this.tipoBeneficio == 28){[m
[32m+[m[32m  //     this.withIN45 = false;[m
[32m+[m[32m  //   }[m
[32m+[m[32m  // }[m
 [m
   preencheGrupoDeCalculos(){[m
     let especie = this.calculo.tipo_seguro;[m
